// Decompiled code from stars.exe (Stars! 2.60j RC3)
// Generated by Ghidra
// 

// ======================================================================
// Function: WinMain
// Address: 1018:0000
// ======================================================================


/* WARNING: Could not reconcile some variable overlaps */

short __pascal16far
MAIN::WinMain(ushort hInstance,ushort hPrevInstance,char *lpCmdLine,short nCmdShow)

{
  char cVar1;
  short sVar2;
  char *pcVar3;
  BOOL BVar4;
  int iVar5;
  undefined2 uVar6;
  undefined2 unaff_SS;
  DWORD dw;
  undefined uVar7;
  undefined uVar8;
  MSG msg;
  short i;
  char *lpT;
  char *pch;
  
                    /* Segment:    4
                       Offset:     000118c0
                       Length:     1c3c
                       Min Alloc:  1c3c
                       Flags:      1d50
                           Code
                           Discardable
                           Moveable
                           Preload
                           Impure (Non-shareable)
                        */
  c_common::hInst = hInstance;
  c_common::szBase[0] = '\0';
  c_common::ini.flags6 = 0;
  PUBLIC::_memset((void *)&c_common::tutor,0,0x2c);
  PUBLIC::_memset((void *)&c_common::vtimer,0,10);
  c_common::vtimer.fAutoGenWhenIn = 1;
  if ((hPrevInstance == 0) && (sVar2 = MDI::InitMDIApp(), sVar2 == 0)) {
    sVar2 = 0x10;
    pcVar3 = MSG::PszFormatIds(idsUnableInitializeStars,(short *)0x0);
    UTILGEN::AlertSz(pcVar3,sVar2);
    msg.wParam = 0;
  }
  else {
    dw = GetTickCount();
    UTILGEN::Randomize2(dw);
    sVar2 = INIT::FCreateStuff();
    if (sVar2 == 0) {
      msg.wParam = 0;
    }
    else {
      sVar2 = FGetSystemColors();
      if (sVar2 == 0) {
        sVar2 = 0x10;
        pcVar3 = MSG::PszFormatIds(idsUnableInitializeStars,(short *)0x0);
        UTILGEN::AlertSz(pcVar3,sVar2);
        msg.wParam = 0;
      }
      else {
        sVar2 = INIT::InitInstance(nCmdShow);
        if (sVar2 == 0) {
          sVar2 = 0x10;
          pcVar3 = MSG::PszFormatIds(idsUnableInitializeStars,(short *)0x0);
          UTILGEN::AlertSz(pcVar3,sVar2);
          msg.wParam = 0;
        }
        else {
          lpT = lpCmdLine;
          while (*lpT != '\0') {
            while( true ) {
              if (*lpT != ' ') break;
              lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
            }
            if ((*lpT == '-') || (*lpT == '/')) {
              lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
              while ((*lpT != '\0' && (*lpT != ' '))) {
                switch(*lpT) {
                case 'A':
                case 'a':
                  c_common::ini.flags6 = c_common::ini.flags6 & 0xfbffU | 0x400;
                  break;
                case 'B':
                case 'b':
                  lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  while (*lpT == ' ') {
                    lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  }
                  pch = (char *)c_common::szBase;
                  while( true ) {
                    if ((*lpT == '\0') || (*lpT == ' ')) break;
                    *pch = *lpT;
                    pch = pch + 1;
                    lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  }
                  *pch = '\0';
                  lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + -1);
                  sVar2 = FSetUpBatchProcessing();
                  if (sVar2 != 0) {
                    c_common::ini.flags6 = c_common::ini.flags6 & 0xfdf4U | 0x20b;
                  }
                  break;
                case 'C':
                case 'c':
                  c_common::ini.flags6 =
                       c_common::ini.flags6 & 0xfffdU | (uint)(c_common::szBase[0] != '\0') << 1;
                  break;
                case 'D':
                case 'd':
                  lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  while( true ) {
                    if ((*lpT == '\0') || (*lpT == ' ')) break;
                    cVar1 = *lpT;
                    if (cVar1 == 'F') {
LAB_1018_01ce:
                      c_common::ini.flags6 = c_common::ini.flags6 & 0xf7ffU | 0x800;
                    }
                    else if (cVar1 == 'M') {
LAB_1018_01ec:
                      c_common::ini.flags6 = c_common::ini.flags6 & 0xdfffU | 0x2000;
                    }
                    else if (cVar1 == 'P') {
LAB_1018_01dd:
                      c_common::ini.flags6 = c_common::ini.flags6 & 0xefffU | 0x1000;
                    }
                    else {
                      if (cVar1 == 'f') goto LAB_1018_01ce;
                      if (cVar1 == 'm') goto LAB_1018_01ec;
                      if (cVar1 == 'p') goto LAB_1018_01dd;
                    }
                    lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  }
                  lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + -1);
                  break;
                case 'G':
                case 'g':
                  c_common::ini.flags6 = c_common::ini.flags6 & 0xfff7U | 8;
                  i = 0;
                  do {
                    uVar6 = (undefined2)((ulong)lpT >> 0x10);
                    iVar5 = (int)lpT;
                    if ((*(char *)(iVar5 + 1) < '0') || ('9' < *(char *)(iVar5 + 1)))
                    goto LAB_1018_02cb;
                    lpT = (char *)CONCAT22(uVar6,iVar5 + 1);
                    lpCmdLine._2_2_ = (undefined2)((ulong)((long)i * 10) >> 0x10);
                    i = (int)((long)i * 10) + (int)*lpT + -0x30;
                  } while (i < 0x3e9);
                  i = 1000;
                  while( true ) {
                    uVar6 = (undefined2)((ulong)lpT >> 0x10);
                    iVar5 = (int)lpT;
                    if ((*(char *)(iVar5 + 1) < '0') || ('9' < *(char *)(iVar5 + 1))) break;
                    lpT = (char *)CONCAT22(uVar6,iVar5 + 1);
                  }
LAB_1018_02cb:
                  if (0 < i) {
                    c_common::ini.cTurnGen = i + -1;
                  }
                  break;
                case 'H':
                case 'h':
                  _DATA::gd.flags3 = _DATA::gd.flags3 & 0xfdffU | 0x200;
                  break;
                case 'L':
                case 'l':
                  c_common::ini.flags6 = c_common::ini.flags6 & 0x7fffU | 0x8000;
                  break;
                case 'P':
                case 'p':
                  lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  while (*lpT == ' ') {
                    lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  }
                  pch = (char *)c_common::szPassLast;
                  while( true ) {
                    if (((*lpT == '\0') || (*lpT == ' ')) ||
                       ((char *)((int)c_common::szPassLast + 0xeU) < pch)) break;
                    *pch = *lpT;
                    pch = pch + 1;
                    lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
                  }
                  *pch = '\0';
                  lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + -1);
                  _DATA::lSaltLast._0_2_ = UTILGEN::LSaltFromSz((int)c_common::szPassLast);
                  _DATA::lSaltLast._2_2_ = lpCmdLine._2_2_;
                  break;
                case 'T':
                case 't':
                  c_common::ini.flags6 = c_common::ini.flags6 & 0xffefU | 0x10;
                  break;
                case 'V':
                case 'v':
                  c_common::ini.flags6 = c_common::ini.flags6 & 0xbfffU | 0x4000;
                  break;
                case 'W':
                case 'w':
                  c_common::ini.flags6 = c_common::ini.flags6 & 0xfffbU | 4;
                  break;
                case 'X':
                case 'x':
                  _DATA::gd.flags2 = _DATA::gd.flags2 & 0xffbfU | 0x40;
                }
                lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
              }
            }
            else {
              pch = (char *)c_common::szBase;
              while ((*lpT != '\0' && (*lpT != ' '))) {
                *pch = *lpT;
                pch = pch + 1;
                lpT = (char *)CONCAT22(lpT._2_2_,(int)lpT + 1);
              }
              *pch = '\0';
              c_common::ini.flags6 = c_common::ini.flags6 & 0xfffcU | 3;
            }
          }
          PostMessage(c_common::hwndFrame,0x464,0,0);
          while (BVar4 = GetMessage((undefined2 *)CONCAT22(unaff_SS,&msg),0,0,0), BVar4 != 0) {
            if (_DATA::hwndTitle == 0) {
              BVar4 = IsIconic(c_common::hwndFrame);
              uVar7 = (undefined)unaff_SS;
              uVar8 = (undefined)((uint)unaff_SS >> 8);
              if ((((BVar4 != 0) ||
                   (sVar2 = TranslateAccelerator
                                      (c_common::hwndFrame,c_common::hAccel,
                                       (undefined2 *)CONCAT13(uVar8,CONCAT12(uVar7,&msg))),
                   sVar2 == 0)) &&
                  (((TranslateMessage((undefined2 *)CONCAT13(uVar8,CONCAT12(uVar7,&msg))),
                    msg.message != 0x100 && (msg.message != 0x101)) ||
                   (sVar2 = FHandleKey(msg.hwnd,msg.message,msg.wParam,
                                       CONCAT13((char)((uint)msg.lParam._2_2_ >> 8),
                                                CONCAT12((char)msg.lParam._2_2_,
                                                         (undefined2)msg.lParam))), sVar2 == 0))))
                 && ((msg.message != 0x102 ||
                     (sVar2 = FHandleChar(msg.hwnd,msg.wParam,
                                          CONCAT13((char)((uint)msg.lParam._2_2_ >> 8),
                                                   CONCAT12((char)msg.lParam._2_2_,
                                                            (undefined2)msg.lParam))), sVar2 == 0)))
                 ) {
                DispatchMessage((undefined2 *)CONCAT13(uVar8,CONCAT12(uVar7,&msg)));
              }
            }
            else {
              sVar2 = TranslateAccelerator
                                (c_common::hwndFrame,c_common::hAccelTitle,
                                 (undefined2 *)CONCAT22(unaff_SS,&msg));
              if (sVar2 == 0) {
                TranslateMessage((undefined2 *)CONCAT22(unaff_SS,&msg));
                DispatchMessage((undefined2 *)CONCAT22(unaff_SS,&msg));
              }
            }
          }
          FreeStuff();
        }
      }
    }
  }
  return msg.wParam;
}



// ======================================================================
// Function: InitMDIApp
// Address: 1020:0000
// ======================================================================


short __cdecl16far MDI::InitMDIApp(void)

{
  ATOM AVar1;
  short sVar2;
  undefined2 unaff_SS;
  WNDCLASS wc;
  
                    /* Segment:    5
                       Offset:     00013700
                       Length:     983f
                       Min Alloc:  9840
                       Flags:      1d50
                           Code
                           Discardable
                           Moveable
                           Preload
                           Impure (Non-shareable)
                        */
  wc.style = 0xb;
  wc._2_2_ = 0x6d6;
  wc._4_2_ = 0x1020;
  wc.cbClsExtra = 0;
  wc.cbWndExtra = 0;
  wc.hInstance = c_common::hInst;
  wc.hIcon = 0;
  wc.hCursor = LoadCursor(0,(LPCSTR)0x7f00);
  wc.hbrBackground = 0xd;
  wc.lpszMenuName._0_2_ = 0x364;
  wc.lpszMenuName._2_2_ = 0x1120;
  wc.lpszClassName._0_2_ = 0x1d6;
  wc.lpszClassName._2_2_ = 0x1120;
  AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
  if (AVar1 == 0) {
    sVar2 = 0;
  }
  else {
    wc.style = 0x20b;
    wc._2_2_ = 0x5c92;
    wc._4_2_ = 0x1030;
    wc.hIcon = 0;
    wc.lpszMenuName._0_2_ = 0;
    wc.lpszMenuName._2_2_ = 0;
    wc.hbrBackground = GetStockObject(1);
    wc.lpszClassName._0_2_ = 0x202;
    wc.lpszClassName._2_2_ = 0x1120;
    AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
    if (AVar1 == 0) {
      sVar2 = 0;
    }
    else {
      wc.style = 0x20b;
      wc._2_2_ = 0x32;
      wc._4_2_ = 0x1058;
      wc.hbrBackground = GetStockObject(4);
      wc.lpszClassName._0_2_ = 0x1e2;
      wc.lpszClassName._2_2_ = 0x1120;
      AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
      if (AVar1 == 0) {
        sVar2 = 0;
      }
      else {
        wc.style = 0x20b;
        wc._2_2_ = 0;
        wc._4_2_ = 0x1028;
        wc.hbrBackground = GetStockObject(1);
        wc.lpszClassName._0_2_ = 0x1ec;
        wc.lpszClassName._2_2_ = 0x1120;
        AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
        if (AVar1 == 0) {
          sVar2 = 0;
        }
        else {
          wc.style = 0x208;
          wc._2_2_ = 0x1e;
          wc._4_2_ = 0x1068;
          wc.hbrBackground = GetStockObject(1);
          wc.lpszClassName._0_2_ = 0x242;
          wc.lpszClassName._2_2_ = 0x1120;
          AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
          if (AVar1 == 0) {
            sVar2 = 0;
          }
          else {
            wc.style = 0x200;
            wc._2_2_ = 0;
            wc._4_2_ = 0x1048;
            wc.hbrBackground = GetStockObject(1);
            wc.hIcon = 0;
            wc.lpszClassName._0_2_ = 0x1f6;
            wc.lpszClassName._2_2_ = 0x1120;
            AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
            if (AVar1 == 0) {
              sVar2 = 0;
            }
            else {
              wc.style = 0xa00;
              wc._2_2_ = 0;
              wc._4_2_ = 0x10c0;
              wc.hbrBackground = GetStockObject(0);
              wc.hIcon = 0;
              wc.lpszClassName._0_2_ = 0x210;
              wc.lpszClassName._2_2_ = 0x1120;
              AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
              if (AVar1 == 0) {
                sVar2 = 0;
              }
              else {
                wc.style = 0xa00;
                wc._2_2_ = 0x19e4;
                wc._4_2_ = 0x1068;
                wc.hbrBackground = GetStockObject(0);
                wc.hIcon = 0;
                wc.lpszClassName._0_2_ = 0x24a;
                wc.lpszClassName._2_2_ = 0x1120;
                AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
                if (AVar1 == 0) {
                  sVar2 = 0;
                }
                else {
                  wc.style = 0x200;
                  wc._2_2_ = 0x2876;
                  wc._4_2_ = 0x10d8;
                  wc.hbrBackground = GetStockObject(1);
                  wc.hIcon = 0;
                  wc.lpszClassName._0_2_ = 0x21c;
                  wc.lpszClassName._2_2_ = 0x1120;
                  AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
                  if (AVar1 == 0) {
                    sVar2 = 0;
                  }
                  else {
                    wc.style = 0;
                    wc._2_2_ = 0x9126;
                    wc._4_2_ = 0x1020;
                    wc.cbClsExtra = 0;
                    wc.cbWndExtra = 0;
                    wc.hInstance = c_common::hInst;
                    wc.hIcon = 0;
                    wc.hCursor = LoadCursor(0,(LPCSTR)0x7f00);
                    wc.hbrBackground = GetStockObject(4);
                    wc.lpszMenuName._0_2_ = 0;
                    wc.lpszMenuName._2_2_ = 0;
                    wc.lpszClassName._0_2_ = 0x22a;
                    wc.lpszClassName._2_2_ = 0x1120;
                    AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
                    if (AVar1 == 0) {
                      sVar2 = 0;
                    }
                    else {
                      wc.style = 0xb;
                      wc._2_2_ = 0x18;
                      wc._4_2_ = 0x1108;
                      wc.cbClsExtra = 0;
                      wc.cbWndExtra = 0;
                      wc.hInstance = c_common::hInst;
                      wc.hIcon = 0;
                      wc.hCursor = LoadCursor(0,(LPCSTR)0x7f00);
                      wc.hbrBackground = GetStockObject(1);
                      wc.lpszMenuName._0_2_ = 0;
                      wc.lpszMenuName._2_2_ = 0;
                      wc.lpszClassName._0_2_ = 0x236;
                      wc.lpszClassName._2_2_ = 0x1120;
                      AVar1 = RegisterClass((undefined2 *)CONCAT22(unaff_SS,&wc));
                      if (AVar1 == 0) {
                        sVar2 = 0;
                      }
                      else {
                        sVar2 = 1;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return sVar2;
}



// ======================================================================
// Function: FCreateStuff
// Address: 1000:0014
// ======================================================================


short __cdecl16far INIT::FCreateStuff(void)

{
  undefined2 *puVar1;
  undefined2 *puVar2;
  byte *pbVar3;
  short *psVar4;
  ushort *puVar5;
  ushort *puVar6;
  fn_lpfnFakeListProc *pfVar7;
  fn_lpfnGaugeDlgProc *pfVar8;
  fn_lpfnFakeEditProc *pfVar9;
  fn_lpfnFakeComboProc *pfVar10;
  fn_lpfnFakeCEProc *pfVar11;
  fn_lpfnReportDlgProc *pfVar12;
  fn_lpfnBrowserDlgProc *pfVar13;
  fn_lpfnHostTimerProc *pfVar14;
  byte *pbVar15;
  bool bVar16;
  short sVar17;
  short sVar18;
  HBITMAP HVar19;
  HBRUSH HVar20;
  ushort uVar21;
  char *sz;
  int iVar22;
  undefined2 *puVar23;
  undefined2 *puVar24;
  ushort *puVar25;
  short dx;
  ushort hbmp;
  short i;
  short dy;
  short fFailed;
  
  bVar16 = false;
  sVar17 = GetSystemMetrics(0);
  sVar18 = GetSystemMetrics(1);
  if ((sVar17 < 800) || (sVar18 < 600)) {
    _DATA::gd.flags1 = _DATA::gd.flags1 & 0x3fff;
  }
  else if ((sVar17 < 0x400) || (sVar18 < 0x300)) {
    _DATA::gd.flags1 = _DATA::gd.flags1 & 0x3fffU | 0x4000;
  }
  else if ((sVar17 < 0x457) || (sVar18 < 0x378)) {
    _DATA::gd.flags1 = _DATA::gd.flags1 & 0x3fffU | 0x8000;
  }
  else {
    _DATA::gd.flags1 = _DATA::gd.flags1 & 0x3fffU | 0xc000;
  }
  _DATA::gd.flags1 = _DATA::gd.flags1 & 0xfb7f;
  puVar23 = (undefined2 *)&_DATA::vrgplrDef;
  puVar24 = (undefined2 *)&c_common::vplr;
  for (iVar22 = 0x60; iVar22 != 0; iVar22 = iVar22 + -1) {
    puVar2 = puVar24;
    puVar24 = puVar24 + 1;
    puVar1 = puVar23;
    puVar23 = puVar23 + 1;
    *puVar2 = *puVar1;
  }
  c_common::hrgnHuge = CreateRectRgn(-10,-10,2000,2000);
  c_common::hrgnScratch = CreateRectRgn(0,0,10,10);
  c_common::hbrShip = UTILGEN::HbrGet(0xff00);
  c_common::hbrStarbase = UTILGEN::HbrGet(0xffff);
  c_common::hbrBBlue = UTILGEN::HbrGet(0xff0000);
  c_common::hbrEnemy = UTILGEN::HbrGet(0xff);
  c_common::hbrSelect = UTILGEN::HbrGet(0xffff);
  _DATA::hbrRed = UTILGEN::HbrGet(0xff);
  _DATA::hbrBlue = UTILGEN::HbrGet(0x7f0000);
  _DATA::hbrGreen = UTILGEN::HbrGet(0x7f00);
  c_common::hbrRadar = UTILGEN::HbrGet(0x7f);
  c_common::hbrPurple = UTILGEN::HbrGet(0x7f007f);
  c_common::hbrTooltip = UTILGEN::HbrGet(0x9fffff);
  c_common::hbrRadarNear = 0;
  c_common::rghbrMineral[0] = UTILGEN::HbrGet(0xff0000);
  c_common::rghbrMineral[1] = UTILGEN::HbrGet(0x7f00);
  c_common::rghbrMineral[2] = UTILGEN::HbrGet(0xffff);
  c_common::rghbrMineral[3] = UTILGEN::HbrGet(0xffffff);
  c_common::rghbrMineral[4] = UTILGEN::HbrGet(0xff);
  c_common::rghbrPlanetAttr[0][0] = UTILGEN::HbrGet(0x7f0000);
  c_common::rghbrPlanetAttr[0][1] = UTILGEN::HbrGet(0xff0000);
  c_common::rghbrPlanetAttr[1][0] = UTILGEN::HbrGet(0x7f);
  c_common::rghbrPlanetAttr[1][1] = UTILGEN::HbrGet(0xff);
  c_common::rghbrPlanetAttr[2][0] = UTILGEN::HbrGet(0x7f00);
  c_common::rghbrPlanetAttr[2][1] = UTILGEN::HbrGet(0xff00);
  c_common::rghbrMinSum[0][0] = UTILGEN::HbrGet(0xff0000);
  c_common::rghbrMinSum[0][1] = UTILGEN::HbrGet(0x7f0000);
  c_common::rghbrMinSum[1][0] = UTILGEN::HbrGet(0xff00);
  c_common::rghbrMinSum[1][1] = UTILGEN::HbrGet(0x7f00);
  c_common::rghbrMinSum[2][0] = UTILGEN::HbrGet(0xffff);
  c_common::rghbrMinSum[2][1] = UTILGEN::HbrGet(0x7f7f);
  c_common::rghbrMinSum[3][0] = UTILGEN::HbrGet(0xff);
  c_common::rghbrMinSum[3][1] = UTILGEN::HbrGet(0x7f);
  c_common::hbrYellow = UTILGEN::HbrGet(0xffff);
  c_common::hbrDkYellow = UTILGEN::HbrGet(0x7f7f);
  _DATA::hbrLightGray = UTILGEN::HbrGet(0xc0c0c0);
  _DATA::hbrGray = UTILGEN::HbrGet(0x808080);
  c_common::hpenShip = CreatePen(0,1,0xff00);
  c_common::hpenDkGreen = CreatePen(0,1,0x7f00);
  c_common::hpenStarbase = CreatePen(0,1,0xff0000);
  c_common::hpenEnemy = CreatePen(0,1,0xff);
  c_common::hpenMassPath = CreatePen(2,1,0x7f7f7f);
  c_common::hpenRadar = CreatePen(0,1,0x7f);
  c_common::hpenRadarNear = 0;
  c_common::hpenDkBlue = CreatePen(0,1,0x7f0000);
  c_common::hpenYellow = CreatePen(0,1,0xffff);
  c_common::hpenDkYellow = CreatePen(0,1,0x7f7f);
  c_common::hpenDkPurple = CreatePen(0,1,0x7f007f);
  HVar19 = LoadBitmap(c_common::hInst,s_Screen50Bmp_1120_05e6);
  c_common::hbr50Screen = CreatePatternBrush(HVar19);
  DeleteObject(HVar19);
  for (i = 0; i < 3; i = i + 1) {
    HVar19 = LoadBitmap(c_common::hInst,(LPCSTR)(ulong)(i + 0x1cc));
    HVar20 = CreatePatternBrush(HVar19);
    *(HBRUSH *)((int)c_common::rghbrPat + i * 2) = HVar20;
    DeleteObject(HVar19);
  }
  HVar19 = LoadBitmap(c_common::hInst,s_CargoBmp_1120_05f2);
  c_common::hbrCargo = CreatePatternBrush(HVar19);
  DeleteObject(HVar19);
  HVar19 = LoadBitmap(c_common::hInst,(LPCSTR)0x112005fb);
  c_common::hbrDock = CreatePatternBrush(HVar19);
  DeleteObject(HVar19);
  c_common::hcurScanner = LoadCursor(c_common::hInst,s_ScannerCur_1120_0603);
  c_common::hcurScanAdd = LoadCursor(c_common::hInst,s_ScannerAdd_1120_060e);
  c_common::hcurOpenGrab = LoadCursor(c_common::hInst,s_OpenGrabCur_1120_0619);
  c_common::hcurCloseGrab = LoadCursor(c_common::hInst,s_CloseGrabCur_1120_0625);
  c_common::hcurTrashCan = LoadCursor(c_common::hInst,(LPCSTR)0x7a);
  c_common::hcurNoWay = LoadCursor(c_common::hInst,(LPCSTR)0x79);
  c_common::hcurResizeWE = LoadCursor(c_common::hInst,(LPCSTR)0x102);
  c_common::hcurResizeNS = LoadCursor(c_common::hInst,(LPCSTR)0x104);
  c_common::hcurResize4Way = LoadCursor(c_common::hInst,(LPCSTR)0x107);
  c_common::hcurArrowHelp = LoadCursor(c_common::hInst,(LPCSTR)0x108);
  c_common::hcurHand = LoadCursor(c_common::hInst,(LPCSTR)0x109);
  c_common::hbmpScanner = LoadBitmap(c_common::hInst,s_ScannerBmp_1120_0632);
  c_common::hbmpScanShip = LoadBitmap(c_common::hInst,(LPCSTR)0x58);
  c_common::hbmpUnknownPlanet = LoadBitmap(c_common::hInst,s_UnknownPlanetBmp_1120_063d);
  c_common::hbmpNumbers = LoadBitmap(c_common::hInst,(LPCSTR)0xf9);
  c_common::hdibPlanets = UTILGEN::HdibLoadBigResource(0x70);
  c_common::hdibThings = UTILGEN::HdibLoadBigResource(0x57);
  c_common::hdibToolbar = UTILGEN::HdibLoadBigResource(0xb2);
  if (((c_common::hdibPlanets == 0) || (c_common::hdibThings == 0)) || (c_common::hdibToolbar == 0))
  {
    bVar16 = true;
  }
  for (i = 0; i < 5; i = i + 1) {
    uVar21 = UTILGEN::HdibLoadBigResource(i + 0x228);
    *(ushort *)((int)c_common::rghdibShips + i * 2) = uVar21;
    if (*(int *)((int)c_common::rghdibShips + i * 2) == 0) {
      bVar16 = true;
    }
    uVar21 = UTILGEN::HdibLoadBigResource(i + 0x22d);
    *(ushort *)((int)c_common::rghdibShipsT + i * 2) = uVar21;
    if (*(int *)((int)c_common::rghdibShipsT + i * 2) == 0) {
      bVar16 = true;
    }
  }
  for (i = 0; i < 7; i = i + 1) {
    uVar21 = UTILGEN::HdibLoadBigResource(i + 500);
    *(ushort *)((int)c_common::rghdibInventory + i * 2) = uVar21;
    if (*(int *)((int)c_common::rghdibInventory + i * 2) == 0) {
      bVar16 = true;
    }
  }
  c_common::vhpal = UTILGEN::HpalFromDib(c_common::rghdibShips[3]);
  c_common::hdibRaces = UTILGEN::HdibLoadBigResource(0x85);
  c_common::hdibRacesT = UTILGEN::HdibLoadBigResource(0x50);
  c_common::hdibRacesX = UTILGEN::HdibLoadBigResource(0x4f);
  c_common::hbmpBackBld = LoadBitmap(c_common::hInst,(LPCSTR)0x77);
  c_common::hbmpMsg = LoadBitmap(c_common::hInst,(LPCSTR)0x86);
  c_common::hbmpMono = LoadBitmap(c_common::hInst,(LPCSTR)0xc7);
  _DATA::hdibPlaque = UTILGEN::HdibLoadBigResource(0x437);
  _DATA::hiconStars = LoadIcon(c_common::hInst,s_StarsIco_1120_064e);
  _DATA::hiconHost = LoadIcon(c_common::hInst,s_HostIco_1120_0657);
  _DATA::hiconWait = LoadIcon(c_common::hInst,s_WaitIco_1120_065f);
  c_common::rghiconVCR[0] = LoadIcon(c_common::hInst,(LPCSTR)0x11200667);
  c_common::rghiconVCR[1] = LoadIcon(c_common::hInst,(LPCSTR)0x11200670);
  c_common::rghiconVCR[2] = LoadIcon(c_common::hInst,(LPCSTR)0x11200679);
  c_common::rghiconVCR[3] = LoadIcon(c_common::hInst,(LPCSTR)0x11200682);
  c_common::rghiconVCR[4] = LoadIcon(c_common::hInst,(LPCSTR)0x1120068b);
  c_common::rghiconVCR[5] = LoadIcon(c_common::hInst,(LPCSTR)0x11200694);
  c_common::rghiconVCR[6] = LoadIcon(c_common::hInst,(LPCSTR)0x1120069d);
  _DATA::lpLog = (byte *)MEMORY::LpAlloc(32000,htLog);
  _DATA::lpMsg = (short *)MEMORY::LpAlloc(0xffc8,htMsg);
  c_common::lpfnFakeComboProc =
       (fn_lpfnFakeComboProc *)MakeProcInstance(TB::FakeComboProc,c_common::hInst);
  c_common::lpfnFakeCEProc = (fn_lpfnFakeCEProc *)MakeProcInstance(TB::FakeCEProc,c_common::hInst);
  c_common::lpfnFakeEditProc =
       (fn_lpfnFakeEditProc *)MakeProcInstance(SHIP::FakeEditProc,c_common::hInst);
  c_common::lpfnFakeListProc =
       (fn_lpfnFakeListProc *)MakeProcInstance(BUILD::FakeListProc,c_common::hInst);
  c_common::lpfnHostTimerProc =
       (fn_lpfnHostTimerProc *)MakeProcInstance(MDI::HostTimerProc,c_common::hInst);
  c_common::lpfnBrowserDlgProc =
       (fn_lpfnBrowserDlgProc *)MakeProcInstance(RESEARCH::BrowserDlg,c_common::hInst);
  c_common::lpfnReportDlgProc =
       (fn_lpfnReportDlgProc *)MakeProcInstance(REPORT::ReportDlg,c_common::hInst);
  c_common::lpfnGaugeDlgProc =
       (fn_lpfnGaugeDlgProc *)MakeProcInstance(UTILGEN::ProgressGaugeDlg,c_common::hInst);
  UTILGEN::GetDiskSerialNumber();
  c_common::lpb2k = (byte *)MEMORY::LpAlloc(0x800,htPerm);
  _DATA::vlprgidMisc = (ushort *)MEMORY::LpAlloc(0x800,htPerm);
  _DATA::vlprgidPlanet = (ushort *)MEMORY::LpAlloc(0x800,htPerm);
  puVar25 = (ushort *)MEMORY::LpAlloc(0x800,htPerm);
  if (((((bVar16) || (c_common::hbmpScanner == 0)) ||
       ((c_common::hbmpUnknownPlanet == 0 ||
        ((c_common::hbmpBackBld == 0 || (c_common::hdibRaces == 0)))))) ||
      (c_common::hdibRacesT == 0)) ||
     (((((c_common::hdibRacesX == 0 || (c_common::hbmpMono == 0)) || (c_common::hbmpScanShip == 0))
       || ((c_common::hbmpMsg == 0 || (_DATA::hiconHost == 0)))) ||
      ((_DATA::hiconStars == 0 || (_DATA::hiconWait == 0)))))) {
    sVar17 = 0x10;
    _DATA::vlprgidFleet = puVar25;
    sz = MSG::PszFormatIds(idsUnableLoadBitmaps,(short *)0x0);
    UTILGEN::AlertSz(sz,sVar17);
    sVar17 = 0;
    puVar25 = _DATA::vlprgidFleet;
    pbVar3 = _DATA::lpLog;
    psVar4 = _DATA::lpMsg;
    puVar5 = _DATA::vlprgidMisc;
    puVar6 = _DATA::vlprgidPlanet;
    pfVar7 = c_common::lpfnFakeListProc;
    pfVar8 = c_common::lpfnGaugeDlgProc;
    pfVar9 = c_common::lpfnFakeEditProc;
    pfVar10 = c_common::lpfnFakeComboProc;
    pfVar11 = c_common::lpfnFakeCEProc;
    pfVar12 = c_common::lpfnReportDlgProc;
    pfVar13 = c_common::lpfnBrowserDlgProc;
    pfVar14 = c_common::lpfnHostTimerProc;
    pbVar15 = c_common::lpb2k;
  }
  else {
    sVar17 = 1;
    pbVar3 = _DATA::lpLog;
    psVar4 = _DATA::lpMsg;
    puVar5 = _DATA::vlprgidMisc;
    puVar6 = _DATA::vlprgidPlanet;
    pfVar7 = c_common::lpfnFakeListProc;
    pfVar8 = c_common::lpfnGaugeDlgProc;
    pfVar9 = c_common::lpfnFakeEditProc;
    pfVar10 = c_common::lpfnFakeComboProc;
    pfVar11 = c_common::lpfnFakeCEProc;
    pfVar12 = c_common::lpfnReportDlgProc;
    pfVar13 = c_common::lpfnBrowserDlgProc;
    pfVar14 = c_common::lpfnHostTimerProc;
    pbVar15 = c_common::lpb2k;
  }
  c_common::lpb2k._2_2_ = (undefined2)((ulong)pbVar15 >> 0x10);
  c_common::lpb2k._0_2_ = SUB42(pbVar15,0);
  c_common::lpfnHostTimerProc._2_2_ = (undefined2)((ulong)pfVar14 >> 0x10);
  c_common::lpfnHostTimerProc._0_2_ = SUB42(pfVar14,0);
  c_common::lpfnBrowserDlgProc._2_2_ = (undefined2)((ulong)pfVar13 >> 0x10);
  c_common::lpfnBrowserDlgProc._0_2_ = SUB42(pfVar13,0);
  c_common::lpfnReportDlgProc._2_2_ = (undefined2)((ulong)pfVar12 >> 0x10);
  c_common::lpfnReportDlgProc._0_2_ = SUB42(pfVar12,0);
  c_common::lpfnFakeCEProc._2_2_ = (undefined2)((ulong)pfVar11 >> 0x10);
  c_common::lpfnFakeCEProc._0_2_ = SUB42(pfVar11,0);
  c_common::lpfnFakeComboProc._2_2_ = (undefined2)((ulong)pfVar10 >> 0x10);
  c_common::lpfnFakeComboProc._0_2_ = SUB42(pfVar10,0);
  c_common::lpfnFakeEditProc._2_2_ = (undefined2)((ulong)pfVar9 >> 0x10);
  c_common::lpfnFakeEditProc._0_2_ = SUB42(pfVar9,0);
  c_common::lpfnGaugeDlgProc._2_2_ = (undefined2)((ulong)pfVar8 >> 0x10);
  c_common::lpfnGaugeDlgProc._0_2_ = SUB42(pfVar8,0);
  c_common::lpfnFakeListProc._2_2_ = (undefined2)((ulong)pfVar7 >> 0x10);
  c_common::lpfnFakeListProc._0_2_ = SUB42(pfVar7,0);
  _DATA::vlprgidPlanet._2_2_ = (undefined2)((ulong)puVar6 >> 0x10);
  _DATA::vlprgidPlanet._0_2_ = SUB42(puVar6,0);
  _DATA::vlprgidMisc._2_2_ = (undefined2)((ulong)puVar5 >> 0x10);
  _DATA::vlprgidMisc._0_2_ = SUB42(puVar5,0);
  _DATA::lpMsg._2_2_ = (undefined2)((ulong)psVar4 >> 0x10);
  _DATA::lpMsg._0_2_ = SUB42(psVar4,0);
  _DATA::lpLog._2_2_ = (undefined2)((ulong)pbVar3 >> 0x10);
  _DATA::lpLog._0_2_ = SUB42(pbVar3,0);
  _DATA::vlprgidFleet._2_2_ = (undefined2)((ulong)puVar25 >> 0x10);
  _DATA::vlprgidFleet._0_2_ = SUB42(puVar25,0);
  return sVar17;
}



// ======================================================================
// Function: FGetSystemColors
// Address: 1018:08d2
// ======================================================================


short __cdecl16far MAIN::FGetSystemColors(void)

{
  int iVar1;
  HDC HVar2;
  short sVar3;
  short sVar4;
  undefined2 uVar5;
  COLORREF CVar6;
  char *pcVar7;
  ulong uVar8;
  undefined2 uVar9;
  undefined2 uVar10;
  ushort uVar11;
  BITMAPINFO *lpbi_2;
  ushort hdc;
  
  if (_DATA::hbrButtonFace != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonFace);
  }
  if (_DATA::hbrButtonHilite != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonHilite);
  }
  if (_DATA::hbrButtonShadow != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonShadow);
  }
  if (_DATA::hbrButtonText != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonText);
  }
  if (_DATA::hbrWindowText != 0) {
    UTILGEN::FreeHbr(_DATA::hbrWindowText);
  }
  if (_DATA::hbrWindow != 0) {
    UTILGEN::FreeHbr(_DATA::hbrWindow);
  }
  if (_DATA::hbrWindowFrame != 0) {
    UTILGEN::FreeHbr(_DATA::hbrWindowFrame);
  }
  if (_DATA::hbrDesktop != 0) {
    UTILGEN::FreeHbr(_DATA::hbrDesktop);
  }
  c_common::crButtonFace = GetSysColor(0xf);
  _DATA::hbrButtonFace = UTILGEN::HbrGet(c_common::crButtonFace);
  c_common::crButtonHilite = GetSysColor(0x14);
  _DATA::hbrButtonHilite = UTILGEN::HbrGet(c_common::crButtonHilite);
  c_common::crButtonShadow = GetSysColor(0x10);
  _DATA::hbrButtonShadow = UTILGEN::HbrGet(c_common::crButtonShadow);
  c_common::crButtonText = GetSysColor(0x12);
  _DATA::hbrButtonText = UTILGEN::HbrGet(c_common::crButtonText);
  CVar6 = GetSysColor(6);
  _DATA::hbrWindowFrame = UTILGEN::HbrGet(CVar6);
  CVar6 = GetSysColor(1);
  _DATA::hbrDesktop = UTILGEN::HbrGet(CVar6);
  c_common::crWindow = GetSysColor(5);
  _DATA::hbrWindow = UTILGEN::HbrGet(c_common::crWindow);
  c_common::crWindowText = GetSysColor(8);
  _DATA::hbrWindowText = UTILGEN::HbrGet(c_common::crWindowText);
  uVar11 = 4;
  c_common::dyTitleBar = GetSystemMetrics(4);
  uVar10 = 0x20;
  c_common::dxWinFrame = GetSystemMetrics(0x20);
  uVar9 = 0x21;
  c_common::dyWinFrame = GetSystemMetrics(0x21);
  if (_DATA::hdibPlaque != 0) {
    pcVar7 = GlobalLock(_DATA::hdibPlaque);
    uVar5 = (undefined2)((ulong)pcVar7 >> 0x10);
    iVar1 = (int)pcVar7;
    *(undefined *)(iVar1 + 0x40e) = (char)c_common::crButtonFace;
    *(undefined *)(iVar1 + 0x40d) = (char)(c_common::crButtonFace >> 8);
    uVar8 = PUBLIC::__aFulshr(CONCAT22(uVar10,uVar9),uVar11);
    *(undefined *)(iVar1 + 0x40c) = (char)uVar8;
    GlobalUnlock(_DATA::hdibPlaque);
  }
  if (c_common::hdibToolbar != 0) {
    pcVar7 = GlobalLock(c_common::hdibToolbar);
    uVar5 = (undefined2)((ulong)pcVar7 >> 0x10);
    iVar1 = (int)pcVar7;
    *(undefined *)(iVar1 + 0x41e) = (char)c_common::crButtonFace;
    *(undefined *)(iVar1 + 0x41d) = (char)(c_common::crButtonFace >> 8);
    uVar8 = PUBLIC::__aFulshr(CONCAT22(uVar10,uVar9),uVar11);
    *(undefined *)(iVar1 + 0x41c) = (char)uVar8;
    GlobalUnlock(c_common::hdibToolbar);
  }
  HVar2 = GetDC(0);
  sVar3 = GetDeviceCaps(HVar2,0xc);
  sVar4 = GetDeviceCaps(HVar2,0xe);
  c_common::vcScreenColors = sVar3 * sVar4;
  ReleaseDC(0,HVar2);
  return 1;
}



// ======================================================================
// Function: InitInstance
// Address: 1000:0d70
// ======================================================================


short __cdecl16far INIT::InitInstance(short nCmdShow)

{
  short sVar1;
  RECT rc;
  short sw;
  
  c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1a;
  c_common::ini.idPlayer = -1;
  ReadIniSettings();
  c_common::hwndFrame =
       CreateWindow(_DATA::szFrame,(LPCSTR)0x11200731,0xcf0000,c_common::ini.wnFrame.rc.left,
                    c_common::ini.wnFrame.rc.top,c_common::ini.wnFrame.rc.right,
                    c_common::ini.wnFrame.rc.bottom,0,0,c_common::hInst,(void *)0x0);
  if (c_common::hwndFrame == 0) {
    sVar1 = 0;
  }
  else {
    c_common::hAccel = LoadAccelerators(c_common::hInst,(LPCSTR)0x74);
    if (c_common::hAccel == 0) {
      sVar1 = 0;
    }
    else {
      c_common::hAccelTitle = LoadAccelerators(c_common::hInst,(LPCSTR)0x438);
      if (c_common::hAccelTitle == 0) {
        sVar1 = 0;
      }
      else {
        if (nCmdShow == 1) {
          if (((c_common::ini.wnFrame.flags5 & 1U) == 0) &&
             (((uint)c_common::ini.wnFrame.flags5 >> 1 & 1) == 0)) {
            sw = 1;
          }
          else {
            sw = 3;
          }
        }
        else {
          sw = nCmdShow;
        }
        ShowWindow(c_common::hwndFrame,sw);
        ShowWindow(c_common::hwndFrame,0);
        sVar1 = 1;
      }
    }
  }
  return sVar1;
}



// ======================================================================
// Function: FSetupBatchProcessing
// Address: 1018:06a4
// ======================================================================


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

short __cdecl16far MAIN::FSetUpBatchProcessing(void)

{
  short sVar1;
  ushort cb_00;
  long lVar2;
  short cb;
  short fSuccess;
  short env [9];
  char *pch;
  
  fSuccess = 0;
  _penvMem = env;
  sVar1 = PUBLIC::__setjmp(env);
  if (sVar1 == 0) {
    IO::StreamOpen((char *)c_common::szBase,0x20);
    lVar2 = PUBLIC::__filelength(_DATA::hf);
    cb_00 = (ushort)lVar2;
    _lpchBatch = (char *)MEMORY::LpAlloc(cb_00,htPerm);
    IO::RgFromStream(_lpchBatch,cb_00);
    _lpchBatchMac = _lpchBatch + cb_00;
    DAT_1120_51b2 = DAT_1120_01a0;
    pch = (char *)c_common::szBase;
    while( true ) {
      if ((*_lpchBatch == '\n') ||
         ((_lpchBatch == _lpchBatchMac && (DAT_1120_01a0 == DAT_1120_51b2)))) break;
      *pch = *_lpchBatch;
      _lpchBatch = (char *)CONCAT22(DAT_1120_01a0,_lpchBatch + 1);
      pch = pch + 1;
    }
    _lpchBatch = (char *)CONCAT22(DAT_1120_01a0,_lpchBatch + 1);
    pch[-1] = '\0';
    fSuccess = 1;
  }
  _penvMem = (short *)0x0;
  IO::StreamClose();
  if (fSuccess == 0) {
    c_common::szBase[0] = '\0';
  }
  return fSuccess;
}



// ======================================================================
// Function: LSaltFromSz
// Address: 1040:59ce
// ======================================================================


/* WARNING: Could not reconcile some variable overlaps */

undefined2 __cdecl16far UTILGEN::LSaltFromSz(char *psz)

{
  char *pcVar1;
  ulong uVar2;
  long lSalt;
  
  uVar2 = 0;
  pcVar1 = psz;
  if (*psz == '\0') {
    lSalt._0_2_ = 0;
  }
  else {
    while (psz = pcVar1, lSalt._0_2_ = (undefined2)uVar2, *psz != '\0') {
      uVar2 = uVar2 + (long)(int)*psz;
      pcVar1 = psz + 1;
      if (*pcVar1 != '\0') {
        uVar2 = PUBLIC::__aFulmul(uVar2,(long)(int)*pcVar1);
        pcVar1 = psz + 2;
      }
    }
    if (uVar2 == 0) {
      lSalt._0_2_ = 1;
    }
  }
  return (undefined2)lSalt;
}



// ======================================================================
// Function: FreeStuff
// Address: 1018:0bae
// ======================================================================


void __cdecl16far MAIN::FreeStuff(void)

{
  HCURSOR HVar1;
  short j;
  short i;
  
  if (_DATA::hbrButtonFace != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonFace);
  }
  if (_DATA::hbrButtonHilite != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonHilite);
  }
  if (_DATA::hbrButtonShadow != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonShadow);
  }
  if (_DATA::hbrButtonText != 0) {
    UTILGEN::FreeHbr(_DATA::hbrButtonText);
  }
  if (_DATA::hbrWindowText != 0) {
    UTILGEN::FreeHbr(_DATA::hbrWindowText);
  }
  if (_DATA::hbrWindow != 0) {
    UTILGEN::FreeHbr(_DATA::hbrWindow);
  }
  if (_DATA::hbrWindowFrame != 0) {
    UTILGEN::FreeHbr(_DATA::hbrWindowFrame);
  }
  if (_DATA::hbrDesktop != 0) {
    UTILGEN::FreeHbr(_DATA::hbrDesktop);
  }
  if (_DATA::hbrRed != 0) {
    UTILGEN::FreeHbr(_DATA::hbrRed);
  }
  if (_DATA::hbrGreen != 0) {
    UTILGEN::FreeHbr(_DATA::hbrGreen);
  }
  if (_DATA::hbrBlue != 0) {
    UTILGEN::FreeHbr(_DATA::hbrBlue);
  }
  if (c_common::hbrPurple != 0) {
    UTILGEN::FreeHbr(c_common::hbrPurple);
  }
  if (c_common::hbrTooltip != 0) {
    UTILGEN::FreeHbr(c_common::hbrTooltip);
  }
  for (i = 0; i < 5; i = i + 1) {
    if (*(int *)((int)c_common::rghbrMineral + i * 2) != 0) {
      UTILGEN::FreeHbr(*(ushort *)((int)c_common::rghbrMineral + i * 2));
    }
  }
  for (i = 0; i < 3; i = i + 1) {
    for (j = 0; j < 2; j = j + 1) {
      UTILGEN::FreeHbr(*(ushort *)((int)c_common::rghbrPlanetAttr + i * 4 + j * 2));
    }
  }
  for (i = 0; i < 4; i = i + 1) {
    for (j = 0; j < 2; j = j + 1) {
      UTILGEN::FreeHbr(*(ushort *)((int)c_common::rghbrMinSum + i * 4 + j * 2));
    }
  }
  FreeProcInstance((FARPROC)CONCAT22(c_common::lpfnFakeComboProc._2_2_,
                                     c_common::lpfnFakeComboProc._0_2_));
  FreeProcInstance((FARPROC)CONCAT22(c_common::lpfnFakeCEProc._2_2_,c_common::lpfnFakeCEProc._0_2_))
  ;
  FreeProcInstance((FARPROC)CONCAT22(c_common::lpfnFakeEditProc._2_2_,
                                     c_common::lpfnFakeEditProc._0_2_));
  FreeProcInstance((FARPROC)CONCAT22(c_common::lpfnFakeListProc._2_2_,
                                     c_common::lpfnFakeListProc._0_2_));
  FreeProcInstance((FARPROC)CONCAT22(c_common::lpfnHostTimerProc._2_2_,
                                     c_common::lpfnHostTimerProc._0_2_));
  FreeProcInstance((FARPROC)CONCAT22(c_common::lpfnBrowserDlgProc._2_2_,
                                     c_common::lpfnBrowserDlgProc._0_2_));
  if (((int)_DATA::lpfnTutorDlgProc != 0) || (_DATA::lpfnTutorDlgProc._2_2_ != 0)) {
    FreeProcInstance((FARPROC)CONCAT22(_DATA::lpfnTutorDlgProc._2_2_,(int)_DATA::lpfnTutorDlgProc));
  }
  DeleteObject(c_common::hrgnHuge);
  DeleteObject(c_common::hrgnScratch);
  HVar1 = LoadCursor(0,(LPCSTR)0x7f00);
  setcursor(HVar1);
  DestroyCursor(c_common::hcurScanner);
  DestroyCursor(c_common::hcurOpenGrab);
  DestroyCursor(c_common::hcurCloseGrab);
  DestroyCursor(c_common::hcurScanAdd);
  DestroyCursor(c_common::hcurTrashCan);
  DestroyCursor(c_common::hcurNoWay);
  DestroyCursor(c_common::hcurResizeWE);
  DestroyCursor(c_common::hcurResizeNS);
  DestroyCursor(c_common::hcurResize4Way);
  DestroyCursor(c_common::hcurArrowHelp);
  DestroyCursor(c_common::hcurHand);
  DeleteObject(c_common::hbmpScanner);
  DeleteObject(c_common::hbmpNumbers);
  DeleteObject(c_common::hbmpScanShip);
  DeleteObject(c_common::hbmpUnknownPlanet);
  DestroyIcon(_DATA::hiconStars);
  DestroyIcon(_DATA::hiconHost);
  DestroyIcon(_DATA::hiconWait);
  for (i = 0; i < 7; i = i + 1) {
    DestroyIcon(*(HICON *)((int)c_common::rghiconVCR + i * 2));
  }
  GlobalUnlock(c_common::hdibPlanets);
  FreeResource(c_common::hdibPlanets);
  GlobalUnlock(c_common::hdibThings);
  FreeResource(c_common::hdibThings);
  GlobalUnlock(c_common::hdibToolbar);
  FreeResource(c_common::hdibToolbar);
  GlobalUnlock(c_common::hdibRaces);
  FreeResource(c_common::hdibRaces);
  GlobalUnlock(c_common::hdibRacesT);
  FreeResource(c_common::hdibRacesT);
  GlobalUnlock(c_common::hdibRacesX);
  FreeResource(c_common::hdibRacesX);
  DeleteObject(c_common::hbmpBackBld);
  DeleteObject(c_common::hbmpMsg);
  DeleteObject(c_common::hbmpMono);
  FreeResource(_DATA::hdibPlaque);
  for (i = 0; i < 5; i = i + 1) {
    GlobalUnlock(*(HGLOBAL *)((int)c_common::rghdibShips + i * 2));
    FreeResource(*(HGLOBAL *)((int)c_common::rghdibShips + i * 2));
    GlobalUnlock(*(HGLOBAL *)((int)c_common::rghdibShipsT + i * 2));
    FreeResource(*(HGLOBAL *)((int)c_common::rghdibShipsT + i * 2));
  }
  for (i = 0; i < 7; i = i + 1) {
    GlobalUnlock(*(HGLOBAL *)((int)c_common::rghdibInventory + i * 2));
    FreeResource(*(HGLOBAL *)((int)c_common::rghdibInventory + i * 2));
  }
  MEMORY::FreeLp((void *)CONCAT22(_DATA::lpLog._2_2_,_DATA::lpLog._0_2_),htLog);
  _DATA::lpLog._0_2_ = 0;
  _DATA::lpLog._2_2_ = 0;
  MEMORY::FreeLp((void *)CONCAT22(_DATA::lpMsg._2_2_,_DATA::lpMsg._0_2_),htMsg);
  _DATA::lpMsg._0_2_ = 0;
  _DATA::lpMsg._2_2_ = 0;
  DeleteObject(c_common::vhpal);
  if (_DATA::vhpalSplash != 0) {
    DeleteObject(_DATA::vhpalSplash);
  }
  UTILGEN::FreeHbr(c_common::hbrShip);
  UTILGEN::FreeHbr(c_common::hbrStarbase);
  UTILGEN::FreeHbr(c_common::hbrBBlue);
  UTILGEN::FreeHbr(c_common::hbrEnemy);
  UTILGEN::FreeHbr(c_common::hbrSelect);
  UTILGEN::FreeHbr(c_common::hbrRadar);
  if (c_common::hbrRadarNear != 0) {
    UTILGEN::FreeHbr(c_common::hbrRadarNear);
  }
  UTILGEN::FreeHbr(_DATA::hbrLightGray);
  UTILGEN::FreeHbr(_DATA::hbrGray);
  UTILGEN::FreeHbr(c_common::hbrYellow);
  UTILGEN::FreeHbr(c_common::hbrDkYellow);
  DeleteObject(c_common::hbr50Screen);
  for (i = 0; i < 3; i = i + 1) {
    DeleteObject(*(HGDIOBJ *)((int)c_common::rghbrPat + i * 2));
  }
  DeleteObject(c_common::hbrCargo);
  DeleteObject(c_common::hbrDock);
  DeleteObject(c_common::hpenShip);
  DeleteObject(c_common::hpenDkGreen);
  DeleteObject(c_common::hpenDkPurple);
  DeleteObject(c_common::hpenStarbase);
  DeleteObject(c_common::hpenEnemy);
  DeleteObject(c_common::hpenMassPath);
  DeleteObject(c_common::hpenRadar);
  if (c_common::hpenRadarNear != 0) {
    DeleteObject(c_common::hpenRadarNear);
  }
  DeleteObject(c_common::hpenDkBlue);
  DeleteObject(c_common::hpenYellow);
  DeleteObject(c_common::hpenDkYellow);
  DeleteObject(c_common::rghfontArial10[0]);
  DeleteObject(c_common::rghfontArial10[1]);
  for (i = 0; i < 5; i = i + 1) {
    DeleteObject(*(HGDIOBJ *)((int)c_common::rghfontArial8 + i * 2));
  }
  DeleteObject(c_common::rghfontArial6[0]);
  DeleteObject(c_common::rghfontArial7[0]);
  for (i = 0; i < 0xc; i = i + 1) {
    MEMORY::FreeHb((HB *)CONCAT22(*(undefined2 *)(i * 4 + 0xd36),*(undefined2 *)(i * 4 + 0xd34)));
  }
  return;
}



// ======================================================================
// Function: ReadIniSettings
// Address: 1000:124c
// ======================================================================


/* WARNING: Removing unreachable block (ram,0x10001bda) */
/* WARNING: Restarted to delay deadcode elimination for space: ram */

void __cdecl16far INIT::ReadIniSettings(void)

{
  uint *puVar1;
  char cVar2;
  char *pcVar3;
  char *pcVar4;
  UINT UVar5;
  char *sz;
  short sVar6;
  ushort uVar7;
  short sVar8;
  short sVar9;
  uint uVar10;
  int iVar11;
  undefined2 unaff_SI;
  undefined2 unaff_DI;
  undefined2 unaff_SS;
  long lVar12;
  long lVar13;
  ushort in_stack_0000ffb0;
  short cpq;
  short cch;
  char szSection [16];
  char *psz;
  ushort w;
  char szIniFile [16];
  WN wnT;
  char szEntry [16];
  short iPass;
  short i;
  ushort uDateCur;
  
  lVar13 = CONCAT22(unaff_SI,unaff_DI);
  c_common::ini.flags6 = c_common::ini.flags6 & 0xffe3;
  UTILGEN::CchGetString(idsWindows,szSection);
  UTILGEN::CchGetString(idsStarsIni,szIniFile);
  GetIniWinRc(szSection,szIniFile,idsMain,(WN *)&c_common::ini);
  GetIniWinRc(szSection,szIniFile,idsReportfleetwin,&wnT);
  if (wnT.rc.left != -0x8000) {
    _DATA::vrptFleet.ptDlg.x = wnT.rc.left;
    _DATA::vrptFleet.ptDlg.y = wnT.rc.top;
    _DATA::vrptFleet.ptSize.x = wnT.rc.right - wnT.rc.left;
    _DATA::vrptFleet.ptSize.y = wnT.rc.bottom - wnT.rc.top;
  }
  GetIniWinRc(szSection,szIniFile,idsReportefleetwin,&wnT);
  if (wnT.rc.left != -0x8000) {
    _DATA::vrptEFleet.ptDlg.x = wnT.rc.left;
    _DATA::vrptEFleet.ptDlg.y = wnT.rc.top;
    _DATA::vrptEFleet.ptSize.x = wnT.rc.right - wnT.rc.left;
    _DATA::vrptEFleet.ptSize.y = wnT.rc.bottom - wnT.rc.top;
  }
  GetIniWinRc(szSection,szIniFile,idsReportbtlwin,&wnT);
  if (wnT.rc.left != -0x8000) {
    _DATA::vrptBattle.ptDlg.x = wnT.rc.left;
    _DATA::vrptBattle.ptDlg.y = wnT.rc.top;
    _DATA::vrptBattle.ptSize.x = wnT.rc.right - wnT.rc.left;
    _DATA::vrptBattle.ptSize.y = wnT.rc.bottom - wnT.rc.top;
  }
  GetIniWinRc(szSection,szIniFile,idsReportplanwin,&wnT);
  if (wnT.rc.left != -0x8000) {
    _DATA::vrptPlanet.ptDlg.x = wnT.rc.left;
    _DATA::vrptPlanet.ptDlg.y = wnT.rc.top;
    _DATA::vrptPlanet.ptSize.x = wnT.rc.right - wnT.rc.left;
    _DATA::vrptPlanet.ptSize.y = wnT.rc.bottom - wnT.rc.top;
  }
  UTILGEN::CchGetString(idsResolution,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if ((UVar5 == 0) && ((c_common::vcScreenColors < 5 || ((uint)_DATA::gd.flags1 >> 0xe == 0)))) {
    sVar6 = 0x10;
    sz = MSG::PszFormatIds(idsNoteStarsPrefersScreenResolutionLeast800x600,(short *)0x0);
    UTILGEN::AlertSz(sz,sVar6);
  }
  UTILGEN::CchGetString(idsLayout,szEntry);
  c_common::iWindowLayout =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::iWindowLayout;
  if (c_common::iWindowLayout < 0) {
    UVar5 = 0;
  }
  if ((int)UVar5 < 3) {
    if (c_common::iWindowLayout < 0) {
      c_common::iWindowLayout = 0;
    }
  }
  else {
    c_common::iWindowLayout = 2;
  }
  UTILGEN::CchGetString(idsStyle1width,szEntry);
  c_common::vfs.dxPlanWant =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0x18c,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::vfs.dxPlanWant;
  if (c_common::vfs.dxPlanWant < 0xb) {
    UVar5 = 10;
  }
  if ((int)UVar5 < 2000) {
    if (c_common::vfs.dxPlanWant < 0xb) {
      c_common::vfs.dxPlanWant = 10;
    }
  }
  else {
    c_common::vfs.dxPlanWant = 2000;
  }
  UTILGEN::CchGetString(idsStyle1height,szEntry);
  c_common::vfs.dyMsgWant =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0x6e,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::vfs.dyMsgWant;
  if (c_common::vfs.dyMsgWant < 0xb) {
    UVar5 = 10;
  }
  if ((int)UVar5 < 2000) {
    if (c_common::vfs.dyMsgWant < 0xb) {
      c_common::vfs.dyMsgWant = 10;
    }
  }
  else {
    c_common::vfs.dyMsgWant = 2000;
  }
  UTILGEN::CchGetString(idsStyle1height2,szEntry);
  c_common::vfs.dyMinWant =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0xc0,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::vfs.dyMinWant;
  if (c_common::vfs.dyMinWant < 0xb) {
    UVar5 = 10;
  }
  if ((int)UVar5 < 2000) {
    if (c_common::vfs.dyMinWant < 0xb) {
      c_common::vfs.dyMinWant = 10;
    }
  }
  else {
    c_common::vfs.dyMinWant = 2000;
  }
  UTILGEN::CchGetString(idsStyle2width,szEntry);
  c_common::vfs.dx2PlanWant =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0x18c,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::vfs.dx2PlanWant;
  if (c_common::vfs.dx2PlanWant < 0xb) {
    UVar5 = 10;
  }
  if ((int)UVar5 < 2000) {
    if (c_common::vfs.dx2PlanWant < 0xb) {
      c_common::vfs.dx2PlanWant = 10;
    }
  }
  else {
    c_common::vfs.dx2PlanWant = 2000;
  }
  UTILGEN::CchGetString(idsStyle2height,szEntry);
  c_common::vfs.dy2MsgWant =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0x6e,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::vfs.dy2MsgWant;
  if (c_common::vfs.dy2MsgWant < 0xb) {
    UVar5 = 10;
  }
  if ((int)UVar5 < 2000) {
    if (c_common::vfs.dy2MsgWant < 0xb) {
      c_common::vfs.dy2MsgWant = 10;
    }
  }
  else {
    c_common::vfs.dy2MsgWant = 2000;
  }
  UTILGEN::CchGetString(idsStyle2height2,szEntry);
  c_common::vfs.dy2MinWant =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0xc0,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UVar5 = c_common::vfs.dy2MinWant;
  if (c_common::vfs.dy2MinWant < 0xb) {
    UVar5 = 10;
  }
  if ((int)UVar5 < 2000) {
    if (c_common::vfs.dy2MinWant < 0xb) {
      c_common::vfs.dy2MinWant = 10;
    }
  }
  else {
    c_common::vfs.dy2MinWant = 2000;
  }
  UTILGEN::CchGetString(idsToolbar,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),1,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::gd.flags2 = _DATA::gd.flags2 & 0x7fffU | (uint)(UVar5 != 0) << 0xf;
  UTILGEN::CchGetString(idsGlobalsettings,szEntry);
  sVar6 = GetPrivateProfileString
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                     (LPCSTR)0x1120073a,c_common::szWork,0x28,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if (sVar6 == 0x1c) {
    MDI::FSerialAndEnvFromSz
              ((long *)&_DATA::vSerialNumber,(byte *)c_common::vrgbMachineConfig,
               (char *)c_common::szWork);
  }
  else {
    _DATA::vSerialNumber._0_2_ = 0;
    _DATA::vSerialNumber._2_2_ = 0;
  }
  UTILGEN::CchGetString(idsPlanettiles,szEntry);
  GetPrivateProfileString
            ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
             (LPCSTR)0x1120073c,c_common::szWork,0x14,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  ReadIniTileSettings((char *)c_common::szWork,(TILE *)&_DATA::rgtilePlanet,6);
  UTILGEN::CchGetString(idsShiptiles,szEntry);
  GetPrivateProfileString
            ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
             (LPCSTR)0x1120073e,c_common::szWork,0x14,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  ReadIniTileSettings((char *)c_common::szWork,(TILE *)&_DATA::rgtileShip,7);
  UTILGEN::CchGetString(idsSelection,szEntry);
  sVar6 = GetPrivateProfileString
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                     (LPCSTR)0x11200740,c_common::szWork,0x14,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if (sVar6 < 3) {
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1f;
    goto LAB_1000_1995;
  }
  if (c_common::szWork[0] == 'E') {
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1fU | 0x80;
  }
  else if (c_common::szWork[0] == 'N') {
LAB_1000_18db:
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1f;
  }
  else if (c_common::szWork[0] == 'P') {
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1fU | 0x20;
  }
  else {
    if (c_common::szWork[0] != 'S') goto LAB_1000_18db;
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1fU | 0x40;
  }
  if ((c_common::szWork[1] < 'B') || ('Q' < c_common::szWork[1])) {
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfe1f;
  }
  else {
    c_common::ini.idPlayer = c_common::szWork[1] + -0x42;
  }
  if (((uint)c_common::ini.flags6 >> 5 & 0xf) != 0) {
    c_common::ini.iObjSel = PUBLIC::_atoi((char *)((int)c_common::szWork + 2));
  }
LAB_1000_1995:
  UTILGEN::CchGetString(idsMessage,szEntry);
  c_common::ini.iMsg =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UTILGEN::CchGetString(idsGameid,szEntry);
  sVar6 = GetPrivateProfileString
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                     (LPCSTR)0x11200742,c_common::szWork,10,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  lVar12 = 0;
  for (i = 0; c_common::ini.lid = lVar12, i < sVar6; i = i + 1) {
    lVar12 = PUBLIC::__aFlshl(lVar13,in_stack_0000ffb0);
    if ((*(char *)((int)c_common::szWork + i) < '0') || ('9' < *(char *)((int)c_common::szWork + i))
       ) {
      if (('`' < *(char *)((int)c_common::szWork + i)) &&
         (*(char *)((int)c_common::szWork + i) < 'g')) {
        lVar12 = lVar12 + (*(char *)((int)c_common::szWork + i) + -0x57);
      }
    }
    else {
      lVar12 = lVar12 + (*(char *)((int)c_common::szWork + i) + -0x30);
    }
  }
  UTILGEN::CchGetString(idsScanzoom,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),4,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if ((UVar5 != 0) && (UVar5 < 10)) {
    _DATA::iScanZoom = UVar5 - 5;
  }
  UTILGEN::CchGetString(idsScanfilterv25,szEntry);
  c_common::grbitScanShip =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UTILGEN::CchGetString(idsScanefilterv25,szEntry);
  c_common::grbitScanEShip =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UTILGEN::CchGetString(idsScanmines,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0xf,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  c_common::grbitScanMines = UVar5 & 0xf;
  UTILGEN::CchGetString(idsScanradar,szEntry);
  w = GetPrivateProfileInt
                ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),100,
                 (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if (100 < w) {
    w = 100;
  }
  _DATA::vpctRadarView = w;
  UTILGEN::CchGetString(idsScanmodev25,szEntry);
  _DATA::grbitScan =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0xe0,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if (5 < (_DATA::grbitScan & 0xc00f)) {
    _DATA::grbitScan = 0;
    c_common::grbitScanShip = 0;
  }
  UTILGEN::CchGetString(idsMineralscale,szEntry);
  _DATA::cMinGrafMax =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                  _DATA::cMinGrafMax,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if ((_DATA::cMinGrafMax < 100) || (30000 < _DATA::cMinGrafMax)) {
    _DATA::cMinGrafMax = 5000;
  }
  UTILGEN::CchGetString(idsFiles,szSection);
  UTILGEN::CchGetString(idsLogging,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  c_common::ini.flags6 = c_common::ini.flags6 & 0x7fffU | UVar5 << 0xf;
  UTILGEN::CchGetString(idsWait2,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  c_common::ini.flags6 = c_common::ini.flags6 & 0xfffbU | (UVar5 & 1) << 2;
  UTILGEN::CchGetString(idsFile1,szEntry);
  sVar6 = GetPrivateProfileString
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                     (LPCSTR)0x11200744,c_common::szWork,0x100,(LPCSTR)CONCAT22(unaff_SS,szIniFile))
  ;
  if (sVar6 < 4) {
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfffe;
  }
  else {
    c_common::ini.flags6 = c_common::ini.flags6 & 0xfffeU | 1;
    PUBLIC::_strcpy((char *)c_common::szBase,(char *)c_common::szWork);
  }
  if (((int)_DATA::vrgszMRU == 0) &&
     (_DATA::vrgszMRU = (char *)CONCAT22(_DATA::vrgszMRU._2_2_,(int)_DATA::vrgszMRU),
     _DATA::vrgszMRU._2_2_ == 0)) {
    _DATA::vrgszMRU = (char *)MEMORY::LpAlloc(0x900,htPerm);
  }
  uVar7 = PUBLIC::_strlen(szEntry);
  for (i = 0; i < 9; i = i + 1) {
    szEntry[uVar7 - 1] = (char)i + '1';
    sVar6 = GetPrivateProfileString
                      ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                       (LPCSTR)0x11200746,
                       (LPSTR)CONCAT22(_DATA::vrgszMRU._2_2_,(int)_DATA::vrgszMRU + i * 0x100),0x100
                       ,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
    if (sVar6 < 4) {
      *(undefined *)((int)_DATA::vrgszMRU + i * 0x100) = 0;
    }
  }
  iPass = 0;
  i = 0;
  pcVar3 = _DATA::vrgszMRU;
  while( true ) {
    _DATA::vrgszMRU._2_2_ = (int)((ulong)pcVar3 >> 0x10);
    _DATA::vrgszMRU._0_2_ = (int)pcVar3;
    _DATA::vrgszMRU = pcVar3;
    if (8 < i) break;
    if (*(char *)((int)_DATA::vrgszMRU + i * 0x100) != '\0') {
      if (i != iPass) {
        pcVar3 = (char *)CONCAT22(_DATA::vrgszMRU._2_2_,(int)_DATA::vrgszMRU + iPass * 0x100);
        pcVar4 = (char *)CONCAT22(_DATA::vrgszMRU._2_2_,(int)_DATA::vrgszMRU + i * 0x100);
        PUBLIC::__fstrcpy(pcVar3,pcVar4);
        *(undefined *)((int)_DATA::vrgszMRU + i * 0x100) = 0;
        pcVar3 = _DATA::vrgszMRU;
      }
      iPass = iPass + 1;
    }
    i = i + 1;
  }
  UTILGEN::CchGetString(idsTurn,szEntry);
  c_common::ini.turn =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                  _DATA::game.turn,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UTILGEN::CchGetString(idsMisc,szSection);
  UTILGEN::CchGetString(idsDefaultpassword,szEntry);
  GetPrivateProfileString
            ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
             (LPCSTR)0x11200748,c_common::vszDefPass,0x10,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
  UTILGEN::CchGetString(idsProgress,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::gd.flags2 = _DATA::gd.flags2 & 0xfbffU | (uint)(UVar5 != 0) << 10;
  UTILGEN::CchGetString(idsNewreports,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::gd.flags4 = _DATA::gd.flags4 & 0xffdfU | (uint)(UVar5 != 0) << 5;
  UTILGEN::CchGetString(idsNohostnames,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::gd.flags4 = _DATA::gd.flags4 & 0xffbfU | (uint)(UVar5 != 0) << 6;
  UTILGEN::CchGetString(idsBackups,szEntry);
  _DATA::vcBackupDirs =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  if ((_DATA::vcBackupDirs < 1) || (999 < _DATA::vcBackupDirs)) {
    _DATA::vcBackupDirs = 1;
  }
  UTILGEN::CchGetString(idsReportplanfld,szEntry);
  _DATA::vrptPlanet.grbitVisible._0_2_ =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),-1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptPlanet.grbitVisible._2_2_ = 0;
  UTILGEN::CchGetString(idsReportplansort,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptPlanet.fAscending = (short)((UVar5 & 0x100) != 0);
  _DATA::vrptPlanet.icolSort = UVar5 & 0xff;
  UTILGEN::CchGetString(idsReportfleetfld,szEntry);
  _DATA::vrptFleet.grbitVisible._0_2_ =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),-1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptFleet.grbitVisible._2_2_ = 0;
  UTILGEN::CchGetString(idsReportfleetsort,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptFleet.fAscending = (short)((UVar5 & 0x100) != 0);
  _DATA::vrptFleet.icolSort = UVar5 & 0xff;
  UTILGEN::CchGetString(idsReportefleetfld,szEntry);
  _DATA::vrptEFleet.grbitVisible._0_2_ =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),-1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptEFleet.grbitVisible._2_2_ = 0;
  UTILGEN::CchGetString(idsReportefltsort,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptEFleet.fAscending = (short)((UVar5 & 0x100) != 0);
  _DATA::vrptEFleet.icolSort = UVar5 & 0xff;
  UTILGEN::CchGetString(idsReportbtlfld,szEntry);
  _DATA::vrptBattle.grbitVisible._0_2_ =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),-1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptBattle.grbitVisible._2_2_ = 0;
  UTILGEN::CchGetString(idsReportbtlsort,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),0,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::vrptBattle.fAscending = (short)((UVar5 & 0x100) != 0);
  _DATA::vrptBattle.icolSort = UVar5 & 0xff;
  UTILGEN::CchGetString(idsReportdefgraph,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),7,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  _DATA::gd.flags4 = _DATA::gd.flags4 & 0xfff0U | UVar5 & 0xf;
  UTILGEN::CchGetString(idsReportefltsort,szEntry);
  if (7 < (_DATA::gd.flags4 & 0xfU)) {
    _DATA::gd.flags4 = _DATA::gd.flags4 & 0xfff0U | 7;
  }
  UTILGEN::CchGetString(idsVcrspeed,szEntry);
  _DATA::viSpeedVCR =
       GetPrivateProfileInt
                 ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),1,
                  (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  PUBLIC::__strdate((char *)c_common::szWork);
  c_common::szWork[5] = '\0';
  c_common::szWork[2] = '\0';
  sVar6 = PUBLIC::_atoi((char *)((int)c_common::szWork + 6));
  sVar8 = PUBLIC::_atoi((char *)c_common::szWork);
  sVar9 = PUBLIC::_atoi((char *)((int)c_common::szWork + 3));
  uVar10 = sVar9 + sVar8 * 0x1f + sVar6 * 0x174;
  UTILGEN::CchGetString(idsHistoryinfo,szEntry);
  UVar5 = GetPrivateProfileInt
                    ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),-1,
                     (LPCSTR)CONCAT22(unaff_SS,szIniFile));
  c_common::uDateInstalled = uVar10;
  if (UVar5 <= uVar10) {
    c_common::uDateInstalled = UVar5;
  }
  _DATA::gd.flags3 =
       _DATA::gd.flags3 & 0xfffdU | (uint)(c_common::uDateInstalled + 0x15 <= uVar10) << 1;
  UTILGEN::CchGetString(idsFonts,szSection);
  for (i = 0; i < 4; i = i + 1) {
    UTILGEN::CchGetString(i + idsArial,szEntry);
    GetPrivateProfileString
              ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
               (LPCSTR)0x11200749,c_common::szWork,0x50,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
    uVar7 = PUBLIC::_strlen((char *)c_common::szWork);
    if ((4 < (int)uVar7) && ((int)uVar7 < 0x20)) {
      PUBLIC::_strcpy((char *)(i * 0x20 + 0x6a6),(char *)c_common::szWork);
    }
  }
  UTILGEN::CchGetString(idsZiporders,szSection);
  PUBLIC::_memset((void *)c_common::vrgZip,0,0x60);
  for (i = 0; i < 4; i = i + 1) {
    PUBLIC::_strcpy(szEntry,szSection);
    uVar7 = PUBLIC::_strlen(szEntry);
    szEntry[uVar7] = (char)i + '1';
    szEntry[uVar7 + 1] = '\0';
    GetPrivateProfileString
              ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
               (LPCSTR)0x1120074a,c_common::szWork,0x50,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
    uVar7 = PUBLIC::_strlen((char *)c_common::szWork);
    if ((0x13 < (int)uVar7) && ((int)uVar7 < 0x21)) {
      iPass = 0;
      for (psz = (char *)c_common::szWork; ((iPass < 0x14 && ('`' < *psz)) && (*psz < 'q'));
          psz = psz + 1) {
        iPass = iPass + 1;
      }
      if (0x13 < iPass) {
        psz = (char *)c_common::szWork;
        for (iPass = 0; iPass < 5; iPass = iPass + 1) {
          *(uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2) =
               *(uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2) & 0xfff |
               (*psz + -0x61) * 0x1000;
          *(uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2) =
               *(uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2) & 0xf000 |
               (int)psz[1] - 0x61U & 0xfff;
          cVar2 = psz[2];
          uVar10 = *(uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2);
          puVar1 = (uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2);
          *puVar1 = *puVar1 & 0xf000;
          puVar1 = (uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2);
          *puVar1 = *puVar1 | ((cVar2 + -0x61) * 0x10 | uVar10) & 0xfff;
          cVar2 = psz[3];
          uVar10 = *(uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2);
          puVar1 = (uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2);
          *puVar1 = *puVar1 & 0xf000;
          puVar1 = (uint *)((int)c_common::vrgZip + i * 0x18 + iPass * 2);
          *puVar1 = *puVar1 | ((cVar2 + -0x61) * 0x100 | uVar10) & 0xfff;
          psz = psz + 4;
        }
        PUBLIC::_strcpy((char *)((int)c_common::vrgZip[0].szName + i * 0x18),psz);
        *(undefined *)((int)&c_common::vrgZip[0].fValid + i * 0x18) = 1;
      }
    }
  }
  PUBLIC::_memset((void *)c_common::vrgZipProd,0,200);
  for (i = 0; i < 5; i = i + 1) {
    PUBLIC::_strcpy(szEntry,szSection);
    uVar7 = PUBLIC::_strlen(szEntry);
    szEntry[uVar7] = 'P';
    szEntry[uVar7 + 1] = (char)i + '1';
    szEntry[uVar7 + 2] = '\0';
    GetPrivateProfileString
              ((LPCSTR)CONCAT22(unaff_SS,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
               (LPCSTR)0x1120074b,c_common::szWork,0x50,(LPCSTR)CONCAT22(unaff_SS,szIniFile));
    uVar7 = PUBLIC::_strlen((char *)c_common::szWork);
    if ((2 < (int)uVar7) && ((int)uVar7 < 0x41)) {
      psz = (char *)c_common::szWork;
      iVar11 = c_common::szWork[1] + -0x61;
      if ((-1 < iVar11) && (iVar11 < 0xd)) {
        iPass = 0;
        for (; ((iPass < iVar11 * 4 + 2 && ('`' < *psz)) && (*psz < 'q')); psz = psz + 1) {
          iPass = iPass + 1;
        }
        if (iVar11 * 4 + 2 <= iPass) {
          uVar7 = PUBLIC::_strlen(psz);
          if (uVar7 < 0xd) {
            PUBLIC::_strcpy((char *)((int)c_common::vrgZipProd + i * 0x28),psz);
            *(bool *)(i * 0x28 + 0x2304) = c_common::szWork[0] != 'a';
            *(undefined *)((int)&c_common::vrgZipProd[0].fValid + i * 0x28) = 1;
            *(undefined *)((int)&c_common::vrgZipProd[0].cpq + i * 0x28) = (char)iVar11;
            psz = (char *)((int)c_common::szWork + 2);
            for (iPass = 0; iPass < iVar11; iPass = iPass + 1) {
              *(int *)(i * 0x28 + 0x2306 + iPass * 2) = *psz + -0x61;
              puVar1 = (uint *)(i * 0x28 + 0x2306 + iPass * 2);
              *puVar1 = *puVar1 | (psz[1] + -0x61) * 0x10;
              puVar1 = (uint *)(i * 0x28 + 0x2306 + iPass * 2);
              *puVar1 = *puVar1 | (psz[2] + -0x61) * 0x100;
              puVar1 = (uint *)(i * 0x28 + 0x2306 + iPass * 2);
              *puVar1 = *puVar1 | (psz[3] + -0x61) * 0x1000;
              psz = psz + 4;
              if (0x3fc < *(uint *)(i * 0x28 + 0x2306 + iPass * 2) >> 6) {
                *(uint *)(i * 0x28 + 0x2306 + iPass * 2) =
                     *(uint *)(i * 0x28 + 0x2306 + iPass * 2) & 0x3f | 0x40;
              }
              if (6 < (*(uint *)(i * 0x28 + 0x2306 + iPass * 2) & 0x3f)) {
                *(uint *)(i * 0x28 + 0x2306 + iPass * 2) =
                     *(uint *)(i * 0x28 + 0x2306 + iPass * 2) & 0xffc0;
              }
            }
          }
        }
      }
    }
  }
  UTILGEN::CchGetString(idsDefault,(char *)c_common::vrgZipProd);
  c_common::vrgZipProd[0].fValid = 1;
  return;
}



// ======================================================================
// Function: GetIniWinRc
// Address: 1000:1020
// ======================================================================


void __cdecl16far INIT::GetIniWinRc(char *szSection,char *szIniFile,StringId ids,WN *pwn)

{
  short sVar1;
  undefined2 unaff_SS;
  bool bVar2;
  short rg [4];
  short fNeg;
  short i;
  char *pch;
  short j;
  RECT rc;
  short cch;
  char szEntry [16];
  short fMaximized;
  short fMinimized;
  short fInitalized;
  
  UTILGEN::CchGetString(ids,szEntry);
  sVar1 = GetPrivateProfileString
                    ((LPCSTR)CONCAT22(0x1120,szSection),(LPCSTR)CONCAT22(unaff_SS,szEntry),
                     (LPCSTR)0x11200738,c_common::szWork,0x14,(LPCSTR)CONCAT22(0x1120,szIniFile));
  if ((sVar1 == 0x11) &&
     (((c_common::szWork[0] == 'M' || (c_common::szWork[0] == 'R')) || (c_common::szWork[0] == 'I'))
     )) {
    pch = (char *)((int)c_common::szWork + 1);
    for (i = 0; i < 4; i = i + 1) {
      rg[i] = 0;
      fNeg = 0;
      for (j = 0; j < 4; j = j + 1) {
        if (*pch == '-') {
          fNeg = 1;
        }
        else {
          if ((*pch < '0') || ('9' < *pch)) goto INIT_NoRc;
          rg[i] = rg[i] * 10 + *pch + -0x30;
        }
        pch = pch + 1;
      }
      if (fNeg != 0) {
        rg[i] = -rg[i];
      }
    }
    rc.left = rg[0];
    rc.top = rg[1];
    rc.right = rg[2];
    rc.bottom = rg[3];
    bVar2 = c_common::szWork[0] == 'M';
    fMinimized = (short)(c_common::szWork[0] == 'I');
    fInitalized = 1;
  }
  else {
INIT_NoRc:
    rc.left = -0x8000;
    rc.right = -0x8000;
    rc.bottom = 0;
    rc.top = 0;
    bVar2 = ids == idsMain;
    fMinimized = 0;
    fInitalized = 0;
  }
  fMaximized = (short)bVar2;
  (pwn->rc).left = rc.left;
  (pwn->rc).top = rc.top;
  (pwn->rc).right = rc.right;
  (pwn->rc).bottom = rc.bottom;
  pwn->flags5 = pwn->flags5 & 0xfffeU | fMaximized;
  pwn->flags5 = pwn->flags5 & 0xfffdU | fMinimized << 1;
  pwn->flags5 = pwn->flags5 & 0xfffbU | fInitalized << 2;
  return;
}



// ======================================================================
// Function: FSerialAndEnvFromSz
// Address: 1020:2aec
// ======================================================================


/* WARNING: Could not reconcile some variable overlaps */

short __cdecl16far MDI::FSerialAndEnvFromSz(long *plSerial,byte *pbEnv,char *pszIn)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  byte *pbVar4;
  undefined2 unaff_SI;
  undefined2 unaff_DI;
  ulong uVar5;
  long lNew2;
  ushort in_stack_0000ffb6;
  byte b64;
  byte rgbRaw2 [21];
  long lTank;
  long lSerial;
  short iPass;
  short iRaw;
  short cBits;
  short i;
  byte bXor;
  short j;
  short fSuccess;
  byte rgbRaw [21];
  
  lNew2 = CONCAT22(unaff_SI,unaff_DI);
  iPass = 0;
  *(undefined2 *)plSerial = 0;
  *(undefined2 *)((int)plSerial + 2) = 0;
  PUBLIC::_memset(pbEnv,0,0xb);
  iRaw = 0;
  cBits = 0;
  uVar5 = 0;
  for (i = 0; i < 0x15; i = i + 1) {
    for (; lTank._0_2_ = (uint)uVar5, cBits < 8; cBits = cBits + 6) {
      if ((*pszIn < 'A') || ('Z' < *pszIn)) {
        if ((*pszIn < 'a') || ('z' < *pszIn)) {
          if ((*pszIn < '0') || ('9' < *pszIn)) {
            if (*pszIn == '-') {
              b64 = 0x3e;
            }
            else {
              b64 = 0x3f;
            }
          }
          else {
            b64 = *pszIn + 4;
          }
        }
        else {
          b64 = *pszIn + 0xb9;
        }
      }
      else {
        b64 = *pszIn + 0xbf;
      }
      uVar5 = (ulong)((uint)lTank | (uint)b64 << ((byte)cBits & 0x1f));
      pszIn = pszIn + 1;
    }
    pbVar4 = rgbRaw2 + iRaw;
    iRaw = iRaw + 1;
    *pbVar4 = (byte)uVar5;
    cBits = cBits + -8;
    uVar5 = PUBLIC::__aFlshr(lNew2,in_stack_0000ffb6);
  }
  for (i = 0; i < 0x15; i = i + 1) {
    rgbRaw[*(byte *)((int)(c_common::rgidPlan + 0x81) + i)] = rgbRaw2[i];
  }
  sVar1 = IO::FValidSerialLong(CONCAT22(rgbRaw._2_2_,rgbRaw._0_2_));
  if (sVar1 == 0) {
    fSuccess = 0;
  }
  else {
    fSuccess = 1;
    UTILGEN::PushRandom(0x11000b,lNew2);
    UTILGEN::Randomize(CONCAT22(rgbRaw._2_2_,rgbRaw._0_2_));
    iRaw = 0xf;
    for (i = 0; i < 0xb; i = i + 1) {
      for (j = (short)rgbRaw[i + 4]; 0 < j; j = j + -1) {
        UTILGEN::Random(0x10);
      }
      if (iPass == 0) {
        uVar2 = rgbRaw[iRaw] & 0xf;
        uVar3 = UTILGEN::Random(0x10);
        if (uVar2 != (uVar3 & 0xff)) {
          fSuccess = 0;
        }
      }
      else {
        uVar2 = (int)(uint)rgbRaw[iRaw] >> 4;
        uVar3 = UTILGEN::Random(0x10);
        if (uVar2 != (uVar3 & 0xff)) {
          fSuccess = 0;
        }
        iRaw = iRaw + 1;
      }
      iPass = iPass + 1U & 1;
    }
    bXor = 0;
    for (i = 0; i < 0xf; i = i + 1) {
      bXor = bXor ^ rgbRaw[i];
    }
    if ((int)(uint)rgbRaw[iRaw] >> 4 != (bXor & 0xf)) {
      fSuccess = 0;
    }
    UTILGEN::PopRandom();
    if (fSuccess != 0) {
      *(undefined2 *)plSerial = rgbRaw._0_2_;
      *(undefined2 *)((int)plSerial + 2) = rgbRaw._2_2_;
      PUBLIC::_memcpy(pbEnv,rgbRaw + 4,0xb);
    }
  }
  return fSuccess;
}



// ======================================================================
// Function: ReadInTileSettings
// NOT FOUND
// ======================================================================

