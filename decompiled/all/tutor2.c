// Decompiled code from stars.exe
// Generated by Ghidra - ExportAllDecompiled.py
// Grouped by nb09_ghidra_globals.json segmap.segname
// 

// ======================================================================
// Function: CchTutorString
// Address: 1100:5a14
// Segment: MEMORY_TUTOR2
// ======================================================================


short CchTutorString(char *pchOut,short idt)

{
  int iVar1;
  byte *pbVar2;
  ushort uVar3;
  bool bVar4;
  byte *pch;
  short iLen;
  char *pszOut;
  short i;
  short iNibble;
  short iBuild;
  byte *pchLen;
  short iChunk;
  short fHigh;
  short iOffset;
  
  iNibble = 0;
  if (idt == iLastTutGet) {
    uVar3 = _strlen(pchOut);
  }
  else {
    pchLen = (byte *)CONCAT22(0x1100,(char *)szBase + 0x92 + (idt >> 6) * 0x40);
    for (i = 0; i < (int)(idt & 0x3fU); i = i + 1) {
      iNibble = iNibble + (uint)*pchLen;
      pchLen = (byte *)CONCAT22(pchLen._2_2_,(byte *)pchLen + 1);
    }
    pch = (byte *)CONCAT22(0x1100,(byte *)(*(int *)((int)rgplr[0].rgEnvVar + 2 +
                                                   (idt >> 6) * 2) + (iNibble >> 1)));
    bVar4 = (iNibble & 1U) == 0;
    pszOut = pchOut;
    iBuild = 0;
    iLen = (uint)*pchLen;
    while (pbVar2 = pch, iVar1 = iLen + -1, iLen != 0) {
      if (bVar4) {
        i = (int)(uint)*pch >> 4;
      }
      else {
        pch = (byte *)CONCAT22(pch._2_2_,(byte *)pch + 1);
        i = *pbVar2 & 0xf;
      }
      bVar4 = !bVar4;
      iBuild = iBuild + i;
      iLen = iVar1;
      if (i != 0xf) {
        *pszOut = *(char *)((int)rgplr[0].rgResSpent + 6 + iBuild);
        pszOut = pszOut + 1;
        iBuild = 0;
      }
    }
    *pszOut = '\0';
    uVar3 = (int)pszOut - (int)pchOut;
  }
  return uVar3;
}



