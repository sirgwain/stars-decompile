// Decompiled code from stars.exe
// Generated by Ghidra - ExportAllDecompiled.py
// Grouped by nb09_ghidra_globals.json segmap.segname
//

// ======================================================================
// Function: TutorDlg
// Address: 10f8:0000
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Enum "WParamMessageId": Some values do not have unique names */

short TutorDlg(HWND hwnd, WMType message, ushort wParam, long lParam)

{
    WParamMessageId WVar1;
    char           *sz;
    ushort          uVar2;
    short           sVar3;
    undefined2      unaff_SS;
    FARPROC         lpDlgProc;
    short           fRet;
    fn_lpProc      *lpProc;
    RECT            rc;
    HMENU           hmenu;

    if (message == WM_DESTROY) {
        StickyDlgPos(hwnd, (POINT *)&ptStickyTutorDlg, 0);
        tutor.hwnd = 0;
        uVar2 = GetASubMenu(hwndFrame, 5);
        CheckMenuItem(uVar2, 0x9c5, 0);
        EndDialog(hwnd, 1);
        EndTutor(1);
        sVar3 = 1;
    } else if (message == WM_PAINT) {
        DrawTutorText(hwnd);
        sVar3 = 1;
    } else if (message == WM_ERASEBKGND) {
        GetClientRect(hwnd, &rc);
        FillRect(wParam, &rc, hbrButtonFace);
        sVar3 = 1;
    } else if (message == WM_CHAR) {
        PostMessage(hwndFrame, WM_CHAR, wParam, lParam);
        sVar3 = 0;
    } else if (message == WM_INITDIALOG) {
        tutor.hwnd = hwnd;
        SetWindowPos(hwnd, 0xffff, 0, 0, 0, 0, 3);
        StickyDlgPos(hwnd, (POINT *)&ptStickyTutorDlg, 1);
        sVar3 = 1;
    } else {
        if (message == WM_COMMAND) {
            if (wParam == 0x9c7) {
                lpDlgProc = MakeProcInstance(PanicDlg, hInst);
                WVar1 = DialogBox(0, IDD_PANIC, hwnd, lpDlgProc);
                FreeProcInstance(lpDlgProc);
                if (WVar1 != 0) {
                    tutor.wFlags = tutor.wFlags & 0xfdffU | (uint)(WVar1 == 0x9ca) << 9;
                    PostMessage(hwndFrame, WM_STARS_CONTINUE, WVar1, 0);
                }
            } else {
                if (wParam == 2) {
                    ShowTutor(0);
                    if (((uint)tutor.wFlags >> 0xe & 1) != 0) {
                        sVar3 = 0x40;
                        sz = PszFormatIds(idsMakeTutorialReappearCompleteTaskChooseTutorial, (short *)0x0);
                        AlertSz(sz, sVar3);
                        tutor.wFlags = tutor.wFlags & 0xbfff;
                    }
                    return 1;
                }
                if (wParam == 0x76) {
                    WinHelp(hwnd, szHelpFile, 1, (long)tutor.idh);
                    return 1;
                }
            }
        }
        sVar3 = 0;
    }
    return sVar3;
}

// ======================================================================
// Function: PanicDlg
// Address: 10f8:026a
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Variable defined which should be unmapped: rc */

short PanicDlg(HWND hwnd, WMType message, ushort wParam, long lParam)

{
    undefined2 unaff_SI;
    undefined2 unaff_DI;
    undefined2 unaff_SS;
    ulong      uVar1;
    RECT       rc;

    if (message == WM_ERASEBKGND) {
        GetClientRect(hwnd, &rc);
        FillRect(wParam, &rc, hbrButtonFace);
        return 1;
    }
    if (message == WM_CTLCOLOR) {
        uVar1 = __aFulshr(CONCAT22(unaff_SI, unaff_DI), rc.left);
        if ((int)uVar1 == 6) {
            SetBkColor(wParam, CONCAT22(crButtonFace._2_2_, (undefined2)crButtonFace));
            return hbrButtonFace;
        }
    } else if (message == WM_COMMAND) {
        if (wParam == 2) {
            EndDialog(hwnd, 0);
            return 1;
        }
        if (wParam == 0x76) {
            WinHelp(hwnd, szHelpFile, 1, (long)tutor.idh);
            return 1;
        }
        if ((wParam == 0x9c9) || (wParam == 0x9ca)) {
            EndDialog(hwnd, wParam);
            return 1;
        }
    }
    return 0;
}

// ======================================================================
// Function: ShowTutor
// Address: 10f8:0374
// Segment: MEMORY_TUTOR
// ======================================================================

void ShowTutor(short fShow)

{
    short sVar1;

    if (tutor.hwnd != 0) {
        if (fShow == 0) {
            sVar1 = 0;
        } else {
            sVar1 = 5;
        }
        ShowWindow(tutor.hwnd, sVar1);
        tutor.wFlags = tutor.wFlags & 0xfffeU | fShow & 1U;
    }
    return;
}

// ======================================================================
// Function: DrawTutorText
// Address: 10f8:03c0
// Segment: MEMORY_TUTOR
// ======================================================================

void DrawTutorText(HWND hwnd)

{
    byte        bVar1;
    HWND        HVar2;
    short       cLen;
    short       fNewLine;
    undefined2  unaff_SS;
    RECT        rc;
    RECT        rcBtn;
    char        rgch[256];
    short       cch;
    short       xLeft;
    short       didt;
    PAINTSTRUCT ps;
    short       fPara;
    short       yTop;
    HDC         hdc;

    hdc = BeginPaint(hwnd, &ps);
    SetBkColor(hdc, CONCAT22(crButtonFace._2_2_, (undefined2)crButtonFace));
    SelectObject(hdc, rghfontArial8[0]);
    GetWindowRect(hwnd, &rc);
    HVar2 = GetDlgItem(hwnd, IDCANCEL);
    GetWindowRect(HVar2, &rcBtn);
    rc.bottom = rcBtn.top;
    ScreenToClient(hwnd, (POINT *)&rc);
    ScreenToClient(hwnd, (POINT *)&rc.right);
    rc.top = rc.top + dyArial8 * 2;
    rc.bottom = rc.bottom - (dyArial8 << 1) / 3;
    rc.left = rc.left + (dyArial8 << 1) / 3;
    rc.right = rc.right - (dyArial8 << 1) / 3;
    SelectObject(hdc, hbrButtonShadow);
    PatBlt(hdc, rc.left, rc.top, rc.right - rc.left, 1, 0xf00021);
    PatBlt(hdc, rc.left, rc.top, 1, rc.bottom - rc.top, 0xf00021);
    SelectObject(hdc, hbrButtonHilite);
    PatBlt(hdc, rc.left, rc.bottom + -1, rc.right - rc.left, 1, 0xf00021);
    PatBlt(hdc, rc.right + -1, rc.top, 1, rc.bottom - rc.top, 0xf00021);
    ExpandRc(&rc, -(dyArial8 / 2), -(dyArial8 / 2));
    yTop = rc.top;
    FillRect(hdc, &rc, hbrButtonFace);
    SetTextColor(hdc, CONCAT22(crButtonText._2_2_, (undefined2)crButtonText));
    didt = 0;
    while ((didt < 8 && (cLen = CchTutorString(rgch, tutor.idt + didt), cLen != 1))) {
        bVar1 = *(byte *)(rgch[0] + 0x175f);
        if (((bVar1 & 1) != 0) && (xLeft = rc.left, didt != 0)) {
            yTop = yTop + dyArial8 / 2;
        }
        if (tutor.idt + didt == tutor.idtBold) {
            SetTextColor(hdc, CONCAT22(crButtonFace._2_2_, (undefined2)crButtonFace));
            SetBkColor(hdc, CONCAT22(crButtonText._2_2_, (undefined2)crButtonText));
        }
        if ((didt == 0) || ((bVar1 & 1) == 0)) {
            fNewLine = 0;
        } else {
            fNewLine = 1;
        }
        WrapTextOut(hdc, &xLeft, &yTop, rgch, cLen, rc.left, rc.right - rc.left, (short *)0x0, fNewLine, 1);
        if (tutor.idt + didt == tutor.idtBold) {
            SetTextColor(hdc, CONCAT22(crButtonText._2_2_, (undefined2)crButtonText));
            SetBkColor(hdc, CONCAT22(crButtonFace._2_2_, (undefined2)crButtonFace));
        }
        didt = didt + 1;
    }
    EndPaint(hwnd, &ps);
    return;
}

// ======================================================================
// Function: StartTutor
// Address: 10f8:06b4
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Enum "WParamMessageId": Some values do not have unique names */

void StartTutor(short fRestart)

{
    short                sVar1;
    short                sVar2;
    char                *pcVar3;
    undefined1          *puVar4;
    undefined2           uVar5;
    undefined2           unaff_SS;
    fn_lpfnTutorDlgProc *pfVar6;
    char                *mbType;
    short                cch;
    short                cx;

    uVar5 = 0x10f8;
    puVar4 = &stack0xfff4;
    if (((uint)gd.grBits >> 0xb & 1) == 0) {
        _memset((TUTOR *)&tutor, 0, 0x2c);
        if (lpfnTutorDlgProc == (fn_lpfnTutorDlgProc *)0x0) {
            pfVar6 = MakeProcInstance(TutorDlg, hInst);
            lpfnTutorDlgProc = pfVar6;
            if (pfVar6 == (fn_lpfnTutorDlgProc *)0x0) {
                sVar1 = 0x10;
                pcVar3 = PszFormatIds(idsMemory, (short *)0x0);
                AlertSz(pcVar3, sVar1);
                pfVar6 = lpfnTutorDlgProc;
                goto LAB_10f8_0a29;
            }
        }
        gd.grBits._0_2_ = (uint)gd.grBits & 0xf7ff | 0x800;
        SaveGameState();
        if (fFreeingTitle == 0) {
            fFreeingTitle = 1;
            DestroyWindow(hwndTitle);
            hwndTitle = 0;
            ShowWindow(hwndFrame, 5);
        }
        grbitScan = 0x4e0;
        sVar1 = GetSystemMetrics(0);
        if (sVar1 < 0x500) {
            if (sVar1 < 0x400) {
                if (sVar1 < 800) {
                    iScanZoom = 0;
                } else {
                    iScanZoom = 1;
                }
            } else {
                iScanZoom = 2;
            }
        } else {
            iScanZoom = 3;
        }
        if (((int)game.lid == 0) && (game.lid._2_2_ == 0)) {
            sVar1 = CchGetString(idsTutorial, (char *)szBase);
            if (fRestart == 0) {
                _strcat((char *)szBase, (char *)0x148a);
                sVar2 = __access((char *)szBase, 0);
                if (sVar2 != -1) {
                    mbType = (char *)s_M6102__MATH___floating_point_err_1120_2022 + 2;
                    pcVar3 = PszFormatIds(idsTutorialHasRunBeforeWouldLikeDestroy, (short *)0x0);
                    sVar2 = AlertSz(pcVar3, (short)mbType);
                    if (sVar2 != 6) {
                        ((char *)szBase)[sVar1] = '\0';
                        _strcat((char *)szBase, (char *)0x148e);
                        ini.wFlags = ini.wFlags & 0xfffe | 1;
                        sVar2 = FOpenGame(hwndFrame, 0);
                        if (0 < sVar2) {
                            CreateChildWindows();
                        }
                        ini.wFlags = ini.wFlags & 0xfffe;
                    }
                }
                ((char *)szBase)[sVar1] = '\0';
            }
            if (((int)game.lid == 0) && (game.lid._2_2_ == 0)) {
                CreateTutorWorld();
                _memset((ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1, 0, 0x1a);
                vrgZipProd[0].fValid = 1;
                gd.grBits2._0_2_ = (uint)gd.grBits2 & 0xffdf | 0x20;
            }
            InitializeMenu(0);
            PostMessage(hwndFrame, WM_COMMAND, IDM_FRAME_POST_OPEN, 0);
            if (fFreeingTitle == 0) {
                fFreeingTitle = 1;
                DestroyWindow(hwndTitle);
                hwndTitle = 0;
            }
            ShowWindow(hwndFrame, 5);
        }
        puVar4 = &stack0xfff2;
        tutor.idsError = -1;
        tutor.idt = 0;
        tutor.idtBold = 0;
        tutor.wFlags = tutor.wFlags & 0xbbffU | 0x4000;
        while (true) {
            uVar5 = 0x10f8;
            sVar1 = FTutorTaskDone();
            if ((sVar1 == 0) || (((uint)tutor.wFlags >> 3 & 1) != 0))
                break;
            tutor.idt = tutor.idt + 8;
        }
        if (((uint)tutor.wFlags >> 4 & 1) != 0) {
            EndTutor(0);
            pfVar6 = lpfnTutorDlgProc;
            goto LAB_10f8_0a29;
        }
        if (tutor.hwnd == 0) {
            uVar5 = 0x14f8;
            CreateDialog(0, IDD_TUTOR, hwndFrame, lpfnTutorDlgProc);
        }
        if (tutor.idt != 0) {
            if (((uint)tutor.wFlags >> 3 & 1) == 0) {
                tutor.idt = tutor.idt + -8;
            }
            tutor.idtBold = tutor.idt;
            uVar5 = 0x10f8;
            AdvanceTutor();
            puVar4 = &stack0xfff2;
        }
    }
    *(undefined2 *)(puVar4 + -2) = 1;
    *(undefined2 *)(puVar4 + -4) = uVar5;
    *(undefined2 *)(puVar4 + -6) = 0xa11;
    ShowTutor(*(short *)(puVar4 + -2));
    *(ushort *)(puVar4 + -2) = tutor.hwnd;
    *(undefined2 *)(puVar4 + -4) = 0;
    *(undefined2 *)(puVar4 + -6) = 0;
    *(undefined2 *)(puVar4 + -8) = 1;
    *(undefined2 *)(puVar4 + -10) = 0x10f8;
    *(undefined2 *)(puVar4 + -0xc) = 0xa29;
    InvalidateRect(*(HWND *)(puVar4 + -2), *(RECT **)(puVar4 + -6), *(BOOL *)(puVar4 + -8));
    pfVar6 = lpfnTutorDlgProc;
LAB_10f8_0a29:
    lpfnTutorDlgProc._2_2_ = (undefined2)((ulong)pfVar6 >> 0x10);
    lpfnTutorDlgProc._0_2_ = (fn_lpfnTutorDlgProc *)pfVar6;
    return;
}

// ======================================================================
// Function: AdvanceTutor
// Address: 10f8:0a30
// Segment: MEMORY_TUTOR
// ======================================================================

void AdvanceTutor(void)

{
    short      sVar1;
    short      sVar2;
    int        iVar3;
    char      *pcVar4;
    undefined2 unaff_SS;
    bool       bVar5;
    RECT       rc;
    short      fTaskDone;
    short      idtT;
    short      fRedraw;
    char       szTitle[50];

    sVar2 = tutor.idtBold;
    tutor.wFlags = tutor.wFlags & 0xfffb;
    sVar1 = FTutorTaskDone();
    bVar5 = sVar2 != tutor.idtBold;
    if (sVar1 != 0) {
        if (((uint)tutor.wFlags >> 3 & 1) == 0) {
            do {
                tutor.idt = tutor.idt + 8;
                tutor.idsError = -1;
                tutor.wFlags = tutor.wFlags & 0xfbdfU | 0x20;
                tutor.idtBold = tutor.idt;
                sVar2 = FTutorTaskDone();
                if (sVar2 == 0)
                    break;
            } while (((uint)tutor.wFlags >> 3 & 1) == 0);
            bVar5 = true;
            tutor.wFlags = tutor.wFlags & 0xffdf;
        } else {
            tutor.idh = 0xdb6;
        }
        if ((0x27f < tutor.idt) || (((uint)tutor.wFlags >> 4 & 1) != 0)) {
            if (tutor.idsError != 0x20a) {
                TutorError(0x20a);
            }
            EndTutor(0);
            return;
        }
    }
    if (bVar5) {
        iVar3 = tutor.idt / 8 + 1;
        pcVar4 = PszGetCompressedString(idsStarsTutorPageD80);
        _wsprintf(szTitle, pcVar4, iVar3);
        SetWindowText(tutor.hwnd, szTitle);
        ShowTutor(1);
        GetWindowRect(tutor.hwnd, &rc);
        ScreenToClient(tutor.hwnd, (POINT *)&rc);
        ScreenToClient(tutor.hwnd, (POINT *)&rc.right);
        ExpandRc(&rc, -dyArial8, dyArial8 * -2);
        InvalidateRect(tutor.hwnd, &rc, 1);
    }
    return;
}

// ======================================================================
// Function: EndTutor
// Address: 10f8:0c02
// Segment: MEMORY_TUTOR
// ======================================================================

void EndTutor(short fClose)

{
    DWORD dw;

    if (((uint)gd.grBits >> 0xb & 1) != 0) {
        gd.grBits._0_2_ = (uint)gd.grBits & 0xf7ff;
        if (tutor.hwnd != 0) {
            DestroyWindow(tutor.hwnd);
        }
        game.wCrap = game.wCrap & 0xfff7;
        if (fClose == 0) {
            tutor.wFlags = tutor.wFlags & 0xdfffU | 0x2000;
        } else {
            RestoreGameState();
        }
        _memset((TUTOR *)&tutor, 0, 0x2c);
        dw = GetTickCount();
        Randomize2(dw);
    }
    return;
}

// ======================================================================
// Function: SaveGameState
// Address: 10f8:0c90
// Segment: MEMORY_TUTOR
// ======================================================================

void SaveGameState(void)

{
    ZIPPRODQ1  *pZVar1;
    undefined2 *puVar2;
    ZIPPRODQ1  *pZVar3;
    byte        bVar4;
    ushort      uVar5;
    UINT        UVar6;
    int         iVar7;
    ZIPPRODQ1  *pZVar8;
    undefined2 *puVar9;
    ZIPPRODQ1  *pZVar10;
    bool        bVar11;
    HMENU       hmenu;

    tutor.grbitScan = grbitScan;
    tutor.iScanZoom = iScanZoom;
    tutor.wFlags = tutor.wFlags & 0xf7fdU | (gd.grBits._2_2_ >> 0xf) << 0xb;
    pZVar8 = (ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1;
    puVar9 = (undefined2 *)&tutor.zpq;
    for (iVar7 = 0xd; iVar7 != 0; iVar7 = iVar7 + -1) {
        puVar2 = puVar9;
        puVar9 = puVar9 + 1;
        pZVar1 = pZVar8;
        pZVar8 = pZVar8->rgpq;
        *puVar2 = *pZVar1;
    }
    tutor.wFlags = tutor.wFlags & 0xefffU | (vrgZipProd[0].fValid & 1) << 0xc;
    pZVar8 = (ZIPPRODQ1 *)&vrgZipProd[4].u_ZIPPRODQ_0x000e.zpq1;
    pZVar10 = (ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1;
    for (iVar7 = 0xd; iVar7 != 0; iVar7 = iVar7 + -1) {
        pZVar3 = pZVar10;
        pZVar10 = pZVar10->rgpq;
        pZVar1 = pZVar8;
        pZVar8 = pZVar8->rgpq;
        bVar4 = pZVar1->cpq;
        pZVar3->fNoResearch = pZVar1->fNoResearch;
        pZVar3->cpq = bVar4;
    }
    vrgZipProd[0].fValid = vrgZipProd[4].fValid;
    if (-1 < (int)gd.grBits._2_2_) {
        uVar5 = GetASubMenu(hwndFrame, 1);
        bVar11 = -1 < (int)gd.grBits._2_2_;
        gd.grBits._2_2_ = gd.grBits._2_2_ & 0x7fff | (uint)bVar11 << 0xf;
        if (bVar11) {
            UVar6 = 8;
        } else {
            UVar6 = 0;
        }
        CheckMenuItem(uVar5, 0xb3, UVar6);
        RefitFrameChildren();
    }
    tutor.icolFSort = vrptFleet.icolSort;
    if ((vrptFleet.icolSort != 1) || (vrptFleet.fAscending == 0)) {
        vrptFleet.icolSort = 1;
        vrptFleet.fAscending = 1;
        InvalidateReport(1, 0);
    }
    if ((((int)game.lid != 0) || (game.lid._2_2_ != 0)) && ((game.wCrap >> 3 & 1) == 0)) {
        DestroyCurGame();
    }
    return;
}

// ======================================================================
// Function: RestoreGameState
// Address: 10f8:0e1c
// Segment: MEMORY_TUTOR
// ======================================================================

void RestoreGameState(void)

{
    ZIPPRODQ1  *pZVar1;
    undefined2 *puVar2;
    undefined2  uVar3;
    ZIPPRODQ1  *pZVar4;
    byte        bVar5;
    ushort      uVar6;
    UINT        UVar7;
    int         iVar8;
    ZIPPRODQ1  *pZVar9;
    undefined2 *puVar10;
    ZIPPRODQ1  *pZVar11;
    bool        bVar12;
    HMENU       hmenu;

    grbitScan = tutor.grbitScan;
    iScanZoom = tutor.iScanZoom;
    pZVar9 = (ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1;
    pZVar11 = (ZIPPRODQ1 *)&vrgZipProd[4].u_ZIPPRODQ_0x000e.zpq1;
    for (iVar8 = 0xd; iVar8 != 0; iVar8 = iVar8 + -1) {
        pZVar4 = pZVar11;
        pZVar11 = pZVar11->rgpq;
        pZVar1 = pZVar9;
        pZVar9 = pZVar9->rgpq;
        bVar5 = pZVar1->cpq;
        pZVar4->fNoResearch = pZVar1->fNoResearch;
        pZVar4->cpq = bVar5;
    }
    vrgZipProd[4].fValid = vrgZipProd[0].fValid;
    puVar10 = (undefined2 *)&tutor.zpq;
    pZVar9 = (ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1;
    for (iVar8 = 0xd; iVar8 != 0; iVar8 = iVar8 + -1) {
        pZVar1 = pZVar9;
        pZVar9 = pZVar9->rgpq;
        puVar2 = puVar10;
        puVar10 = puVar10 + 1;
        uVar3 = *puVar2;
        pZVar1->fNoResearch = (char)uVar3;
        pZVar1->cpq = (char)((uint)uVar3 >> 8);
    }
    vrgZipProd[0].fValid = (byte)((uint)tutor.wFlags >> 0xc) & 1;
    if (gd.grBits._2_2_ >> 0xf != ((uint)tutor.wFlags >> 0xb & 1)) {
        uVar6 = GetASubMenu(hwndFrame, 1);
        bVar12 = -1 < (int)gd.grBits._2_2_;
        gd.grBits._2_2_ = gd.grBits._2_2_ & 0x7fff | (uint)bVar12 << 0xf;
        if (bVar12) {
            UVar7 = 8;
        } else {
            UVar7 = 0;
        }
        CheckMenuItem(uVar6, 0xb3, UVar7);
        RefitFrameChildren();
    }
    if (vrptFleet.icolSort != tutor.icolFSort) {
        vrptFleet.icolSort = tutor.icolFSort;
        InvalidateReport(1, 1);
    }
    return;
}

// ======================================================================
// Function: FAskKillTutor
// Address: 10f8:0f36
// Segment: MEMORY_TUTOR
// ======================================================================

short FAskKillTutor(void)

{
    char *sz;
    short sVar1;
    char *mbType;

    if (game.turn < 0x1e) {
        mbType = (char *)s_M6102__MATH___floating_point_err_1120_2022 + 2;
        sz = PszFormatIds(idsCurrentlyRunningStarsTutorialDoWantExit, (short *)0x0);
        sVar1 = AlertSz(sz, (short)mbType);
        if (sVar1 != 6) {
            return 0;
        }
    }
    EndTutor(1);
    return 1;
}

// ======================================================================
// Function: FTutorTaskDone
// Address: 10f8:0fbc
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Enum "WParamMessageId": Some values do not have unique names */

short FTutorTaskDone(void)

{
    PLORD     *pPVar1;
    PLPROD    *pPVar2;
    short      sVar3;
    uint       uVar4;
    SHDEF     *pSVar5;
    undefined2 uVar6;
    LRESULT    LVar7;
    FLEET     *pFVar8;
    PLANET    *pPVar9;
    short      sVar10;
    short      sVar11;
    short      sVar12;
    HS         local_c;
    HS         local_8;

    switch (game.turn) {
    case 0:
        if (tutor.idt == 0) {
            tutor.idtBold = 5;
            uVar4 = FCheckMessages(9999, -1, 0);
        } else if (tutor.idt == 8) {
            tutor.idtBold = 0xb;
            sVar3 = FCheckSelection(grobjFleet, 0);
            if (sVar3 == 0) {
                uVar4 = 0;
            } else {
                tutor.idtBold = 0xf;
                uVar4 = FCheckFleetWP(0, 1, grobjPlanet, 0xc, 0, 0xffff);
            }
        } else if (tutor.idt == 0x10) {
            tutor.idtBold = 0x12;
            sVar3 = FCheckSelection(grobjFleet, 1);
            if (sVar3 == 0) {
                tutor.idh = 0x1771;
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x15;
                uVar4 = FCheckFleetWP(1, 1, grobjPlanet, 0x10, 0, 0xffff);
            }
        } else if (tutor.idt == 0x18) {
            sVar3 = FCheckSelection(grobjFleet, 4);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 3);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 2);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x19;
                    } else {
                        tutor.idtBold = 0x1b;
                    }
                } else {
                    tutor.idtBold = 0x1d;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x1f;
                uVar4 = FCheckFleetWP(4, 1, grobjPlanet, 0xf, 0, 0xffff);
            }
        } else if (tutor.idt == 0x20) {
            sVar3 = FCheckSelection(grobjFleet, 4);
            if (((sVar3 == 0) || (((uint)tutor.wFlags >> 10 & 1) != 0)) || (((uint)tutor.wFlags >> 9 & 1) != 0)) {
                sVar3 = FCheckSelection(grobjFleet, 5);
                if (((sVar3 == 0) || (((uint)tutor.wFlags >> 10 & 1) != 0)) || (((uint)tutor.wFlags >> 9 & 1) != 0)) {
                    sVar3 = FCheckResearch(1, 6, 0xf);
                    if (sVar3 != 0) {
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        tutor.idtBold = 0x27;
                        return 1;
                    }
                    if (pctResGlob == -1) {
                        tutor.idtBold = 0x25;
                    } else {
                        tutor.idtBold = 0x26;
                    }
                } else {
                    tutor.idtBold = 0x22;
                }
            } else {
                tutor.idtBold = 0x20;
            }
            uVar4 = 0;
        } else {
            uVar4 = 0;
        }
        break;
    case 1:
        if (tutor.idt == 0x28) {
            sVar3 = FCheckQueue(0xd, 0, grobjPlanet, 7, 0x14, 0);
            if (sVar3 == 0) {
                if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                    tutor.idtBold = 0x2a;
                } else {
                    tutor.idtBold = 0x2b;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x2f;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 2:
        if (tutor.idt == 0x30) {
            sVar3 = FCheckFleetWP(1, 1, grobjPlanet, 0x15, 0, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x30;
                } else {
                    tutor.idtBold = 0x32;
                }
                sVar3 = FCheckFleetWP(0, 1, grobjPlanet, 9, 0, 0xffff);
                if (sVar3 == 0) {
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x33;
                    sVar3 = FCheckFleetWP(0, 2, grobjPlanet, 3, 0, 0xffff);
                    if (sVar3 == 0) {
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x34;
                        sVar3 = FCheckFleetWP(0, 3, grobjPlanet, 8, 0, 0xffff);
                        if (sVar3 == 0) {
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x35;
                            sVar3 = FCheckFleetWP(0, 4, grobjPlanet, 5, 0, 0xffff);
                            if (sVar3 == 0) {
                                uVar4 = 0;
                            } else {
                                tutor.idtBold = 0x36;
                                sVar3 = FCheckFleetWP(0, 5, grobjPlanet, 2, 0, 0xffff);
                                if (sVar3 == 0) {
                                    uVar4 = 0;
                                } else {
                                    tutor.idtBold = 0x37;
                                    uVar4 = FCheckSelection(grobjFleet, 1);
                                }
                            }
                        }
                    }
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x38) {
            sVar3 = FCheckFleetWP(4, 1, grobjPlanet, 0xe, 0, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x39;
                sVar3 = FCheckFleetWP(1, 1, grobjPlanet, 0x15, 0, 0xffff);
                if (sVar3 == 0) {
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x3a;
                    sVar3 = FCheckFleetWP(1, 2, grobjPlanet, 0x13, 0, 0xffff);
                    if (sVar3 == 0) {
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x3b;
                        sVar3 = FCheckFleetWP(1, 3, grobjPlanet, 0x14, 0, 0xffff);
                        if (sVar3 == 0) {
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x3c;
                            sVar3 = FCheckFleetWP(1, 4, grobjPlanet, 7, 0, 0xffff);
                            if (sVar3 == 0) {
                                uVar4 = 0;
                            } else {
                                sVar3 = FCheckMessages(idmColonistsForcedTransportDiedBecauseDidColonize, -1, 0);
                                if (sVar3 == 0) {
                                    tutor.idtBold = 0x3d;
                                } else {
                                    tutor.idtBold = 0x3f;
                                }
                                uVar4 = FCheckSelection(grobjFleet, 4);
                            }
                        }
                    }
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x40) {
            sVar3 = FCheckFleetWP(5, 1, grobjPlanet, 0xc, 3, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x40;
                sVar3 = FCheckFleetWP(4, 1, grobjPlanet, 0xe, 0, 0xffff);
                if (sVar3 == 0) {
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x41;
                    sVar3 = FCheckFleetWP(4, 2, grobjPlanet, 0x11, 0, 0xffff);
                    if (sVar3 == 0) {
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x42;
                        sVar3 = FCheckFleetWP(4, 3, grobjPlanet, 0x12, 0, 0xffff);
                        if (sVar3 == 0) {
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x43;
                            sVar3 = FCheckFleetWP(4, 4, grobjPlanet, 0x17, 0, 0xffff);
                            if (sVar3 == 0) {
                                uVar4 = 0;
                            } else {
                                tutor.idtBold = 0x44;
                                sVar3 = FCheckFleetWP(4, 5, grobjPlanet, 0x16, 0, 0xffff);
                                if (sVar3 == 0) {
                                    uVar4 = 0;
                                } else {
                                    sVar3 = FCheckMessages(idmPlanetaryDefensesGroundTroopsDestroyedInvadingTr, -1, 0);
                                    if (sVar3 == 0) {
                                        tutor.idtBold = 0x45;
                                    } else {
                                        tutor.idtBold = 0x47;
                                    }
                                    uVar4 = FCheckSummary(grobjPlanet, 0xc);
                                }
                            }
                        }
                    }
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x48) {
            sVar3 = FCheckColonizeWP(2, 0x10, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckFleetWP(5, 1, grobjPlanet, 0xc, 3, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckFleetWP(5, 1, grobjPlanet, 0xc, 0, 0xffff);
                    if (sVar3 == 0) {
                        sVar3 = FCheckSelection(grobjFleet, 5);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x4c;
                        } else {
                            tutor.idtBold = 0x4d;
                        }
                    } else {
                        tutor.idtBold = 0x4f;
                    }
                    uVar4 = 0;
                } else {
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = 1;
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x50) {
            sVar3 = FCheckColonizeWP(2, 0x10, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSummary(grobjPlanet, 0x10);
                if (sVar3 == 0) {
                    sVar3 = FCheckSummary(grobjPlanet, 0xf);
                    if (sVar3 != 0) {
                        sVar3 = FCheckMessages(9999, -1, 0);
                        if (sVar3 == 0) {
                            if (((uint)tutor.wFlags >> 10 & 1) == 0) {
                                tutor.idtBold = 0x53;
                            } else {
                                tutor.idtBold = 0x54;
                            }
                        } else {
                            tutor.idtBold = 0x56;
                        }
                    }
                    uVar4 = 0;
                } else {
                    uVar4 = 1;
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x58) {
            sVar12 = 0x19;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(2);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 2);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x59;
                } else if (mdXferDlg == -1) {
                    tutor.idh = 0x5ea;
                    tutor.idtBold = 0x5a;
                } else {
                    tutor.idtBold = 0x5b;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckColonizeWP(2, 0x10, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckFleetWP(2, 1, grobjPlanet, 0x10, 0, 0xffff);
                    if (sVar3 == 0) {
                        sVar3 = FCheckSelection(grobjFleet, 2);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x59;
                        } else {
                            tutor.idtBold = 0x5c;
                        }
                    } else {
                        tutor.idtBold = 0x5d;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x5f;
                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                    uVar4 = 1;
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 3:
        if (tutor.idt == 0x60) {
            sVar3 = FCheckMessages(~idmColonistsDroppedMassacredGroundTroops, 0x36, 1);
            if (sVar3 == 0) {
                tutor.idtBold = 0x61;
                uVar4 = 0;
            } else {
                sVar3 = FCheckQueue(0xd, 0, grobjPlanet, 1, 0x1e, 0);
                if (sVar3 == 0) {
                    sVar3 = FCheckMessages(idmColonistsDroppedDestroyedPlanetaryDefensesRestMa, -1, 0);
                    if ((sVar3 == 0) || (sVar3 = FCheckSelection(grobjPlanet, 0xd), sVar3 == 0)) {
                        tutor.idtBold = 0x62;
                    } else if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                        tutor.idtBold = 0x65;
                    } else {
                        tutor.idtBold = 0x66;
                    }
                    uVar4 = 0;
                } else {
                    uVar4 = 1;
                }
            }
        } else if (tutor.idt == 0x68) {
            sVar3 = FCheckQueue(0x10, 0, grobjPlanet, 7, 3, 1);
            if ((sVar3 == 0) || (sVar3 = FCheckQueue(0x10, 1, grobjPlanet, 8, 3, 1), sVar3 == 0)) {
                sVar3 = FCheckMessages(idmGroundTroopsValiantlyDestroyedAttackingBarbarian, -1, 0);
                if ((sVar3 == 0) || (sVar3 = FCheckSelection(grobjPlanet, 0x10), sVar3 == 0)) {
                    tutor.idtBold = 0x68;
                } else if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                    tutor.idtBold = 0x6a;
                } else {
                    tutor.idtBold = 0x6b;
                }
                uVar4 = 0;
            } else {
                sVar12 = 0xd2;
                sVar11 = 0;
                sVar10 = 0;
                sVar3 = 0;
                pFVar8 = LpflFromId(3);
                sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 3);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x6d;
                    } else if (mdXferDlg == -1) {
                        tutor.idtBold = 0x6e;
                    } else {
                        tutor.idtBold = 0x6f;
                    }
                    uVar4 = 0;
                } else {
                    uVar4 = 1;
                }
            }
        } else if (tutor.idt == 0x70) {
            sVar3 = FCheckXferWP(3, 1, 0x10, 0xffff, rgiaQuikDrop);
            if (sVar3 == 0) {
                sVar3 = FCheckFleetWP(3, 1, grobjPlanet, 0x10, 1, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckFleetWP(3, 1, grobjPlanet, 0x10, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x70;
                    } else {
                        tutor.idtBold = 0x71;
                    }
                } else {
                    tutor.idtBold = 0x72;
                }
                uVar4 = 0;
            } else {
                pFVar8 = LpflFromId(0);
                if (((FLEET *)pFVar8)->cord < 6) {
                    uVar4 = 1;
                } else {
                    sVar3 = FCheckSelection(grobjFleet, 0);
                    if (sVar3 == 0) {
                        sVar3 = FCheckSummary(grobjPlanet, 9);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x73;
                        } else {
                            tutor.idtBold = 0x76;
                        }
                        uVar4 = 0;
                    } else {
                        uVar4 = 1;
                    }
                }
            }
        } else if (tutor.idt == 0x78) {
            pFVar8 = LpflFromId(0);
            if (((FLEET *)pFVar8)->cord == 6) {
                sVar3 = FCheckSummary(grobjPlanet, 9);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x79;
                } else {
                    tutor.idtBold = 0x7b;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x7f;
                tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 4:
        if (tutor.idt == 0x80) {
            pFVar8 = LpflFromId(4);
            if (((FLEET *)pFVar8)->cord == 6) {
                sVar3 = FCheckSelection(grobjFleet, 4);
                if (sVar3 == 0) {
                    sVar3 = FCheckSummary(grobjPlanet, 0xe);
                    if ((sVar3 == 0) && (sVar3 = FCheckSummary(grobjFleet, 4), sVar3 == 0)) {
                        tutor.idtBold = 0x80;
                    } else {
                        tutor.idtBold = 0x82;
                    }
                } else {
                    sVar3 = FCheckSummary(grobjPlanet, 0xe);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x83;
                    } else {
                        tutor.idtBold = 0x84;
                    }
                }
                uVar4 = 0;
            } else {
                pPVar9 = LpplFromId(0xd);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if (((PLPROD *)pPVar2)->iprodMac == 3) {
                    uVar4 = 1;
                } else {
                    sVar3 = FCheckSelection(grobjPlanet, 0xd);
                    if (sVar3 == 0) {
                        sVar3 = FCheckSummary(grobjPlanet, 0x15);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x85;
                        } else {
                            tutor.idtBold = 0x87;
                        }
                        uVar4 = 0;
                    } else {
                        uVar4 = 1;
                    }
                }
            }
        } else if (tutor.idt == 0x88) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac == 3) && (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 2, 1, 0), sVar3 != 0)) {
                tutor.idtBold = 0x8f;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            } else {
                if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                    tutor.idtBold = 0x88;
                } else {
                    tutor.idtBold = 0x89;
                }
                uVar4 = 0;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 5:
        if (tutor.idt == 0x90) {
            sVar12 = 0x19;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(2);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 2);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x90;
                } else if (mdXferDlg == -1) {
                    tutor.idtBold = 0x92;
                } else {
                    tutor.idtBold = 0x94;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckFleetWP(2, 1, grobjPlanet, 0xe, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckScanner(3, -1);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x96;
                    } else {
                        tutor.idtBold = 0x97;
                    }
                    uVar4 = 0;
                } else {
                    uVar4 = 1;
                }
            }
        } else if (tutor.idt == 0x98) {
            sVar3 = FCheckColonizeWP(2, 0xe, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x98;
                uVar4 = 0;
            } else {
                sVar3 = FCheckFleetWP(3, 1, grobjPlanet, 0xd, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckScanner(0, -1);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x99;
                    } else {
                        sVar3 = FCheckSelection(grobjFleet, 3);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x9a;
                        } else {
                            tutor.idtBold = 0x9b;
                        }
                    }
                    uVar4 = 0;
                } else {
                    pFVar8 = LpflFromId(0);
                    if (((FLEET *)pFVar8)->cord == 5) {
                        sVar3 = FCheckMessages(9999, -1, 0);
                        if (sVar3 == 0) {
                            sVar3 = FCheckSelection(grobjPlanet, 0x10);
                            if (sVar3 == 0) {
                                tutor.idtBold = 0x9c;
                            } else {
                                tutor.idtBold = 0x9e;
                            }
                        } else {
                            tutor.idtBold = 0x9e;
                        }
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x9f;
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 6:
        if (tutor.idt == 0xa0) {
            sVar3 = FCheckXferWP(3, 1, 0xc, 0xffff, rgiaQuikLoad);
            if (sVar3 == 0) {
                sVar3 = FCheckFleetWP(3, 1, grobjPlanet, 0xc, 1, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckFleetWP(3, 1, grobjPlanet, 0xc, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        sVar3 = FCheckSelection(grobjFleet, 3);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0xa0;
                        } else {
                            tutor.idtBold = 0xa3;
                        }
                    } else {
                        tutor.idtBold = 0xa4;
                    }
                } else {
                    tutor.idtBold = 0xa5;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0xa6;
                uVar4 = FCheckFleetWP(3, 2, grobjPlanet, 0xd, 0xffff, 0xffff);
            }
        } else if (tutor.idt == 0xa8) {
            tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
            sVar3 = FCheckXferWP(3, 2, 0xd, 0xffff, rgiaQuikDrop);
            if (sVar3 == 0) {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                tutor.idtBold = 0xaa;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                tutor.idh = 0x5ee;
                tutor.idtBold = 0xab;
                pFVar8 = LpflFromId(3);
                if ((((FLEET *)pFVar8)->wFlags_0x4 >> 9 & 1) == 0) {
                    uVar4 = 0;
                } else {
                    tutor.idh = 0x423;
                    pPVar9 = LpplFromId(0xd);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac == 3) && (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 2, 1, 0), sVar3 != 0)) {
                        tutor.idtBold = 0xaf;
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        uVar4 = 1;
                    } else {
                        sVar3 = FCheckSelection(grobjPlanet, 0xd);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0xad;
                        } else {
                            tutor.idtBold = 0xae;
                        }
                        uVar4 = 0;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 7:
        if (tutor.idt == 0xb0) {
            sVar12 = 0x19;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(6);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                tutor.idtBold = 0xb0;
                uVar4 = 0;
            } else {
                sVar3 = FCheckColonizeWP(6, 0x12, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckScanner(3, -1);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0xb1;
                    } else {
                        tutor.idtBold = 0xb3;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idh = 0x5e3;
                    pPVar9 = LpplFromId(0xd);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 2, 3, 0), sVar3 == 0)) {
                        tutor.idtBold = 0xb5;
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckScanner(0, -1);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0xb6;
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0xb8) {
            sVar3 = FCheckMessages(~idmColonistsDroppedMassacredGroundTroops, 0x38, 1);
            if (sVar3 == 0) {
                sVar3 = FCheckMessages(idmGroundTroopsValiantlyDestroyedAttackingBarbarian, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0xb8;
                } else {
                    tutor.idtBold = 0xba;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckQueue(0x10, 0, grobjPlanet, 1, 10, 1);
                if ((sVar3 == 0) || (sVar3 = FCheckQueue(0x10, 1, grobjPlanet, 0, 10, 1), sVar3 == 0)) {
                    sVar3 = FCheckSelection(grobjPlanet, 0x10);
                    if (sVar3 == 0) {
                        sVar3 = FCheckMessages(idmPlanetaryDefensesGroundTroopsDestroyedInvadingTr, -1, 0);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0xbb;
                        } else {
                            tutor.idtBold = 0xbc;
                        }
                    } else if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                        tutor.idtBold = 0xbc;
                    } else {
                        tutor.idtBold = 0xbd;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0xbe;
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = FCheckMessages(9999, -1, 0);
                }
            }
        } else if (tutor.idt == 0xc0) {
            if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((uint)tutor.wFlags >> 9 & 1) == 0)) {
                sVar3 = FCheckSummary(grobjFleet, 0x200);
                if (sVar3 == 0) {
                    tutor.idtBold = 0xc0;
                    return 0;
                }
                tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
            }
            tutor.idh = 0x5e3;
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(0xd, 2, grobjFleet, 0, 2, 0), sVar3 == 0)) {
                tutor.idtBold = 0xc4;
                uVar4 = 0;
            } else {
                tutor.idtBold = 0xc6;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 8:
        if (tutor.idt == 200) {
            if (((rgplr[0].wFlags_0x4 & 0xfff) == 0xb) && (sVar3 = FCheckColonizeWP(10, 8, 0xffff), sVar3 != 0)) {
                uVar4 = 1;
            } else {
                if (((rgplr[0].wFlags_0x4 & 0xfff) == 9) || (mdXferDlg == 1)) {
                    sVar3 = FCheckSelection(grobjFleet, 7);
                    if (sVar3 == 0) {
                        tutor.idtBold = 200;
                    } else if (mdXferDlg == 1) {
                        tutor.idtBold = 0xcb;
                    } else {
                        tutor.idtBold = 0xca;
                    }
                } else {
                    sVar12 = 0x32;
                    sVar11 = 0;
                    sVar10 = 0;
                    sVar3 = 0;
                    pFVar8 = LpflFromId(7);
                    sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                    if ((sVar3 == 0) || (sVar3 = FCheckFleetWP(7, 1, grobjPlanet, 8, 2, 0xffff), sVar3 == 0)) {
                        tutor.idtBold = 0xcd;
                    } else {
                        tutor.idtBold = 0xce;
                    }
                }
                uVar4 = 0;
            }
        } else if (tutor.idt == 0xd0) {
            tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
            sVar3 = FCheckColonizeWP(7, 0x11, 0xffff);
            if (sVar3 == 0) {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                FCheckColonizeWP(7, 8, 0xffff);
                tutor.idtBold = 0xd1;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                sVar3 = FCheckFleetWP(8, 1, grobjPlanet, 9, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 8);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0xd4;
                    } else {
                        tutor.idtBold = 0xd6;
                    }
                    uVar4 = 0;
                } else {
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = 1;
                }
            }
        } else if (tutor.idt == 0xd8) {
            tutor.wFlags = tutor.wFlags & 0xffdf;
            sVar3 = FCheckMessages(~idmColonistsDroppedMassacredGroundTroops, 0x2d, 1);
            if (sVar3 == 0) {
                tutor.wFlags = tutor.wFlags & 0xfbff;
                tutor.idtBold = 0xd8;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                sVar3 = FCheckResearch(1, 6, 0x1e);
                if (sVar3 == 0) {
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0xd9;
                        tutor.wFlags = tutor.wFlags & 0xfbff;
                        uVar4 = 0;
                    } else if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((uint)tutor.wFlags >> 9 & 1) == 0)) {
                        sVar3 = FCheckSummary(grobjPlanet, 5);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0xd9;
                        } else {
                            tutor.idtBold = 0xdb;
                        }
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0xdd;
                        if (pctResGlob == -1) {
                            uVar4 = 0;
                        } else {
                            tutor.wFlags = tutor.wFlags & 0xfbff;
                            uVar4 = 1;
                        }
                    }
                } else {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    uVar4 = 1;
                }
            }
        } else if (tutor.idt == 0xe0) {
            if (pctResGlob == -1) {
                sVar3 = FCheckResearch(1, 6, 0x1e);
                if (sVar3 == 0) {
                    tutor.idtBold = 0xe4;
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0xe6;
                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                    uVar4 = 1;
                }
            } else {
                if (((uint)tutor.wFlags >> 10 & 1) == 0) {
                    tutor.idtBold = 0xe2;
                } else {
                    tutor.idtBold = 0xe4;
                }
                uVar4 = 0;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 9:
        if (tutor.idt == 0xe8) {
            tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
            sVar3 = FCheckResearch(1, 3, 0x1e);
            if (sVar3 == 0) {
                if (pctResGlob == -1) {
                    tutor.idtBold = 0xe8;
                } else {
                    tutor.idtBold = 0xec;
                }
                tutor.wFlags = tutor.wFlags & 0xffdf;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                tutor.idtBold = 0xee;
                uVar4 = FCheckMessages(~idmColonistsDroppedMassacredGroundTroops, 0x7d, 1);
            }
        } else if (tutor.idt == 0xf0) {
            sVar3 = FCheckColonizeWP(9, 2, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 9);
                if (sVar3 == 0) {
                    sVar3 = FCheckSummary(grobjPlanet, 2);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0xf0;
                    } else {
                        tutor.idtBold = 0xf1;
                    }
                } else {
                    sVar12 = 0x19;
                    sVar11 = 0;
                    sVar10 = 0;
                    sVar3 = 0;
                    pFVar8 = LpflFromId(9);
                    sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0xf2;
                    } else {
                        tutor.idtBold = 0xf3;
                    }
                }
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                sVar3 = FCheckFleetWP(0, 1, grobjPlanet, 4, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    FCheckFleetWP(0, 1, grobjPlanet, 2, 0xffff, 0xffff);
                    tutor.idtBold = 0xf5;
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0xf7;
                    tutor.wFlags = tutor.wFlags & 0xffd7U | 8;
                    uVar4 = 1;
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 10:
        if (tutor.idt == 0xf8) {
            sVar3 = FCheckMessages(~idmColonistsDroppedMassacredGroundTroops, 0x59, 1);
            if (sVar3 == 0) {
                tutor.idtBold = 0xf8;
                tutor.wFlags = tutor.wFlags & 0xfbff;
                uVar4 = 0;
            } else {
                sVar3 = FCheckQueue(0xe, 0, grobjPlanet, 1, 3, 1);
                if ((sVar3 == 0) || (sVar3 = FCheckQueue(0xe, 1, grobjPlanet, 0, 3, 1), sVar3 == 0)) {
                    sVar3 = FCheckSelection(grobjPlanet, 0xe);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0xf9;
                    } else if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                        tutor.idtBold = 0xfa;
                    } else {
                        tutor.idtBold = 0xfb;
                    }
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckTemplate(0);
                    if (sVar3 == 0) {
                        if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                            tutor.idtBold = 0xfe;
                            uVar4 = 0;
                        } else if (vyZPDStatic == -1) {
                            tutor.idtBold = 0xff;
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    } else {
                        uVar4 = 1;
                    }
                }
            }
        } else if (tutor.idt == 0x100) {
            sVar3 = FCheckTemplate(0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x100;
                uVar4 = 0;
            } else if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((PLPROD *)lpplProdGlob != (PLPROD *)0x0 || (lpplProdGlob._2_2_ != 0)))) {
                tutor.idtBold = 0x101;
                uVar4 = 0;
            } else {
                pPVar9 = LpplFromId(0xd);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 2, 1, 0), sVar3 == 0)) {
                    tutor.idh = 0x423;
                    if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (sVar3 = FCheckSelection(grobjPlanet, 0xd), sVar3 == 0)) {
                        sVar3 = FCheckSummary(grobjPlanet, 0x17);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x103;
                        } else {
                            tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                            tutor.idtBold = 0x104;
                        }
                    } else {
                        tutor.idtBold = 0x104;
                    }
                    uVar4 = 0;
                } else {
                    pPVar9 = LpplFromId(0xd);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(0xd, 2, grobjFleet, 3, 1, 0), sVar3 == 0)) {
                        tutor.idh = 0x423;
                        tutor.idtBold = 0x106;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x107;
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0xb:
        if (tutor.idt == 0x108) {
            sVar3 = FCheckFleetWP(0, 1, grobjPlanet, 10, 0xffff, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x108;
                } else {
                    tutor.idtBold = 0x109;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckFleetWP(1, 1, grobjPlanet, 0xd, 5, 0xffff);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 1);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x10a;
                    } else {
                        tutor.idtBold = 0x10c;
                    }
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(4, 1, grobjPlanet, 0xd, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x10d;
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckFleetWP(8, 1, grobjFleet, 0x200, 0xffff, 0xffff);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x10f;
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x110) {
            sVar3 = FCheckColonizeWP(2, 4, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 2);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x110;
                } else {
                    tutor.idtBold = 0x112;
                }
                uVar4 = 0;
            } else {
                sVar12 = 0xd2;
                sVar11 = 0;
                sVar10 = 0;
                sVar3 = 0;
                pFVar8 = LpflFromId(0xb);
                sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 0xb);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x113;
                    } else {
                        tutor.idtBold = 0x114;
                    }
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(0xb, 1, grobjPlanet, 5, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x114;
                    } else {
                        sVar3 = FCheckFleetWP(0xb, 1, grobjPlanet, 5, 1, 0xffff);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x115;
                        } else {
                            sVar3 = FCheckXferWP(0xb, 1, 5, 0xffff, rgiaUnloadAllCol);
                            if (sVar3 != 0) {
                                tutor.wFlags = tutor.wFlags & 0xfbff;
                                return 1;
                            }
                            sVar3 = FCheckSelection(grobjFleet, 0xb);
                            if (((sVar3 == 0) || ((*(uint *)((int)(PLORD *)sel.fl.lpplord + sel.iwpAct * 0x12 + 10) & 0xf) != 1)) ||
                                (LVar7 = SendMessage(rghwndOrderDD[1], CB_GETCURSEL, 0, 0), LVar7 != 4)) {
                                tutor.idtBold = 0x116;
                            } else {
                                tutor.idtBold = 0x117;
                            }
                        }
                    }
                    uVar4 = 0;
                }
            }
        } else if (tutor.idt == 0x118) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 2) || (sVar3 = FCheckQueue(0xd, 0, grobjPlanet, 8, 0x46, 0), sVar3 == 0)) {
                tutor.idtBold = 0x118;
            } else {
                sVar3 = FCheckResearch(3, 5, 0x1e);
                if (sVar3 == 0) {
                    if (pctResGlob == -1) {
                        tutor.idtBold = 0x119;
                    } else {
                        tutor.idtBold = 0x11a;
                    }
                } else {
                    sVar3 = FCheckSelection(grobjFleet, 8);
                    if (sVar3 != 0) {
                        return 1;
                    }
                    if (((((uint)tutor.wFlags >> 10 & 1) == 0) ||
                         (sVar3 = FCheckMessages(idmColonistsHaveDeployedOrbitalConstructionModuleHa, -1, 0), sVar3 == 0)) ||
                        (hwndBrowser != 0)) {
                        if (hwndBrowser == 0) {
                            tutor.idtBold = 0x11b;
                        } else {
                            tutor.idtBold = 0x11c;
                            tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                        }
                    } else {
                        sVar3 = FCheckMessages(idmColonistsDroppedDestroyedSpiritedFighting, -1, 0);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x11d;
                        } else {
                            tutor.idtBold = 0x11e;
                        }
                    }
                }
            }
            uVar4 = 0;
        } else if (tutor.idt == 0x120) {
            if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((uint)tutor.wFlags >> 9 & 1) == 0)) {
                if (((TOK *)vrgtok == (TOK *)0x0) && (vrgtok._2_2_ == 0)) {
                    tutor.idtBold = 0x121;
                } else {
                    tutor.idtBold = 0x122;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(9999, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x123;
                } else {
                    tutor.idtBold = 0x127;
                }
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0xc:
        if (tutor.idt == 0x128) {
            pPVar9 = LpplFromId(8);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if (((PLPROD *)pPVar2)->iprodMac < 3) {
                sVar3 = FCheckSummary(grobjFleet, 3);
                if (sVar3 == 0) {
                    sVar3 = FCheckSummary(grobjThing, -1);
                    if (sVar3 == 0) {
                        sVar3 = FCheckMessages(idmColonistsDroppedDestroyedPlanetaryDefensesRestMa, -1, 0);
                        if ((sVar3 == 0) || (sVar3 = FCheckSelection(grobjFleet, 8), sVar3 == 0)) {
                            tutor.idtBold = 0x129;
                        } else {
                            tutor.idtBold = 300;
                        }
                    } else {
                        tutor.idtBold = 0x12f;
                    }
                    uVar4 = 0;
                } else {
                    uVar4 = 1;
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x130) {
            sVar3 = FCheckMessages(idmMultitudeEnemiesHaveMountedProngAttackResulting, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x132;
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(idmInvolvedWayAssaultNobodysTroopsSurvivedBrutal, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x134;
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x136;
                    uVar4 = FCheckSelection(grobjPlanet, 0x12);
                }
            }
        } else if (tutor.idt == 0x138) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 3, 2, 0), sVar3 == 0)) {
                pPVar9 = LpplFromId(8);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(8, 0, grobjPlanet, 0xc, 2, 1), sVar3 == 0)) {
                    sVar3 = FCheckSelection(grobjPlanet, 8);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x139;
                    } else {
                        tutor.idtBold = 0x13c;
                    }
                } else {
                    tutor.idtBold = 0x13e;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x13f;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0xd:
        if (tutor.idt == 0x140) {
            if (rgplr[0].cShDef == '\a') {
                uVar4 = 1;
            } else {
                sVar3 = FCheckXferWP(0, 1, 8, 0xffff, rgiaUnloadAllCol);
                if (sVar3 == 0) {
                    sVar12 = 0xd2;
                    sVar11 = 0;
                    sVar10 = 0;
                    sVar3 = 0;
                    pFVar8 = LpflFromId(0);
                    sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x140;
                    } else {
                        tutor.idtBold = 0x141;
                    }
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(idmGroundTroopsValiantlyDestroyedAttackingBarbarian, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x142;
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckResearch(5, 2, 0x1e);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x144;
                            uVar4 = 0;
                        } else if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((uint)tutor.wFlags >> 9 & 1) == 0)) {
                            if (hwndBrowser == 0) {
                                tutor.idtBold = 0x145;
                            } else {
                                tutor.idtBold = 0x147;
                                tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                            }
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x147;
                            uVar4 = (uint)(hwndSlotDlg != 0);
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x148) {
            local_c.grhst = hstEngine;
            local_c.wFlags_0x2 = 0x103;
            local_8.grhst = hstScanner;
            local_8.wFlags_0x2 = 0x101;
            if ((hwndSlotDlg == 0) && (rgplr[0].cShDef == '\a')) {
                uVar4 = 1;
            } else {
                sVar3 = FCheckShipBuilder(4, -1);
                if (sVar3 == 0) {
                    sVar3 = FCheckShipBuilder(1, 7);
                    if (sVar3 == 0) {
                        sVar3 = FCheckShipBuilder(1, -1);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x148;
                        } else {
                            tutor.idtBold = 0x149;
                        }
                    } else {
                        tutor.idtBold = 0x14a;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idh = 0xbdf;
                    if (((((SHDEF *)lpshdefBuild)->hul).rghs[0].wFlags_0x2 >> 8 == 0) || (sVar3 = FCheckBuilderPart(0, &local_c, 1), sVar3 == 0)) {
                        tutor.idtBold = 0x14c;
                        uVar4 = 0;
                    } else if (((((SHDEF *)lpshdefBuild)->hul).rghs[1].wFlags_0x2 >> 8 == 0) || (sVar3 = FCheckBuilderPart(1, &local_8, 1), sVar3 == 0)) {
                        tutor.idtBold = 0x14d;
                        uVar4 = 0;
                    } else {
                        uVar6 = (undefined2)((ulong)lpshdefBuild >> 0x10);
                        if (((((SHDEF *)lpshdefBuild)->hul).rghs[2].wFlags_0x2 >> 8 == 0) || ((((SHDEF *)lpshdefBuild)->hul).rghs[3].wFlags_0x2 >> 8 == 0)) {
                            sVar3 = FCheckShipBuilder(4, 8);
                            if (sVar3 == 0) {
                                tutor.idtBold = 0x14e;
                                uVar4 = 0;
                            } else {
                                tutor.idtBold = 0x14f;
                                uVar4 = 0;
                            }
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x150) {
            if (hwndSlotDlg == 0) {
                pPVar9 = LpplFromId(0xd);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if ((((PLPROD *)pPVar2)->iprodMac < 3) ||
                    ((pPVar9 = LpplFromId(0xd), pPVar2 = ((PLANET *)pPVar9)->lpplprod,
                      ((PLPROD *)pPVar2)->iprodMac == 3 && (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 6, 1, 0), sVar3 == 0)))) {
                    tutor.idtBold = 0x153;
                    uVar4 = 0;
                } else {
                    pPVar9 = LpplFromId(0xd);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(0xd, 0, grobjPlanet, 8, 100, 0), sVar3 == 0)) {
                        if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                            tutor.idtBold = 0x155;
                        } else {
                            tutor.idtBold = 0x156;
                        }
                        tutor.wFlags = tutor.wFlags & 0xfbff;
                        uVar4 = 0;
                    } else {
                        uVar4 = 1;
                    }
                }
            } else {
                sVar3 = FCheckShipBuilder(4, -1);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x152;
                } else {
                    tutor.idtBold = 0x151;
                }
                uVar4 = 0;
            }
        } else if (tutor.idt == 0x158) {
            if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((uint)tutor.wFlags >> 9 & 1) == 0)) {
                tutor.idtBold = 0x158;
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(9999, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x159;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(8, 1, grobjPlanet, 0xd, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x15c;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x15e;
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0xe:
        if (tutor.idt == 0x160) {
            pPVar9 = LpplFromId(2);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if (((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(2, 0, grobjPlanet, 4, 2, 1), sVar3 == 0)) ||
                (sVar3 = FCheckTemplate(1), sVar3 == 0)) {
                sVar3 = FCheckSelection(grobjPlanet, 2);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjPlanet, 0x11);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x160;
                    } else {
                        tutor.idtBold = 0x162;
                    }
                } else {
                    tutor.idtBold = 0x164;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x166;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0xf:
        if (tutor.idt == 0x168) {
            sVar3 = FCheckFleetWP(8, 1, grobjPlanet, 0xb, 0xffff, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x168;
                uVar4 = 0;
            } else {
                sVar12 = 0xd2;
                sVar11 = 0;
                sVar10 = 0;
                sVar3 = 0;
                pFVar8 = LpflFromId(6);
                sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x169;
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = 0;
                } else if ((((uint)tutor.wFlags >> 9 & 1) == 0) && (((uint)tutor.wFlags >> 10 & 1) == 0)) {
                    if (vprptCur == (RPT *)0x0) {
                        tutor.idtBold = 0x16b;
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                        if (vprptCur->icolSort == 4) {
                            tutor.idtBold = 0x16e;
                        } else {
                            tutor.idtBold = 0x16c;
                        }
                    }
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckXferWP(6, 1, 5, 0xffff, rgiaUnloadAllCol);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x16f;
                        uVar4 = 0;
                    } else {
                        uVar4 = 1;
                    }
                }
            }
        } else if (tutor.idt == 0x170) {
            if ((((uint)tutor.wFlags >> 9 & 1) == 0) && (((uint)tutor.wFlags >> 10 & 1) == 0)) {
                if (pctResGlob == -1) {
                    tutor.idtBold = 0x170;
                } else {
                    tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                    tutor.idtBold = 0x173;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckFleetWP(0xb, 1, grobjPlanet, 0xd, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x174;
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x176;
                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                    uVar4 = 1;
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x10:
        if (tutor.idt == 0x178) {
            sVar3 = FCheckFleetWP(4, 1, grobjPlanet, 5, 0xffff, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x178;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                pFVar8 = LpflFromId(7);
                if (((FLEET *)pFVar8)->cord == 1) {
                    sVar3 = FCheckSelection(grobjFleet, 7);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x179;
                    } else {
                        tutor.idtBold = 0x17a;
                    }
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(7, 1, grobjPlanet, 0xc, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        tutor.wFlags = tutor.wFlags & 0xffdf;
                        sVar3 = FCheckFleetWP(7, 1, grobjFleet, 5, 4, 0xffff);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x17a;
                            uVar4 = 0;
                        } else {
                            pPVar9 = LpplFromId(0xd);
                            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                            if (((((PLPROD *)pPVar2)->iprodMac < 2) || (sVar3 = FCheckQueue(0xd, 0, grobjPlanet, 1, 0x3c, 0), sVar3 == 0)) ||
                                (sVar3 = FCheckQueue(0xd, 1, grobjPlanet, 0, 0x3c, 0), sVar3 == 0)) {
                                if (((PLPROD *)lpplProdGlob == (PLPROD *)0x0) && (lpplProdGlob._2_2_ == 0)) {
                                    tutor.idtBold = 0x17c;
                                } else {
                                    tutor.idtBold = 0x17d;
                                }
                                uVar4 = 0;
                            } else {
                                sVar3 = FCheckResearch(2, 3, 0x1e);
                                if (sVar3 == 0) {
                                    tutor.idtBold = 0x17e;
                                    uVar4 = 0;
                                } else {
                                    tutor.idtBold = 0x17f;
                                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                                    uVar4 = 1;
                                }
                            }
                        }
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xffdf;
                        tutor.idtBold = 0x17a;
                        uVar4 = 0;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x11:
        if (tutor.idt == 0x180) {
            sVar3 = FCheckFleetWP(0, 1, grobjPlanet, 0xd, 0xffff, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckMessages(9999, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x180;
                } else {
                    tutor.idtBold = 0x181;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x183;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x12:
        if (tutor.idt == 0x188) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 0, grobjFleet, 3, 1, 0), sVar3 == 0)) {
                tutor.idtBold = 0x188;
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(idmMultitudeEnemiesHaveMountedProngAttackResulting, -1, 0);
                if (sVar3 == 0) {
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    tutor.idtBold = 0x189;
                    uVar4 = 0;
                } else if ((((uint)tutor.wFlags >> 9 & 1) == 0) && (((uint)tutor.wFlags >> 10 & 1) == 0)) {
                    sVar3 = FCheckSelection(grobjPlanet, 0x10);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x189;
                    } else if (pctResGlob == -1) {
                        tutor.idtBold = 0x18b;
                    } else {
                        tutor.idtBold = 0x18c;
                    }
                    uVar4 = 0;
                } else if (pctResGlob == -1) {
                    tutor.idtBold = 399;
                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                    uVar4 = 1;
                } else {
                    tutor.idtBold = 0x18e;
                    uVar4 = 0;
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x13:
        if (tutor.idt == 400) {
            sVar12 = 0xd2;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(0xb);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                tutor.idtBold = 400;
                uVar4 = 0;
            } else {
                sVar3 = FCheckXferWP(0xb, 1, 5, 0xffff, rgiaUnloadAllCol);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x191;
                    uVar4 = 0;
                } else {
                    tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                    sVar3 = FCheckXferWP(0xb, 2, 0xd, 0xffff, rgiaLoadAllCol);
                    if (sVar3 == 0) {
                        tutor.wFlags = tutor.wFlags & 0xffdf;
                        tutor.idtBold = 0x192;
                        uVar4 = 0;
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xffdf;
                        tutor.idh = 0x5ee;
                        tutor.idtBold = 0x193;
                        pFVar8 = LpflFromId(0xb);
                        if ((((FLEET *)pFVar8)->wFlags_0x4 >> 9 & 1) == 0) {
                            uVar4 = 0;
                        } else {
                            sVar12 = 0xd2;
                            sVar11 = 0;
                            sVar10 = 0;
                            sVar3 = 0;
                            pFVar8 = LpflFromId(1);
                            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                            if (sVar3 == 0) {
                                sVar3 = FCheckSelection(grobjFleet, 1);
                                if (sVar3 == 0) {
                                    tutor.idtBold = 0x196;
                                } else {
                                    tutor.idtBold = 0x197;
                                }
                                uVar4 = 0;
                            } else {
                                uVar4 = 1;
                            }
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x198) {
            sVar3 = FCheckXferWP(1, 1, 2, 0xffff, rgiaUnloadAllCol);
            if (sVar3 == 0) {
                tutor.idtBold = 0x198;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                sVar3 = FCheckXferWP(1, 2, 0xd, 0xffff, rgiaLoadAllCol);
                if (sVar3 == 0) {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    tutor.idtBold = 0x199;
                    uVar4 = 0;
                } else {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    tutor.idh = 0x5ee;
                    tutor.idtBold = 0x19a;
                    pFVar8 = LpflFromId(1);
                    if ((((FLEET *)pFVar8)->wFlags_0x4 >> 9 & 1) == 0) {
                        uVar4 = 0;
                    } else {
                        pPVar9 = LpplFromId(0x10);
                        pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                        if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0x10, 2, grobjPlanet, 5, 1, 1), sVar3 == 0)) {
                            tutor.idtBold = 0x19c;
                            uVar4 = 0;
                        } else {
                            sVar3 = FCheckFleetWP(6, 1, grobjPlanet, 0xd, 0xffff, 0xffff);
                            if (sVar3 == 0) {
                                tutor.idtBold = 0x19d;
                                uVar4 = 0;
                            } else {
                                tutor.idtBold = 0x19e;
                                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                                uVar4 = 1;
                            }
                        }
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x14:
        if (tutor.idt == 0x1a0) {
            sVar3 = FCheckFleetWP(8, 1, grobjPlanet, 6, 0xffff, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1a0;
                uVar4 = 0;
            } else {
                sVar3 = FCheckResearch(3, 1, 0x1e);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1a1;
                    uVar4 = 0;
                } else if ((rgplr[0].wFlags_0x4 >> 0xc == 1) || (hwndSlotDlg != 0)) {
                    if ((hwndSlotDlg == 0) && (rgplr[0].wFlags_0x4 >> 0xc == 1)) {
                        tutor.idtBold = 0x1a2;
                    } else {
                        sVar3 = FCheckShipBuilder(4, -1);
                        if (((sVar3 == 0) || (fStarbaseMode == 0)) && (rgplr[0].wFlags_0x4 >> 0xc == 1)) {
                            tutor.idtBold = 0x1a3;
                        } else if ((((SHDEF *)lpshdefBuild)->hul).rghs[0].wFlags_0x2 >> 8 == 0) {
                            tutor.idtBold = 0x1a4;
                        } else {
                            tutor.idtBold = 0x1a5;
                        }
                    }
                    uVar4 = 0;
                } else {
                    pPVar9 = LpplFromId(0xd);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 0x11, 1, 0), sVar3 == 0)) {
                        tutor.idtBold = 0x1a6;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x1a7;
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x15:
        if (tutor.idt == 0x1a8) {
            sVar12 = 0xd2;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(0);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1a8;
                uVar4 = 0;
            } else {
                sVar3 = FCheckXferWP(0, 1, 5, 0xffff, rgiaUnloadAllCol);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1a9;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckZip(0, rgiaUnloadAllCol, 0x209);
                    if (sVar3 == 0) {
                        if (hwndZipOrderDlg == 0) {
                            tutor.idtBold = 0x1ab;
                        } else {
                            tutor.idtBold = 0x1ac;
                        }
                        uVar4 = 0;
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                        sVar3 = FCheckXferWP(0, 2, 0xd, 0xffff, rgiaLoadAllCol);
                        if (sVar3 == 0) {
                            tutor.wFlags = tutor.wFlags & 0xffdf;
                            tutor.idtBold = 0x1ae;
                            uVar4 = 0;
                        } else {
                            tutor.wFlags = tutor.wFlags & 0xffdf;
                            tutor.idh = 0x5ee;
                            tutor.idtBold = 0x1af;
                            pFVar8 = LpflFromId(0);
                            if ((((FLEET *)pFVar8)->wFlags_0x4 >> 9 & 1) == 0) {
                                uVar4 = 0;
                            } else {
                                uVar4 = 1;
                            }
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x1b0) {
            sVar3 = FCheckMessages(9999, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1b0;
                uVar4 = 0;
            } else if ((((uint)tutor.wFlags >> 9 & 1) == 0) && (((uint)tutor.wFlags >> 10 & 1) == 0)) {
                if (vprptCur == (RPT *)0x0) {
                    tutor.idtBold = 0x1b2;
                } else if (((vprptCur->icolSort == 0xb) && (vprptCur->fAscending == 0)) && (vprptCur->iSubsort == 3)) {
                    tutor.idtBold = 0x1b7;
                    tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                } else {
                    tutor.idtBold = 0x1b3;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x1b7;
                tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x16:
        if (tutor.idt == 0x1b8) {
            pFVar8 = LpflFromId(3);
            uVar6 = (undefined2)((ulong)pFVar8 >> 0x10);
            if (((int)((FLEET *)pFVar8)->rgwtMin[4] == 0x17f) && (*(int *)((int)((FLEET *)pFVar8)->rgwtMin + 0x12) == 0)) {
                uVar4 = 1;
            } else {
                sVar3 = FCheckSelection(grobjFleet, 3);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1b8;
                } else {
                    tutor.idtBold = 0x1bd;
                    tutor.idh = 0x5ed;
                }
                uVar4 = 0;
            }
        } else if (tutor.idt == 0x1c0) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 3, 1, 0), sVar3 == 0)) {
                tutor.idtBold = 0x1c0;
                uVar4 = 0;
            } else {
                sVar3 = FCheckResearch(1, 2, 0x1e);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1c1;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x1c2;
                        uVar4 = 0;
                    } else if ((rgplr[0].cShDef < '\b') || (hwndSlotDlg != 0)) {
                        local_c.grhst = hstEngine;
                        local_c.wFlags_0x2 = 0x104;
                        local_8.grhst = hstMines;
                        local_8.wFlags_0x2 = 0x301;
                        if (hwndSlotDlg == 0) {
                            tutor.idtBold = 0x1c2;
                            tutor.idh = 0x3e9;
                            uVar4 = 0;
                        } else if ((rgplr[0].cShDef < '\b') && (sVar3 = FCheckShipBuilder(4, -1), sVar3 == 0)) {
                            tutor.idtBold = 0x1c3;
                            uVar4 = 0;
                        } else {
                            tutor.idh = 0xbdf;
                            if (((((SHDEF *)lpshdefBuild)->hul).rghs[0].wFlags_0x2 >> 8 == 0) || (sVar3 = FCheckBuilderPart(0, &local_c, 1), sVar3 == 0)) {
                                tutor.idtBold = 0x1c4;
                            } else if (((((SHDEF *)lpshdefBuild)->hul).rghs[2].wFlags_0x2 >> 8 == 0) ||
                                       (sVar3 = FCheckBuilderPart(2, &local_8, 1), sVar3 == 0)) {
                                tutor.idtBold = 0x1c5;
                            } else {
                                tutor.idtBold = 0x1c6;
                            }
                            uVar4 = 0;
                        }
                    } else {
                        pPVar9 = LpplFromId(0xd);
                        pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                        if ((((PLPROD *)pPVar2)->iprodMac < 5) || (sVar3 = FCheckQueue(0xd, 2, grobjFleet, 7, 1, 0), sVar3 == 0)) {
                            tutor.idtBold = 0x1c7;
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x1c7;
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x1c8) {
            sVar3 = FCheckFleetWP(4, 1, grobjFleet, 0x204, 0xffff, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 4);
                if (sVar3 == 0) {
                    sVar3 = FCheckSummary(grobjFleet, 0x204);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x1c8;
                    } else {
                        tutor.idtBold = 0x1ca;
                    }
                } else {
                    tutor.idtBold = 0x1cb;
                }
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x1cd;
                tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x17:
        if (tutor.idt == 0x1d0) {
            sVar12 = 0xd2;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(6);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                sVar3 = FCheckMessages(idmColonistsDroppedDestroyedPlanetaryDefensesRestMa, -1, 0);
                if ((sVar3 == 0) && (sVar3 = FCheckSelection(grobjFleet, 4), sVar3 == 0)) {
                    tutor.idtBold = 0x1d0;
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(idmColonistsForcedTransportDiedBecauseDidColonize, -1, 0);
                    if ((sVar3 == 0) && (sVar3 = FCheckSelection(grobjFleet, 6), sVar3 == 0)) {
                        tutor.idtBold = 0x1d4;
                        uVar4 = 0;
                    } else if ((((uint)tutor.wFlags >> 9 & 1) == 0) && (((uint)tutor.wFlags >> 10 & 1) == 0)) {
                        if (vprptCur == (RPT *)0x0) {
                            tutor.idtBold = 0x1d5;
                        } else if (vprptCur->icolSort == 2) {
                            tutor.idtBold = 0x1d7;
                            tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                        } else {
                            tutor.idtBold = 0x1d5;
                        }
                        uVar4 = 0;
                    } else {
                        uVar4 = 1;
                    }
                }
            } else {
                uVar4 = 1;
            }
        } else if (tutor.idt == 0x1d8) {
            sVar12 = 0xd2;
            sVar11 = 0;
            sVar10 = 0;
            sVar3 = 0;
            pFVar8 = LpflFromId(6);
            sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1d8;
                uVar4 = 0;
            } else {
                sVar3 = FCheckFleetWP(6, 1, grobjPlanet, 0x11, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1d8;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(6, 1, grobjPlanet, 0x11, 1, 0xffff);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x1d9;
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckXferWP(6, 1, 0x11, 0xffff, rgiaUnloadAllCol);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x1da;
                            tutor.idh = 0x5f0;
                            uVar4 = 0;
                        } else {
                            pFVar8 = LpflFromId(2);
                            if (pFVar8 == (FLEET *)0x0) {
                                tutor.wFlags = tutor.wFlags & 0xfbff;
                                uVar4 = 1;
                            } else {
                                sVar3 = FCheckMessages(idmGroundTroopsValiantlyDestroyedAttackingBarbarian, -1, 0);
                                if (sVar3 == 0) {
                                    tutor.idtBold = 0x1db;
                                } else {
                                    sVar3 = FCheckSelection(grobjFleet, 3);
                                    if (sVar3 == 0) {
                                        sVar3 = FCheckSelection(grobjFleet, 2);
                                        if (sVar3 == 0) {
                                            tutor.idtBold = 0x1db;
                                        } else {
                                            tutor.idtBold = 0x1dd;
                                        }
                                        tutor.idh = 0x5ed;
                                    } else if (vrgiflMerge == (short *)0x0) {
                                        tutor.idtBold = 0x1de;
                                        tutor.idh = 0x5ec;
                                    } else {
                                        tutor.idh = 0x453;
                                        tutor.idtBold = 0x1df;
                                    }
                                }
                                uVar4 = 0;
                            }
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x1e0) {
            sVar3 = FCheckFleetWP(7, 0, grobjPlanet, 0xd, 6, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1e0;
                uVar4 = 0;
            } else {
                pPVar9 = LpplFromId(0xd);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 0, grobjFleet, 6, 1, 0), sVar3 == 0)) {
                    tutor.idtBold = 0x1e1;
                    tutor.wFlags = tutor.wFlags & 0xfbff;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(idmThereMassiveBloodBathInvolvingFleetsRaces, -1, 0);
                    if (((sVar3 == 0) || ((sVar3 = FCheckSelection(grobjFleet, 4), sVar3 == 0 && (sVar3 = FCheckSelection(grobjFleet, 8), sVar3 == 0)))) ||
                        ((((uint)tutor.wFlags >> 9 & 1) == 0 && (((uint)tutor.wFlags >> 10 & 1) == 0)))) {
                        if (((TOK *)vrgtok != (TOK *)0x0) || (vrgtok._2_2_ != 0)) {
                            tutor.wFlags = tutor.wFlags & 0xfbffU | 0x400;
                        }
                        tutor.idtBold = 0x1e2;
                        uVar4 = 0;
                    } else {
                        pFVar8 = LpflFromId(4);
                        pPVar1 = ((FLEET *)pFVar8)->lpplord;
                        if ((*(uint *)&((PLORD *)pPVar1)[2].iordMax >> 8 & 0xf) == 2) {
                            pFVar8 = LpflFromId(8);
                            if (((FLEET *)pFVar8)->cord < 3) {
                                sVar3 = FCheckMessages(9999, -1, 0);
                                if ((sVar3 == 0) || (sVar3 = FCheckSelection(grobjFleet, 8), sVar3 == 0)) {
                                    tutor.idtBold = 0x1e5;
                                } else {
                                    tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                                    sVar3 = FCheckFleetWP(8, 1, grobjPlanet, 1, 0xffff, 0xffff);
                                    if (sVar3 == 0) {
                                        tutor.wFlags = tutor.wFlags & 0xffdf;
                                        FCheckFleetWP(8, 1, grobjPlanet, 6, 0xffff, 0xffff);
                                        tutor.idtBold = 0x1e6;
                                    } else {
                                        tutor.idtBold = 0x1e7;
                                    }
                                    tutor.wFlags = tutor.wFlags & 0xffdf;
                                }
                                uVar4 = 0;
                            } else {
                                sVar3 = FCheckFleetWP(8, 2, grobjPlanet, 0, 0xffff, 0xffff);
                                if (sVar3 == 0) {
                                    tutor.idtBold = 0x1e7;
                                    uVar4 = 0;
                                } else {
                                    tutor.idtBold = 0x1e7;
                                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                                    uVar4 = 1;
                                }
                            }
                        } else {
                            tutor.idtBold = 0x1e4;
                            tutor.idh = 0x5ee;
                            uVar4 = 0;
                        }
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x18:
        if (tutor.idt == 0x1e8) {
            sVar3 = FCheckFleetWP(4, 1, grobjPlanet, 5, 0xffff, 0xffff);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1e8;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                sVar3 = FCheckFleetWP(2, 1, grobjFleet, 5, 4, 0xffff);
                if (sVar3 == 0) {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    FCheckFleetWP(2, 1, grobjPlanet, 0xc, 0xffff, 0xffff);
                    tutor.idtBold = 0x1e9;
                    uVar4 = 0;
                } else {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x1ea;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x1ec;
                        tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x19:
        if (tutor.idt == 0x1f0) {
            sVar3 = FCheckMessages(idmGroundTroopsValiantlyDestroyedAttackingBarbarian, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x1f0;
                uVar4 = 0;
            } else if (((rgshdef[2].hul.rghs[0].wFlags_0x2 & 0xff) == 4) && (hwndSlotDlg == 0)) {
                uVar4 = 1;
            } else {
                local_c.grhst = hstEngine;
                local_c.wFlags_0x2 = 0x104;
                local_8.grhst = hstSpecialM;
                local_8.wFlags_0x2 = 0x100;
                sVar3 = FCheckScanner(3, -1);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1f1;
                    uVar4 = 0;
                } else if (hwndSlotDlg == 0) {
                    tutor.idtBold = 499;
                    tutor.idh = 0x3e9;
                    uVar4 = 0;
                } else if ((rgshdef[2].hul.rghs[0].wFlags_0x2 & 0xff) == 4) {
                    tutor.idtBold = 0x1f7;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckShipBuilder(4, -1);
                    if (sVar3 == 0) {
                        sVar3 = FCheckShipBuilder(0, 2);
                        if (sVar3 == 0) {
                            tutor.idtBold = 500;
                        } else {
                            tutor.idtBold = 0x1f5;
                        }
                    } else {
                        uVar6 = (undefined2)((ulong)lpshdefBuild >> 0x10);
                        if ((((((SHDEF *)lpshdefBuild)->hul).rghs[0].wFlags_0x2 >> 8 == 0) ||
                             (((((SHDEF *)lpshdefBuild)->hul).rghs[0].wFlags_0x2 & 0xff) != 4)) ||
                            (sVar3 = FCheckBuilderPart(1, &local_8, 1), sVar3 == 0)) {
                            tutor.idtBold = 0x1f6;
                        } else {
                            tutor.idtBold = 0x1f7;
                        }
                    }
                    uVar4 = 0;
                }
            }
        } else if (tutor.idt == 0x1f8) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 0, grobjFleet, 2, 3, 0), sVar3 == 0)) {
                tutor.idtBold = 0x1f8;
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(idmPlanetaryDefensesGroundTroopsDestroyedInvadingTr, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x1f9;
                    uVar4 = 0;
                } else {
                    pPVar9 = LpplFromId(0x11);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac == 3) && (sVar3 = FCheckQueue(0x11, 2, grobjPlanet, 5, 2, 1), sVar3 != 0)) {
                        sVar3 = FCheckMessages(idmInvolvedWayAssaultNobodysTroopsSurvivedBrutal, -1, 0);
                        if ((sVar3 == 0) || (sVar3 = FCheckResearch(2, 3, 0x1e), sVar3 == 0)) {
                            tutor.idtBold = 0x1fc;
                            uVar4 = 0;
                        } else {
                            sVar3 = FCheckMessages(9999, -1, 0);
                            if (sVar3 == 0) {
                                tutor.idtBold = 0x1fd;
                                uVar4 = 0;
                            } else {
                                tutor.idtBold = 0x1ff;
                                tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                                uVar4 = 1;
                            }
                        }
                    } else {
                        sVar3 = FCheckSelection(grobjPlanet, 0x11);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x1f9;
                        } else {
                            tutor.idtBold = 0x1fb;
                        }
                        uVar4 = 0;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x1a:
        if (tutor.idt == 0x200) {
            sVar3 = FCheckMessages(idmPlanetaryDefensesGroundTroopsDestroyedInvadingTr, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x200;
                uVar4 = 0;
            } else if (((rgplr[0].wFlags_0x4 & 0xfff) == 10) && (sVar3 = FCheckColonizeWP(9, 0, 0xffff), sVar3 == 0)) {
                sVar3 = FCheckSelection(grobjFleet, 9);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x201;
                } else {
                    tutor.idtBold = 0x202;
                }
                uVar4 = 0;
            } else if ((rgplr[0].wFlags_0x4 & 0xfff) == 10) {
                tutor.idtBold = 0x203;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                sVar3 = FCheckColonizeWP(9, 1, 0xffff);
                if (sVar3 == 0) {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    FCheckColonizeWP(9, 0, 0xffff);
                    tutor.idtBold = 0x204;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckColonizeWP(10, 0x17, 0xffff);
                    if (sVar3 == 0) {
                        tutor.wFlags = tutor.wFlags & 0xffdf;
                        FCheckColonizeWP(10, 0, 0xffff);
                        tutor.idtBold = 0x205;
                        uVar4 = 0;
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xffdf;
                        sVar3 = FCheckMessages(9999, -1, 0);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x206;
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x208) {
            pPVar9 = LpplFromId(0xd);
            pPVar2 = ((PLANET *)pPVar9)->lpplprod;
            if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(0xd, 1, grobjFleet, 3, 3, 0), sVar3 == 0)) {
                tutor.idtBold = 0x209;
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                sVar3 = FCheckFleetWP(4, 1, grobjFleet, 0x205, 0xffff, 0xffff);
                if (sVar3 == 0) {
                    tutor.wFlags = tutor.wFlags & 0xffdf;
                    FCheckColonizeWP(4, 5, 0xffff);
                    sVar3 = FCheckSummary(grobjFleet, 0x205);
                    if (((sVar3 == 0) && (sVar3 = FCheckSummary(grobjFleet, 4), sVar3 == 0)) && (sVar3 = FCheckSelection(grobjFleet, 4), sVar3 == 0)) {
                        tutor.idtBold = 0x20b;
                    } else {
                        tutor.idtBold = 0x20d;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x20f;
                    tutor.wFlags = tutor.wFlags & 0xffd7U | 8;
                    uVar4 = 1;
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x1b:
        if (tutor.idt == 0x210) {
            tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
            sVar3 = FCheckFleetWP(4, 0, grobjFleet, 0x205, 0xffff, 0xffff);
            if (sVar3 == 0) {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                sVar3 = FCheckSelection(grobjFleet, 4);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x210;
                } else {
                    tutor.idh = 0x5ee;
                    tutor.idtBold = 0x212;
                }
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                sVar3 = FCheckMessages(idmColonistsDroppedDestroyedPlanetaryDefensesRestMa, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x214;
                    uVar4 = 0;
                } else {
                    pFVar8 = LpflFromId(0xc);
                    if ((pFVar8 == (FLEET *)0x0) || (pFVar8 = LpflFromId(0xc), (((FLEET *)pFVar8)->wFlags_0x4 >> 10 & 1) != 0)) {
                        uVar4 = 1;
                    } else {
                        sVar12 = 0x276;
                        sVar11 = 0;
                        sVar10 = 0;
                        sVar3 = 0;
                        pFVar8 = LpflFromId(0xc);
                        sVar3 = FCheckCargo(pFVar8, sVar3, sVar10, sVar11, sVar12);
                        if (sVar3 == 0) {
                            sVar3 = FCheckSelection(grobjFleet, 0xc);
                            if (sVar3 == 0) {
                                sVar3 = FCheckSelection(grobjFleet, 8);
                                if (sVar3 == 0) {
                                    tutor.idtBold = 0x214;
                                } else {
                                    tutor.idtBold = 0x216;
                                }
                            } else {
                                tutor.idtBold = 0x217;
                            }
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x218) {
            pFVar8 = LpflFromId(0xc);
            if (pFVar8 == (FLEET *)0x0) {
                sVar3 = FCheckMessages(idmInvolvedWayRaceUninhabitedPlanetForcesCrush, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x21a;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x21c;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x21e;
                        tutor.idh = 0x1771;
                        if ((hwndSlotDlg == 0) && (rgplr[0].cShDef != '\t')) {
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            } else {
                sVar3 = FCheckSelection(grobjFleet, 0xb);
                if ((sVar3 != 0) && (vrgiflMerge == (short *)0x0)) {
                    tutor.idh = 0x5ec;
                }
                tutor.idtBold = 0x219;
                uVar4 = 0;
            }
        } else if (tutor.idt == 0x220) {
            if ((hwndSlotDlg == 0) && ('\b' < rgplr[0].cShDef)) {
                pPVar9 = LpplFromId(0xd);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 0, grobjFleet, 8, 10, 0), sVar3 == 0)) {
                    tutor.idtBold = 0x226;
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x227;
                    tutor.wFlags = tutor.wFlags & 0xfff7U | 8;
                    uVar4 = 1;
                }
            } else {
                sVar3 = FCheckShipBuilder(4, -1);
                if (sVar3 == 0) {
                    if (rgplr[0].cShDef < '\t') {
                        tutor.idtBold = 0x221;
                    } else {
                        tutor.idtBold = 0x225;
                    }
                } else {
                    uVar6 = (undefined2)((ulong)lpshdefBuild >> 0x10);
                    pSVar5 = (SHDEF *)lpshdefBuild;
                    if ((((pSVar5->hul).rghs[0].wFlags_0x2 >> 8 == 1) && ((pSVar5->hul).rghs[1].wFlags_0x2 >> 8 == 1)) &&
                        (((pSVar5->hul).rghs[2].wFlags_0x2 >> 8 == 1 &&
                          (((pSVar5->hul).rghs[3].wFlags_0x2 >> 8 == 1 && ((pSVar5->hul).rghs[4].wFlags_0x2 >> 8 == 2)))))) {
                        if (((pSVar5->hul).rghs[5].wFlags_0x2 >> 8 == 1) && ((pSVar5->hul).rghs[6].wFlags_0x2 >> 8 == 1)) {
                            tutor.idtBold = 0x225;
                        } else {
                            tutor.idtBold = 0x223;
                        }
                    } else {
                        tutor.idtBold = 0x222;
                    }
                }
                uVar4 = 0;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x1c:
        if (tutor.idt == 0x228) {
            sVar3 = FCheckFleetWP(4, 1, grobjPlanet, 5, 0xffff, 0xffff);
            if (sVar3 == 0) {
                sVar3 = FCheckSelection(grobjFleet, 4);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x228;
                } else {
                    tutor.idtBold = 0x22a;
                }
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(idmInvolvedWayAssaultNobodysTroopsSurvivedBrutal, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x22b;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(0xc, 1, grobjPlanet, 10, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        sVar3 = FCheckSelection(grobjFleet, 0xc);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x22b;
                        } else {
                            tutor.idtBold = 0x22c;
                        }
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckMessages(9999, -1, 0);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x22d;
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x22f;
                            tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x1d:
        if (tutor.idt == 0x230) {
            tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
            sVar3 = FCheckFleetWP(3, 1, grobjPlanet, 0xd, 0xffff, 5);
            if (sVar3 == 0) {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                sVar3 = FCheckSelection(grobjFleet, 3);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x230;
                } else {
                    tutor.idtBold = 0x232;
                }
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xffdf;
                sVar3 = FCheckMessages(idmInvolvedWayAssaultNobodysTroopsSurvivedBrutal, -1, 0);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x234;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckFleetWP(0xd, 1, grobjPlanet, 10, 0xffff, 0xffff);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x235;
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckPlanetRoute(0xd, 10);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x237;
                            uVar4 = 0;
                        } else {
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x238) {
            sVar3 = FCheckMessages(idmDefeatedOppositionSufferedHeavyLosses, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x239;
                uVar4 = 0;
            } else {
                sVar3 = FCheckResearch(3, 0, 0x1e);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x23a;
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x23b;
                        uVar4 = 0;
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xffdfU | 0x20;
                        sVar3 = FCheckFleetWP(6, 0, grobjPlanet, 0x11, 5, 0xffff);
                        if (sVar3 == 0) {
                            tutor.wFlags = tutor.wFlags & 0xffdf;
                            sVar3 = FCheckSelection(grobjFleet, 6);
                            if (sVar3 == 0) {
                                tutor.idtBold = 0x23c;
                            } else {
                                tutor.idtBold = 0x23e;
                            }
                            uVar4 = 0;
                        } else {
                            tutor.wFlags = tutor.wFlags & 0xffdf;
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else if (tutor.idt == 0x240) {
            if (hwndSlotDlg == 0) {
                if (rgplr[0].cShDef < '\n') {
                    tutor.idtBold = 0x241;
                    tutor.idh = 0x1771;
                    uVar4 = 0;
                } else {
                    pPVar9 = LpplFromId(0xd);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 0, grobjFleet, 9, 10, 0), sVar3 == 0)) {
                        tutor.idtBold = 0x246;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x247;
                        tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                        uVar4 = 1;
                    }
                }
            } else {
                if (((rgshdef[9].wFlags >> 9 & 1) == 0) && (sVar3 = FCheckShipBuilder(4, -1), sVar3 == 0)) {
                    tutor.idtBold = 0x245;
                } else {
                    sVar3 = FCheckShipBuilder(4, -1);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x242;
                    } else {
                        uVar6 = (undefined2)((ulong)lpshdefBuild >> 0x10);
                        pSVar5 = (SHDEF *)lpshdefBuild;
                        if ((pSVar5->hul).rghs[0].wFlags_0x2 >> 8 == 2) {
                            if ((((pSVar5->hul).rghs[1].wFlags_0x2 >> 8 == 4) && ((pSVar5->hul).rghs[2].wFlags_0x2 >> 8 == 4)) &&
                                ((pSVar5->hul).rghs[3].wFlags_0x2 >> 8 == 1)) {
                                tutor.idtBold = 0x245;
                            } else {
                                tutor.idtBold = 0x244;
                            }
                        } else {
                            tutor.idtBold = 0x243;
                        }
                    }
                }
                uVar4 = 0;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x1e:
        if (tutor.idt == 0x248) {
            sVar3 = FCheckMessages(idmMultitudeEnemiesHaveMountedProngAttackResulting, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x24a;
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(9999, -1, 0);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 0xe);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x24a;
                    } else {
                        tutor.idtBold = 0x24c;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x24e;
                    tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                    uVar4 = 1;
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x1f:
        if (tutor.idt == 0x250) {
            sVar3 = FCheckMessages(idmInvolvedWayAssaultNobodysTroopsSurvivedBrutal, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x250;
                uVar4 = 0;
            } else {
                sVar3 = FCheckSelection(grobjPlanet, 5);
                if (sVar3 == 0) {
                    tutor.idtBold = 0x250;
                    uVar4 = 0;
                } else {
                    pPVar9 = LpplFromId(5);
                    pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                    if ((((PLPROD *)pPVar2)->iprodMac < 4) || (sVar3 = FCheckQueue(5, 0, grobjPlanet, 8, 100, 1), sVar3 == 0)) {
                        tutor.idtBold = 0x252;
                        uVar4 = 0;
                    } else {
                        sVar3 = FCheckMessages(9999, -1, 0);
                        if (sVar3 == 0) {
                            tutor.idtBold = 0x254;
                            uVar4 = 0;
                        } else {
                            tutor.idtBold = 0x256;
                            tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                            uVar4 = 1;
                        }
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x20:
        if (tutor.idt == 600) {
            sVar3 = FCheckMessages(idmColonistsForcedTransportDiedBecauseDidColonize, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 600;
                uVar4 = 0;
            } else if ((((uint)tutor.wFlags >> 10 & 1) == 0) && (((uint)tutor.wFlags >> 9 & 1) == 0)) {
                tutor.idtBold = 0x25a;
                uVar4 = 0;
            } else {
                sVar3 = FCheckMessages(idmFleetsDestroyedOpposition, -1, 0);
                if (sVar3 == 0) {
                    sVar3 = FCheckSelection(grobjFleet, 0xc);
                    if (sVar3 == 0) {
                        tutor.idtBold = 600;
                    } else {
                        tutor.idtBold = 0x25c;
                    }
                    uVar4 = 0;
                } else {
                    tutor.idtBold = 0x25e;
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        uVar4 = 0;
                    } else {
                        tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x21:
        if (tutor.idt == 0x260) {
            sVar3 = FCheckMessages(idmColonistsControl, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x260;
                uVar4 = 0;
            } else {
                pPVar9 = LpplFromId(0xd);
                pPVar2 = ((PLANET *)pPVar9)->lpplprod;
                if ((((PLPROD *)pPVar2)->iprodMac < 3) || (sVar3 = FCheckQueue(0xd, 0, grobjFleet, 9, 10, 0), sVar3 == 0)) {
                    sVar3 = FCheckSelection(grobjPlanet, 0xd);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x260;
                    } else {
                        tutor.idtBold = 0x261;
                    }
                    uVar4 = 0;
                } else {
                    sVar3 = FCheckMessages(9999, -1, 0);
                    if (sVar3 == 0) {
                        tutor.idtBold = 0x263;
                        uVar4 = 0;
                    } else {
                        tutor.idtBold = 0x264;
                        tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                        uVar4 = 1;
                    }
                }
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x22:
        if (tutor.idt == 0x268) {
            tutor.idtBold = 0x26b;
            sVar3 = FCheckMessages(9999, -1, 0);
            if (sVar3 == 0) {
                uVar4 = 0;
            } else {
                tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x23:
        if (tutor.idt == 0x270) {
            sVar3 = FCheckMessages(9999, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x270;
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x274;
                tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    case 0x24:
        if (tutor.idt == 0x278) {
            sVar3 = FCheckMessages(9999, -1, 0);
            if (sVar3 == 0) {
                tutor.idtBold = 0x27c;
                uVar4 = 0;
            } else {
                tutor.idtBold = 0x27d;
                tutor.wFlags = tutor.wFlags & 0xfbf7U | 8;
                uVar4 = 1;
            }
        } else {
            uVar4 = 1;
        }
        break;
    default:
        tutor.wFlags = tutor.wFlags & 0xffe7U | 0x18;
        uVar4 = 1;
    }
    return uVar4;
}

// ======================================================================
// Function: FCheckZip
// Address: 10f8:6460
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckZip(short iZip, ITEMACTION *lpiaGoal, short ids)

{
    short       sVar1;
    short       sVar2;
    short       idhSav;
    char        szT[33];
    short       i;
    ITEMACTION *piaCur;

    sVar1 = tutor.idh;
    tutor.idh = 0x44a;
    if (((uint)tutor.wFlags >> 9 & 1) == 0) {
        if (*(char *)((int)&vrgZip[0].fValid + iZip * 0x18) == '\0') {
            if (hwndZipOrderDlg == 0) {
                tutor.idh = 0x5f0;
            }
            sVar2 = 0;
        } else {
            piaCur = (ZIPORDER *)vrgZip + iZip;
            tutor.idh = 0x5ef;
            for (i = 0; i < 5; i = i + 1) {
                if ((piaCur->wFlags >> 0xc != lpiaGoal->wFlags >> 0xc) && (piaCur->wFlags >> 0xc != 0)) {
                    tutor.idh = 0x5ef;
                    return 0;
                }
                piaCur = piaCur + 1;
                lpiaGoal = (ITEMACTION *)lpiaGoal + 1;
            }
            CchGetString(ids, szT);
            sVar2 = __strcmpi(szT, (char *)((int)vrgZip[0].szName + iZip * 0x18));
            if (sVar2 == 0) {
                sVar2 = 1;
                tutor.idh = sVar1;
            } else {
                TutorError(0x208);
                sVar2 = 0;
            }
        }
    } else {
        *(undefined1 *)((int)&vrgZip[0].fValid + iZip * 0x18) = 1;
        piaCur = (ZIPORDER *)vrgZip + iZip;
        for (i = 0; i < 5; i = i + 1) {
            piaCur->wFlags = piaCur->wFlags & 0xfff | lpiaGoal->wFlags & 0xf000;
            piaCur = piaCur + 1;
            lpiaGoal = (ITEMACTION *)lpiaGoal + 1;
        }
        CchGetString(ids, szT);
        _strcpy((char *)((int)vrgZip[0].szName + iZip * 0x18), szT);
        sVar2 = 1;
    }
    return sVar2;
}

// ======================================================================
// Function: FCheckTemplate
// Address: 10f8:666e
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Restarted to delay deadcode elimination for space: ram */

short FCheckTemplate(short iTemplate)

{
    ZIPPRODQ1 *pZVar1;
    ZIPPRODQ1 *pZVar2;
    byte       bVar3;
    short      sVar4;
    int        iVar5;
    ZIPPRODQ1 *pZVar6;
    ZIPPRODQ1 *pZVar7;
    short      i;

    tutor.idh = 0xc2d;
    if (((uint)tutor.wFlags >> 9 & 1) == 0) {
        if (vrgZipProd[0].fValid == 0) {
            sVar4 = 0;
        } else if (vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1.fNoResearch == ((ZIPPRODQ1 *)rgzpqTut + iTemplate)->fNoResearch) {
            if (vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1.cpq == *(byte *)(iTemplate * 0x1a + 0x663b)) {
                for (i = 0; i < (int)(uint) * (byte *)(iTemplate * 0x1a + 0x663b); i = i + 1) {
                    if ((((ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1)->rgpq + i)->w != *(ushort *)(iTemplate * 0x1a + 0x663c + i * 2)) {
                        tutor.idh = 0xc2d;
                        return 0;
                    }
                }
                gd.grBits2._0_2_ = (uint)gd.grBits2 & 0xffdf | 0x20;
                sVar4 = 1;
            } else {
                sVar4 = 0;
            }
        } else {
            sVar4 = 0;
        }
    } else {
        vrgZipProd[0].fValid = 1;
        pZVar6 = (ZIPPRODQ1 *)rgzpqTut + iTemplate;
        pZVar7 = (ZIPPRODQ1 *)&vrgZipProd[0].u_ZIPPRODQ_0x000e.zpq1;
        for (iVar5 = 0xd; iVar5 != 0; iVar5 = iVar5 + -1) {
            pZVar2 = pZVar7;
            pZVar7 = pZVar7->rgpq;
            pZVar1 = pZVar6;
            pZVar6 = pZVar6->rgpq;
            bVar3 = pZVar1->cpq;
            pZVar2->fNoResearch = pZVar1->fNoResearch;
            pZVar2->cpq = bVar3;
        }
        gd.grBits2._0_2_ = (uint)gd.grBits2 & 0xffdf | 0x20;
        sVar4 = 1;
    }
    return sVar4;
}

// ======================================================================
// Function: TutorError
// Address: 10f8:67ae
// Segment: MEMORY_TUTOR
// ======================================================================

void TutorError(short idsError)

{
    uint  uVar1;
    char *sz;
    short mbType;

    if (((uint)tutor.wFlags >> 5 & 1) == 0) {
        if ((tutor.idsError != idsError) ||
            (uVar1 = (uint)tutor.wFlags >> 6, tutor.wFlags = tutor.wFlags & 0xfe3fU | tutor.wFlags + 0x40U & 0x1c0, 2 < (uVar1 & 7))) {
            tutor.wFlags = tutor.wFlags & 0xfe3f;
            tutor.idsError = idsError;
            mbType = 0x10;
            sz = PszFormatIds(idsError, (short *)0x0);
            AlertSz(sz, mbType);
        }
    } else {
        tutor.idsError = -1;
    }
    return;
}

// ======================================================================
// Function: FCheckScanner
// Address: 10f8:685c
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckScanner(short md, short iZoom)

{
    short sVar1;
    short idhSav;

    if (((uint)tutor.wFlags >> 9 & 1) != 0) {
        return 1;
    }
    if ((md != -1) && (grbitScan != md)) {
        if (md < 6) {
            if ((grbitScan & 0xf) != md) {
                tutor.idh = 0x36b8;
                return 0;
            }
        } else if ((md & grbitScan) != md) {
            tutor.idh = 0x36b8;
            return 0;
        }
    }
    if ((iZoom == -1) || (iZoom == iScanZoom)) {
        sVar1 = 1;
    } else {
        tutor.idh = 0x36c6;
        sVar1 = 0;
    }
    return sVar1;
}

// ======================================================================
// Function: FCheckFleetName
// Address: 10f8:690a
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckFleetName(short id, short ids)

{
    FLEET     *pFVar1;
    short      sVar2;
    short      sVar3;
    uint       uVar4;
    int        iVar5;
    undefined2 unaff_SS;
    FLEET     *pFVar6;
    short      idhSav;
    char       szT[33];
    FLEET     *lpfl;

    sVar2 = tutor.idh;
    tutor.idh = 0xbee;
    pFVar6 = LpflFromId(id);
    iVar5 = (int)((ulong)pFVar6 >> 0x10);
    pFVar1 = (FLEET *)pFVar6;
    if ((pFVar1 == (FLEET *)0x0) && (iVar5 == 0)) {
        uVar4 = 1;
    } else if ((*(int *)&pFVar1->lpszName == 0) && (*(int *)((int)&pFVar1->lpszName + 2) == 0)) {
        if (ids == -1) {
            uVar4 = 1;
            tutor.idh = sVar2;
        } else {
            uVar4 = (uint)(ids == -1);
        }
    } else {
        CchGetString(ids, szT);
        /* WARNING: Load size is inaccurate */
        sVar3 = __fstricmp(szT, (char *)CONCAT22(*(undefined2 *)((int)&pFVar1->lpszName + 2), pFVar1->lpszName));
        if (sVar3 == 0) {
            uVar4 = 1;
            tutor.idh = sVar2;
        } else {
            TutorError(0x4cf);
            uVar4 = 0;
        }
    }
    return uVar4;
}

// ======================================================================
// Function: FCheckSummary
// Address: 10f8:69e2
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckSummary(GrobjClass grobj, short id)

{
    short fRet;

    if (((uint)gd.grBits >> 1 & 1) == 0) {
        fRet = 0;
        if (grobj == grobjPlanet) {
            if ((sel.scan.grobj == grobjPlanet) && (sel.scan.idpl == id)) {
                fRet = 1;
            } else {
                fRet = 0;
            }
        } else if (grobj == grobjFleet) {
            if (((sel.scan.grobj == grobjFleet) && (sel.scan.ifl != -1)) && (((FLEET **)rglpfl)[sel.scan.ifl]->id == id)) {
                fRet = 1;
            } else {
                fRet = 0;
            }
        } else if (grobj == grobjThing) {
            if ((sel.scan.grobj == grobjThing) && ((id == -1 || (((THING *)lpThings + sel.scan.ith)->idFull == id)))) {
                fRet = 1;
            } else {
                fRet = 0;
            }
        }
        if (fRet == 0) {
            tutor.idh = 0x36d2;
        }
    } else {
        fRet = 1;
    }
    return fRet;
}

// ======================================================================
// Function: FCheckSelection
// Address: 10f8:6af4
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckSelection(GrobjClass grobj, short id)

{
    short  sVar1;
    int    iVar2;
    FLEET *pFVar3;
    short  idhSav;
    short  fRet;

    sVar1 = tutor.idh;
    if ((((uint)tutor.wFlags >> 9 & 1) == 0) && (((uint)gd.grBits >> 1 & 1) == 0)) {
        if (grobj == grobjFleet) {
            iVar2 = 2;
        } else {
            iVar2 = 1;
        }
        if ((mdMsgObj == iVar2) && (id == idMsgObj)) {
            tutor.idh = 0x36b1;
        } else if (((grobj == grobjPlanet) && (sel.grobj == grobjFleet)) && (sel.fl.idPlanet == id)) {
            tutor.idh = 0x5ea;
        } else if (((grobj == grobjFleet) && (sel.grobj == grobjPlanet)) && (pFVar3 = LpflFromId(id), ((FLEET *)pFVar3)->idPlanet == sel.pl.id)) {
            tutor.idh = 0x5e6;
        } else {
            tutor.idh = 0x5f6;
        }
        fRet = 0;
        if (grobj == grobjPlanet) {
            if ((sel.grobj == grobjPlanet) && (sel.pl.id == id)) {
                fRet = 1;
            } else {
                fRet = 0;
            }
        } else if (grobj == grobjFleet) {
            if ((sel.grobj == grobjFleet) && (sel.fl.id == id)) {
                fRet = 1;
            } else {
                fRet = 0;
            }
        }
        if (fRet == 0) {
            sVar1 = tutor.idh;
        }
    } else {
        fRet = 1;
    }
    tutor.idh = sVar1;
    return fRet;
}

// ======================================================================
// Function: FCheckMessages
// Address: 10f8:6c48
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckMessages(MessageId imsg, short idm, short fFilter)

{
    short sVar1;
    short sVar2;
    short idhSav;

    sVar1 = tutor.idh;
    if (((uint)gd.grBits >> 1 & 1) == 0) {
        tutor.idh = 0x36b1;
        if ((imsg == 9999) && (sVar2 = IMsgNext(0), sVar2 != -1)) {
            sVar2 = 0;
        } else if ((imsg == 9999) || ((imsg == ~idmColonistsDroppedMassacredGroundTroops || ((int)imsg <= iMsgCur)))) {
            if (idm != -1) {
                if (((fFilter != 0) && (((uint)tutor.wFlags >> 9 & 1) != 0)) && (((uint)((byte *)bitfMsgFiltered)[idm >> 3] & 1 << ((byte)idm & 7)) == 0)) {
                    SetFilteringGroups(idm, 1);
                    tutor.idh = sVar1;
                    return 1;
                }
                if ((fFilter != 0) && (((uint)((byte *)bitfMsgFiltered)[idm >> 3] & 1 << ((byte)idm & 7)) == 0)) {
                    return 0;
                }
                if ((fFilter == 0) && (sVar2 = IdmGetMessageN(iMsgCur), sVar2 != idm)) {
                    return 0;
                }
            }
            sVar2 = 1;
            tutor.idh = sVar1;
        } else {
            sVar2 = 0;
        }
    } else {
        sVar2 = 1;
        tutor.idh = sVar1;
    }
    return sVar2;
}

// ======================================================================
// Function: FCheckResearch
// Address: 10f8:6da4
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckResearch(short iTech, short iTechNext, short pct)

{
    short sVar1;

    if (((((int)rgplr[0].iTechCur & 0xfU) == iTech) && ((int)rgplr[0].iTechCur >> 4 == iTechNext)) && (rgplr[0].pctResearch == pct)) {
        sVar1 = 1;
    } else {
        tutor.idh = 0x42e;
        sVar1 = 0;
    }
    return sVar1;
}

// ======================================================================
// Function: FCheckFleetWP
// Address: 10f8:6df4
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckFleetWP(ushort ifl, short iord, GrobjClass grobj, short id, ushort grTask, ushort iWarp)

{
    short     *psVar1;
    ORDER     *pOVar2;
    undefined2 uVar3;
    FLEET     *pFVar4;
    short      sVar5;
    short      sVar6;
    short      sVar7;
    int        iVar8;
    short     *psVar9;
    ORDER     *pOVar10;
    undefined2 unaff_SS;
    FLEET     *pFVar11;
    short      idhSav;
    short      idh;
    FLEET     *lpfl;
    short      fRet;
    ORDER      ord;

    sVar5 = tutor.idh;
    fRet = 0;
    pFVar11 = LpflFromId(ifl);
    iVar8 = (int)((ulong)pFVar11 >> 0x10);
    pFVar4 = (FLEET *)pFVar11;
    tutor.idh = 0x5f6;
    if (((pFVar4 != (FLEET *)0x0) || (iVar8 != 0)) && (tutor.idh = 0xbf6, iord + 1 <= pFVar4->cord)) {
        uVar3 = *(undefined2 *)((int)&pFVar4->lpplord + 2);
        psVar9 = (short *)(*(int *)&pFVar4->lpplord + 4 + iord * 0x12);
        pOVar10 = &ord;
        for (iVar8 = 9; iVar8 != 0; iVar8 = iVar8 + -1) {
            pOVar2 = pOVar10;
            pOVar10 = &(pOVar10->pt).y;
            psVar1 = psVar9;
            psVar9 = psVar9 + 1;
            (pOVar2->pt).x = *psVar1;
        }
        if (((id & 0x7fffU) == 0x7fff) || (((ord.wFlags_0x6 >> 8 & (grobjThing | grobjOther | grobjFleet | grobjPlanet)) == grobj && (ord.id == id)))) {
            if (((ord.wFlags_0x6 & 0xf) == grTask) || (grTask == 0xffff)) {
                tutor.idh = 0x5ee;
                if (iWarp == 0xffff) {
                    fRet = 1;
                } else {
                    fRet = (short)((ord.wFlags_0x6 >> 4 & 0xf) == iWarp);
                }
            } else {
                tutor.idh = 0x5ef;
                if ((ord.wFlags_0x6 & 0xf) != 0) {
                    if (grTask == 0) {
                        sVar6 = 0x1ed;
                    } else {
                        sVar6 = 0x1ee;
                    }
                    TutorError(sVar6);
                }
            }
        } else {
            TutorError(0x1ec);
            tutor.idh = 0xbf7;
        }
    }
    sVar6 = tutor.idh;
    if ((fRet == 0) && (sVar7 = FCheckSelection(grobjFleet, ifl), sVar7 == 0)) {
        sVar6 = tutor.idh;
    }
    tutor.idh = sVar6;
    if (fRet == 0) {
        sVar5 = tutor.idh;
    }
    tutor.idh = sVar5;
    return fRet;
}

// ======================================================================
// Function: FCheckPlanetRoute
// Address: 10f8:6f86
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckPlanetRoute(short idpl, short idplRoute)

{
    short   sVar1;
    short   sVar2;
    int     iVar3;
    PLANET *pPVar4;
    short   idhSav;
    PLANET *lppl;

    sVar1 = tutor.idh;
    pPVar4 = LpplFromId(idpl);
    iVar3 = (int)((ulong)pPVar4 >> 0x10);
    if (((PLANET *)pPVar4 == (PLANET *)0x0) && (iVar3 == 0)) {
        sVar2 = 0;
    } else {
        tutor.idh = 0x5fb;
        if ((((PLANET *)pPVar4)->wRouting & 0x3ff) == idplRoute + 1U) {
            sVar2 = 1;
            tutor.idh = sVar1;
        } else {
            sVar2 = 0;
        }
    }
    return sVar2;
}

// ======================================================================
// Function: FCheckLayingWP
// Address: 10f8:6ff4
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckLayingWP(ushort ifl, short iord, short id, short iYears)

{
    FLEET     *pFVar1;
    short      sVar2;
    GrobjClass grobj_00;
    short      sVar3;
    int        iVar4;
    FLEET     *pFVar5;
    short      grobj;
    short      idhSav;
    FLEET     *lpfl;

    sVar2 = tutor.idh;
    pFVar5 = LpflFromId(ifl);
    iVar4 = (int)((ulong)pFVar5 >> 0x10);
    pFVar1 = (FLEET *)pFVar5;
    if ((pFVar1 == (FLEET *)0x0) && (iVar4 == 0)) {
        sVar3 = 0;
    } else {
        tutor.idh = 0x5f8;
        if ((id & 0x8000U) == 0) {
            grobj_00 = grobjPlanet;
        } else {
            grobj_00 = grobjFleet;
        }
        sVar3 = FCheckFleetWP(ifl, iord, grobj_00, id & 0x7fff, 6, 0xffff);
        if (sVar3 == 0) {
            sVar3 = 0;
        } else if (*(int *)(*(int *)&pFVar1->lpplord + iord * 0x12 + 0xc) == iYears) {
            sVar3 = 1;
            tutor.idh = sVar2;
        } else {
            sVar3 = 0;
        }
    }
    return sVar3;
}

// ======================================================================
// Function: FCheckColonizeWP
// Address: 10f8:70c0
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckColonizeWP(ushort ifl, short id, ushort iWarp)

{
    FLEET *pFVar1;
    short  sVar2;
    short  sVar3;
    int    iVar4;
    FLEET *lpfl_00;
    short  idhSav;
    short  csh;
    FLEET *lpfl;
    short  ish;

    sVar2 = tutor.idh;
    lpfl_00 = LpflFromId(ifl);
    iVar4 = (int)((ulong)lpfl_00 >> 0x10);
    pFVar1 = (FLEET *)lpfl_00;
    if ((pFVar1 == (FLEET *)0x0) && (iVar4 == 0)) {
        sVar3 = 0;
    } else {
        tutor.idh = 0x5f2;
        csh = 0;
        for (ish = 0; ish < 0x10; ish = ish + 1) {
            csh = csh + pFVar1->rgcsh[ish];
        }
        if ((pFVar1->idPlanet == 0xd) && (sVar3 = FCheckCargo(lpfl_00, 0, 0, 0, csh * 0x19), sVar3 == 0)) {
            sVar3 = 0;
        } else {
            sVar3 = FCheckFleetWP(ifl, 1, grobjPlanet, id, 2, iWarp);
            if (sVar3 == 0) {
                sVar3 = 0;
            } else {
                sVar3 = 1;
                tutor.idh = sVar2;
            }
        }
    }
    return sVar3;
}

// ======================================================================
// Function: FCheckPatrolWP
// Address: 10f8:71ac
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckPatrolWP(ushort ifl, short iord, short id, ushort iWarp, ushort iPlan, ushort iDist)

{
    FLEET     *pFVar1;
    short      sVar2;
    GrobjClass grobj_00;
    short      sVar3;
    int        iVar4;
    FLEET     *pFVar5;
    short      grobj;
    short      idhSav;
    FLEET     *lpfl;

    sVar2 = tutor.idh;
    pFVar5 = LpflFromId(ifl);
    iVar4 = (int)((ulong)pFVar5 >> 0x10);
    pFVar1 = (FLEET *)pFVar5;
    if ((pFVar1 == (FLEET *)0x0) && (iVar4 == 0)) {
        sVar3 = 0;
    } else {
        tutor.idh = 0xc17;
        if ((id & 0x8000U) == 0) {
            grobj_00 = grobjPlanet;
        } else {
            grobj_00 = grobjFleet;
        }
        sVar3 = FCheckFleetWP(ifl, iord, grobj_00, id & 0x7fff, 7, iWarp);
        if (sVar3 == 0) {
            sVar3 = 0;
        } else if ((iDist == 0xffff) || (*(ushort *)(*(int *)&pFVar1->lpplord + iord * 0x12 + 0xe) == iDist)) {
            sVar3 = 1;
            tutor.idh = sVar2;
        } else {
            tutor.idh = 0x5ef;
            sVar3 = 0;
        }
    }
    return sVar3;
}

// ======================================================================
// Function: FCheckXferWP
// Address: 10f8:7280
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckXferWP(ushort ifl, short iord, short id, ushort iWarp, ITEMACTION *lpiaGoal)

{
    short      *psVar1;
    ORDER      *pOVar2;
    undefined2  uVar3;
    FLEET      *pFVar4;
    short       sVar5;
    short       sVar6;
    uint        uVar7;
    short       sVar8;
    int         iVar9;
    short      *psVar10;
    ORDER      *pOVar11;
    undefined2  unaff_SS;
    FLEET      *pFVar12;
    short       idhSav;
    short       grobj;
    short       idh;
    FLEET      *lpfl;
    short       i;
    ITEMACTION *piaCur;
    short       fRet;
    ORDER       ord;

    sVar5 = tutor.idh;
    fRet = 0;
    if ((id & 0x8000U) == 0) {
        grobj = 1;
    } else {
        id = id & 0x7fff;
        grobj = 2;
    }
    pFVar12 = LpflFromId(ifl);
    iVar9 = (int)((ulong)pFVar12 >> 0x10);
    pFVar4 = (FLEET *)pFVar12;
    if ((pFVar4 == (FLEET *)0x0) && (iVar9 == 0)) {
        fRet = 0;
        sVar5 = tutor.idh;
    } else {
        sVar6 = FCheckFleetWP(ifl, iord, grobj, id, 1, iWarp);
        if (sVar6 == 0) {
            fRet = 0;
            sVar5 = tutor.idh;
        } else {
            uVar3 = *(undefined2 *)((int)&pFVar4->lpplord + 2);
            psVar10 = (short *)(*(int *)&pFVar4->lpplord + 4 + iord * 0x12);
            pOVar11 = &ord;
            for (iVar9 = 9; iVar9 != 0; iVar9 = iVar9 + -1) {
                pOVar2 = pOVar11;
                pOVar11 = &(pOVar11->pt).y;
                psVar1 = psVar10;
                psVar10 = psVar10 + 1;
                (pOVar2->pt).x = *psVar1;
            }
            piaCur = &ord.u_ORDER_0x0008;
            tutor.idh = 0x5ef;
            for (i = 0; i < 5; i = i + 1) {
                if (piaCur->wFlags >> 0xc != lpiaGoal->wFlags >> 0xc) {
                    if (piaCur->wFlags >> 0xc != 0) {
                        TutorError(0x268);
                    }
                    goto TUTOR_LReturn_2;
                }
                uVar7 = piaCur->wFlags >> 0xc;
                if (((uVar7 == 4) || (uVar7 == 8)) && ((piaCur->wFlags & 0xfff) != (lpiaGoal->wFlags & 0xfff)))
                    goto TUTOR_LReturn_2;
                piaCur = piaCur + 1;
                lpiaGoal = (ITEMACTION *)lpiaGoal + 1;
            }
            fRet = 1;
        TUTOR_LReturn_2:
            sVar6 = tutor.idh;
            if ((fRet == 0) && (sVar8 = FCheckSelection(grobjFleet, ifl), sVar8 == 0)) {
                sVar6 = tutor.idh;
            }
            tutor.idh = sVar6;
            if (fRet == 0) {
                sVar5 = tutor.idh;
            }
        }
    }
    tutor.idh = sVar5;
    return fRet;
}

// ======================================================================
// Function: FCheckQueue
// Address: 10f8:7442
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Removing unreachable block (ram,0x10f8750f) */
/* WARNING: Variable defined which should be unmapped: idhSav */

short FCheckQueue(short ipl, short iprod, GrobjClass grobj, ushort iItem, ushort cItem, ushort fNoResearch)

{
    uint       uVar1;
    PLANET    *pPVar2;
    short      sVar3;
    short      sVar4;
    short      sVar5;
    int        iVar6;
    undefined2 unaff_SI;
    undefined2 unaff_DI;
    PLANET    *pPVar7;
    ulong      uVar8;
    ulong      uVar9;
    short      idhSav;
    short      idh;
    PROD       prod;
    PLANET    *lppl;
    short      fRet;

    sVar3 = tutor.idh;
    uVar9 = CONCAT22(unaff_SI, unaff_DI);
    fRet = 0;
    if (game.turn < 2) {
        tutor.idh = 0x5e3;
    } else {
        tutor.idh = 0x423;
    }
    pPVar7 = LpplFromId(ipl);
    iVar6 = (int)((ulong)pPVar7 >> 0x10);
    pPVar2 = (PLANET *)pPVar7;
    if ((((pPVar2 != (PLANET *)0x0) || (iVar6 != 0)) && ((*(int *)&pPVar2->lpplprod != 0 || (*(int *)((int)&pPVar2->lpplprod + 2) != 0)))) &&
        (iprod < (int)(uint)((PLPROD *)pPVar2->lpplprod)->iprodMac)) {
        uVar1 = *(uint *)(*(int *)&pPVar2->lpplprod + 4 + iprod * 4);
        uVar8 = __aFulshr(uVar9, sVar3);
        if ((((GrobjClass)uVar8 & (grobjOther | grobjFleet | grobjPlanet)) == grobj) && (uVar8 = __aFulshr(uVar9, sVar3), ((uint)uVar8 & 0x7f) == iItem)) {
            if ((uVar1 & 0x3ff) == cItem) {
                if ((fNoResearch == 0xffff) || (uVar9 = __aFulshr(uVar9, sVar3), ((uint)uVar9 & 1) == fNoResearch)) {
                    fRet = 1;
                } else {
                    TutorError(0x519);
                }
            } else {
                TutorError(0x1f0);
            }
        } else {
            TutorError(0x1eb);
        }
    }
    sVar4 = tutor.idh;
    if ((fRet == 0) && (sVar5 = FCheckSelection(grobjPlanet, ipl), sVar5 == 0)) {
        sVar4 = tutor.idh;
    }
    tutor.idh = sVar4;
    if (fRet == 0) {
        sVar3 = tutor.idh;
    }
    tutor.idh = sVar3;
    return fRet;
}

// ======================================================================
// Function: FCheckBtlPlan
// Address: 10f8:760a
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckBtlPlan(short ibp, ushort imdTarget, ushort fSpread, ushort fBomb, ushort fDump, ushort mdUnarmed, ushort mdScout, ushort mdWar, ushort mdBomber)

{
    short    sVar1;
    short    sVar2;
    short    idhSav;
    BTLPLAN *lpbtlplan;

    sVar1 = tutor.idh;
    tutor.idh = 0xc21;
    if ((ibp < 0) || ((int)(uint)rgcbtlplan[0] < ibp)) {
        sVar2 = 0;
    } else {
        sVar2 = 1;
        tutor.idh = sVar1;
    }
    return sVar2;
}

// ======================================================================
// Function: FCheckCargo
// Address: 10f8:7664
// Segment: MEMORY_TUTOR
// ======================================================================

short FCheckCargo(FLEET *lpfl, short wtMin1, short wtMin2, short wtMin3, short wtColonists)

{
    short sVar1;
    short sVar2;
    short sVar3;
    short idhSav;
    short idh;
    short fRet;

    sVar1 = tutor.idh;
    fRet = 0;
    if (lpfl == (FLEET *)0x0) {
        fRet = 0;
    } else {
        tutor.idh = 0x433;
        if (((((wtMin1 == 0) && (((int)((FLEET *)lpfl)->rgwtMin[0] != 0 || (*(int *)((int)((FLEET *)lpfl)->rgwtMin + 2) != 0)))) ||
              ((wtMin2 == 0 && (((int)((FLEET *)lpfl)->rgwtMin[1] != 0 || (*(int *)((int)((FLEET *)lpfl)->rgwtMin + 6) != 0)))))) ||
             ((wtMin3 == 0 && (((int)((FLEET *)lpfl)->rgwtMin[2] != 0 || (*(int *)((int)((FLEET *)lpfl)->rgwtMin + 10) != 0)))))) ||
            ((wtColonists == 0 && (((int)((FLEET *)lpfl)->rgwtMin[3] != 0 || (*(int *)((int)((FLEET *)lpfl)->rgwtMin + 0xe) != 0)))))) {
            TutorError(0x1ef);
        } else if ((((((int)((FLEET *)lpfl)->rgwtMin[3] == wtColonists) && (*(int *)((int)((FLEET *)lpfl)->rgwtMin + 0xe) == wtColonists >> 0xf)) &&
                     ((int)((FLEET *)lpfl)->rgwtMin[0] == wtMin1)) &&
                    ((*(int *)((int)((FLEET *)lpfl)->rgwtMin + 2) == wtMin1 >> 0xf && ((int)((FLEET *)lpfl)->rgwtMin[1] == wtMin2)))) &&
                   ((*(int *)((int)((FLEET *)lpfl)->rgwtMin + 6) == wtMin2 >> 0xf &&
                     (((int)((FLEET *)lpfl)->rgwtMin[2] == wtMin3 && (*(int *)((int)((FLEET *)lpfl)->rgwtMin + 10) == wtMin3 >> 0xf)))))) {
            fRet = 1;
        }
        sVar2 = tutor.idh;
        if ((fRet == 0) && (sVar3 = FCheckSelection(grobjFleet, lpfl->id), sVar3 == 0)) {
            sVar2 = tutor.idh;
        }
        tutor.idh = sVar2;
        if (fRet == 0) {
            sVar1 = tutor.idh;
        }
    }
    tutor.idh = sVar1;
    return fRet;
}

// ======================================================================
// Function: FCheckBuilderPart
// Address: 10f8:77d8
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Type propagation algorithm not settling */

short FCheckBuilderPart(short iSlot, HS *phs, ushort cInit)

{
    short  sVar1;
    uint   uVar2;
    short  idhSav;
    ushort cItemAct;

    sVar1 = tutor.idh;
    if (hwndSlotDlg == 0) {
        tutor.idh = 0x42a;
        return 0;
    }
    tutor.idh = 0xbe0;
    if (mdBuild != 4) {
        tutor.idh = 0xbe0;
        return 0;
    }
    uVar2 = (((SHDEF *)lpshdefBuild)->hul).rghs[iSlot].wFlags_0x2 >> 8;
    if ((phs->wFlags_0x2 >> 8 == 0) && (uVar2 == 0)) {
        tutor.idh = 0xbe0;
        return 1;
    }
    if (cInit < phs->wFlags_0x2 >> 8) {
        if (uVar2 < cInit)
            goto TUTOR_BadCnt;
        cInit = phs->wFlags_0x2 >> 8;
    } else if (uVar2 < phs->wFlags_0x2 >> 8)
        goto TUTOR_BadCnt;
    if (uVar2 <= cInit) {
        if (uVar2 != phs->wFlags_0x2 >> 8) {
            tutor.idh = 0xbdf;
            return 0;
        }
        if ((phs->grhst == ((((SHDEF *)lpshdefBuild)->hul).rghs + iSlot)->grhst) &&
            ((phs->wFlags_0x2 & 0xff) == ((((SHDEF *)lpshdefBuild)->hul).rghs[iSlot].wFlags_0x2 & 0xff))) {
            tutor.idh = sVar1;
            return 1;
        }
        TutorError(0x1f6);
        tutor.idh = 0xbdf;
        return 0;
    }
TUTOR_BadCnt:
    TutorError(0x1f5);
    tutor.idh = 0xbdf;
    return 0;
}

// ======================================================================
// Function: FCheckShipBuilder
// Address: 10f8:7964
// Segment: MEMORY_TUTOR
// ======================================================================

/* WARNING: Enum "WParamMessageId": Some values do not have unique names */

short FCheckShipBuilder(short iCategory, short iShip)

{
    short   sVar1;
    HWND    HVar2;
    short   sVar3;
    LRESULT LVar4;
    short   idhSav;
    short   iSel;

    sVar1 = tutor.idh;
    tutor.idh = 0x42a;
    if (hwndSlotDlg == 0) {
        sVar3 = 0;
    } else if ((iCategory == -1) || (iCategory == mdBuild)) {
        HVar2 = GetDlgItem(hwndSlotDlg, IDC_COMBOBOX);
        LVar4 = SendMessage(HVar2, CB_GETCURSEL, 0, 0);
        if ((iShip == -1) || (iShip == (int)LVar4)) {
            sVar3 = 1;
            tutor.idh = sVar1;
        } else {
            sVar3 = 0;
        }
    } else {
        sVar3 = 0;
    }
    return sVar3;
}

// ======================================================================
// Function: FTutorialEnabledShipBuilder
// Address: 10f8:79f6
// Segment: MEMORY_TUTOR
// ======================================================================

short FTutorialEnabledShipBuilder(short itutsbAction)

{
    short sVar1;
    char *pcVar2;
    char *pcVar3;
    HS    hs;
    HS    hs3;
    HS    local_10;
    HS    local_c;
    HS    local_8;

    if (itutsbAction == 0) {
        TutorError(0x1f1);
        return 0;
    }
    if (itutsbAction == 1) {
        if (game.turn == 0xd) {
            if (tutor.idt == 0x148) {
                if (rgplr[0].cShDef == '\a') {
                    TutorError(499);
                    return 0;
                }
                sVar1 = FCheckShipBuilder(1, 7);
                if (sVar1 != 0) {
                    return 1;
                }
                TutorError(0x1fe);
                return 0;
            }
        } else if (game.turn == 0x14) {
            if (tutor.idt == 0x1a0) {
                if (rgplr[0].wFlags_0x4 >> 0xc == 2) {
                    TutorError(499);
                    return 0;
                }
                sVar1 = FCheckShipBuilder(0, 0);
                if ((sVar1 != 0) && (fStarbaseMode != 0)) {
                    return 1;
                }
                TutorError(500);
                return 0;
            }
        } else if (game.turn == 0x16) {
            if (tutor.idt == 0x1c0) {
                if (rgplr[0].cShDef == '\b') {
                    TutorError(499);
                    return 0;
                }
                sVar1 = FCheckShipBuilder(1, 3);
                if (sVar1 != 0) {
                    return 1;
                }
                TutorError(0x1fe);
                return 0;
            }
        } else if (game.turn == 0x1b) {
            if (tutor.idt == 0x220) {
                if (rgplr[0].cShDef == '\t') {
                    TutorError(499);
                    return 0;
                }
                sVar1 = FCheckShipBuilder(1, 4);
                if (sVar1 != 0) {
                    return 1;
                }
                TutorError(0x1fe);
                return 0;
            }
        } else if ((game.turn == 0x1d) && (tutor.idt == 0x240)) {
            if (rgplr[0].cShDef == '\n') {
                TutorError(499);
                return 0;
            }
            sVar1 = FCheckShipBuilder(1, 8);
            if (sVar1 != 0) {
                return 1;
            }
            TutorError(0x1fe);
            return 0;
        }
    } else {
        if (itutsbAction != 2) {
            if (itutsbAction != 3) {
                if (itutsbAction != 4) {
                    return 0;
                }
                TutorError(0x1f7);
                return 0;
            }
            switch (game.turn) {
            case 0xd:
                local_10.grhst = hstScanner;
                local_10.wFlags_0x2 = 0x101;
                local_8.grhst = hstEngine;
                local_8.wFlags_0x2 = 0x103;
                local_c.grhst = hstMining;
                local_c.wFlags_0x2 = 0x102;
                if (tutor.idt != 0x150) {
                    TutorError(0x1f8);
                    return 0;
                }
                sVar1 = FCheckBuilderPart(0, &local_8, 1);
                if ((((sVar1 == 0) || (sVar1 = FCheckBuilderPart(1, &local_10, 1), sVar1 == 0)) || (sVar1 = FCheckBuilderPart(2, &local_c, 1), sVar1 == 0)) ||
                    (sVar1 = FCheckBuilderPart(3, &local_c, 1), sVar1 == 0)) {
                    TutorError(0x1fb);
                    return 0;
                }
                break;
            default:
                goto TUTOR_NoCustom;
            case 0x14:
                if (tutor.idt != 0x1a0) {
                    TutorError(0x1f8);
                    return 0;
                }
                local_8.grhst = hstSpecialSB;
                local_8.wFlags_0x2 = 0x100;
                sVar1 = FCheckBuilderPart(0, &local_8, 1);
                if (sVar1 == 0) {
                    TutorError(0x203);
                    return 0;
                }
                pcVar3 = (char *)CONCAT22((int)((ulong)lpshdefBuild >> 0x10), (((SHDEF *)lpshdefBuild)->hul).szClass);
                pcVar2 = PszGetCompressedString(idsGater);
                sVar1 = __fstricmp(pcVar2, pcVar3);
                if (sVar1 != 0) {
                    TutorError(0x200);
                    return 0;
                }
                if ((((SHDEF *)lpshdefBuild)->hul).ibmp != 0x89) {
                    TutorError(0x1f9);
                    return 0;
                }
                break;
            case 0x16:
                if (tutor.idt != 0x1c0) {
                    TutorError(0x1f8);
                    return 0;
                }
                local_c.grhst = hstEngine;
                local_c.wFlags_0x2 = 0x104;
                local_8.grhst = hstMines;
                local_8.wFlags_0x2 = 0x301;
                sVar1 = FCheckBuilderPart(0, &local_c, 1);
                if ((sVar1 == 0) || (sVar1 = FCheckBuilderPart(2, &local_8, 3), sVar1 == 0)) {
                    TutorError(0x1fc);
                    return 0;
                }
                pcVar3 = (char *)CONCAT22((int)((ulong)lpshdefBuild >> 0x10), (((SHDEF *)lpshdefBuild)->hul).szClass);
                pcVar2 = PszGetCompressedString(idsMineLayer);
                sVar1 = __fstricmp(pcVar2, pcVar3);
                if (sVar1 != 0) {
                    TutorError(0x201);
                    return 0;
                }
                break;
            case 0x19:
                local_c.grhst = hstEngine;
                local_c.wFlags_0x2 = 0x104;
                local_8.grhst = hstSpecialM;
                local_8.wFlags_0x2 = 0x100;
                sVar1 = FCheckBuilderPart(0, &local_c, 1);
                if ((sVar1 == 0) || (sVar1 = FCheckBuilderPart(1, &local_8, 1), sVar1 == 0)) {
                    TutorError(0x1fb);
                    return 0;
                }
                break;
            case 0x1b:
                if (tutor.idt != 0x220) {
                    TutorError(0x1f8);
                    return 0;
                }
                hs.grhst = hstEngine;
                hs.wFlags_0x2 = 0x10a;
                local_10.grhst = hstSpecialM;
                local_10.wFlags_0x2 = 0x105;
                local_8.grhst = hstSpecialE;
                local_8.wFlags_0x2 = 0x105;
                hs3.grhst = hstBeam;
                hs3.wFlags_0x2 = 0x103;
                local_c.grhst = hstArmor;
                local_c.wFlags_0x2 = 0x202;
                sVar1 = FCheckBuilderPart(0, &hs, 1);
                if ((((sVar1 == 0) || (sVar1 = FCheckBuilderPart(1, &hs3, 1), sVar1 == 0)) ||
                     ((sVar1 = FCheckBuilderPart(2, &hs3, 1),
                       sVar1 == 0 || ((sVar1 = FCheckBuilderPart(3, &hs3, 1), sVar1 == 0 || (sVar1 = FCheckBuilderPart(4, &local_c, 2), sVar1 == 0)))))) ||
                    ((sVar1 = FCheckBuilderPart(5, &local_10, 1), sVar1 == 0 || (sVar1 = FCheckBuilderPart(6, &local_8, 1), sVar1 == 0)))) {
                    TutorError(0x1fa);
                    return 0;
                }
                if ((((SHDEF *)lpshdefBuild)->hul).ibmp != 0x19) {
                    TutorError(0x1f9);
                    return 0;
                }
                break;
            case 0x1d:
                if (tutor.idt != 0x240) {
                    TutorError(0x1f8);
                    return 0;
                }
                local_10.grhst = hstEngine;
                local_10.wFlags_0x2 = 0x20a;
                local_c.grhst = hstSpecialM;
                local_c.wFlags_0x2 = 0x105;
                local_8.grhst = hstBomb;
                local_8.wFlags_0x2 = 0x401;
                sVar1 = FCheckBuilderPart(0, &local_10, 2);
                if ((((sVar1 == 0) || (sVar1 = FCheckBuilderPart(1, &local_8, 4), sVar1 == 0)) || (sVar1 = FCheckBuilderPart(2, &local_8, 4), sVar1 == 0)) ||
                    (sVar1 = FCheckBuilderPart(3, &local_c, 1), sVar1 == 0)) {
                    TutorError(0x1fd);
                    return 0;
                }
            }
            return 1;
        }
        if ((game.turn == 0x19) && (tutor.idt == 0x1f0)) {
            sVar1 = FCheckShipBuilder(0, 2);
            if (sVar1 == 0) {
                TutorError(0x1ff);
                return 0;
            }
            return sVar1;
        }
    }
TUTOR_NoCustom:
    TutorError(0x1f2);
    return 0;
}

// ======================================================================
// Function: FOKMergeDialog
// Address: 10f8:81da
// Segment: MEMORY_TUTOR
// ======================================================================

short FOKMergeDialog(void)

{
    if (game.turn == 0x17) {
        if (((*vrgiflMerge != -1) && (vrgiflMerge[1] != -1)) && ((vrgiflMerge[2] == -1 && (vrgiflMerge[3] == -1)))) {
            return 1;
        }
    } else {
        if (game.turn != 0x1b) {
            TutorError(0x204);
            return 0;
        }
        if ((((*vrgiflMerge == -1) && (vrgiflMerge[1] == -1)) && (vrgiflMerge[2] != -1)) && (vrgiflMerge[3] != -1)) {
            return 1;
        }
    }
    TutorError(0x202);
    tutor.idh = 0x453;
    return 0;
}
